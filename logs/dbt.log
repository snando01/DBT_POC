[0m17:43:13.375214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A90D692D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A8C557590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A90D68ED0>]}


============================== 17:43:13.387214 | c001f520-5ff6-4745-8e51-a328f4946ac9 ==============================
[0m17:43:13.387214 [info ] [MainThread]: Running with dbt=1.5.2
[0m17:43:13.389211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\dbt_poc\\logs', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:43:13.390215 [info ] [MainThread]: dbt version: 1.5.2
[0m17:43:13.391215 [info ] [MainThread]: python version: 3.11.4
[0m17:43:13.393213 [info ] [MainThread]: python path: C:\Users\SNando01\dbt-venv\Scripts\python.exe
[0m17:43:13.394214 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m17:43:13.395213 [info ] [MainThread]: Using profiles.yml file at C:\Users\SNando01\.dbt\profiles.yml
[0m17:43:13.396215 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SNando01\DBT_POC\dbt_poc\dbt_project.yml
[0m17:43:13.397213 [info ] [MainThread]: Configuration:
[0m17:43:15.180680 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:43:15.210674 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:43:15.211701 [info ] [MainThread]: Required dependencies:
[0m17:43:15.212737 [debug] [MainThread]: Executing "git --help"
[0m17:43:15.643738 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:43:15.644740 [debug] [MainThread]: STDERR: "b''"
[0m17:43:15.644740 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:43:15.647737 [info ] [MainThread]: Connection:
[0m17:43:15.648738 [info ] [MainThread]:   account: bk40750.east-us-2.azure
[0m17:43:15.654737 [info ] [MainThread]:   user: MHennes3
[0m17:43:15.655737 [info ] [MainThread]:   database: COMMEX_DB
[0m17:43:15.657738 [info ] [MainThread]:   schema: DIGITAL_SHELF_DBT
[0m17:43:15.658737 [info ] [MainThread]:   warehouse: DEV_COMX_GLOBAL_APP1_WH
[0m17:43:15.659738 [info ] [MainThread]:   role: DEV_COMX_GLOBAL_DEVELOPER_FR
[0m17:43:15.660737 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:43:15.661738 [info ] [MainThread]:   query_tag: None
[0m17:43:15.670737 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m17:43:15.671739 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:43:15.672738 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:43:15.673739 [debug] [MainThread]: On debug: select 1 as id
[0m17:43:15.673739 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:43:18.251614 [debug] [MainThread]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:43:18.253613 [debug] [MainThread]: On debug: Close
[0m17:43:18.762254 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:43:18.763255 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:43:18.765255 [debug] [MainThread]: Command `dbt debug` succeeded at 17:43:18.765255 after 5.86 seconds
[0m17:43:18.766258 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:43:18.767255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A9090C150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A91397CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A8B94C250>]}
[0m17:43:18.768253 [debug] [MainThread]: Flushing usage events
[0m17:43:18.911482 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m17:43:45.378247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A4BA25C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A4B5D7BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A4BA42E90>]}


============================== 17:43:45.382246 | 0c05f9a3-c615-4da2-afbb-9a14c9cf86b7 ==============================
[0m17:43:45.382246 [info ] [MainThread]: Running with dbt=1.5.2
[0m17:43:45.383246 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\dbt_poc\\logs', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:43:45.685348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c05f9a3-c615-4da2-afbb-9a14c9cf86b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A4C073B50>]}
[0m17:43:45.698346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c05f9a3-c615-4da2-afbb-9a14c9cf86b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A4C080350>]}
[0m17:43:45.699346 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m17:43:45.721345 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m17:43:45.723347 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:43:45.725348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0c05f9a3-c615-4da2-afbb-9a14c9cf86b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A4CBC58D0>]}
[0m17:43:46.837088 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m17:43:46.852090 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m17:43:46.922090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c05f9a3-c615-4da2-afbb-9a14c9cf86b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A4CCBDAD0>]}
[0m17:43:46.930096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c05f9a3-c615-4da2-afbb-9a14c9cf86b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A4CD42F10>]}
[0m17:43:46.931090 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m17:43:46.934089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c05f9a3-c615-4da2-afbb-9a14c9cf86b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A4B566850>]}
[0m17:43:46.947092 [info ] [MainThread]: 
[0m17:43:46.949092 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:43:46.952090 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m17:43:46.972089 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m17:43:46.973094 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m17:43:46.974090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:49.309626 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m17:43:49.312622 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m17:43:49.851233 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_COMMEX_DB, now create_COMMEX_DB_DIGITAL_SHELF_DBT)
[0m17:43:49.852230 [debug] [ThreadPool]: Creating schema "database: "COMMEX_DB"
schema: "DIGITAL_SHELF_DBT"
"
[0m17:43:49.857234 [debug] [ThreadPool]: Using snowflake connection "create_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m17:43:49.857234 [debug] [ThreadPool]: On create_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "create_COMMEX_DB_DIGITAL_SHELF_DBT"} */
create schema if not exists COMMEX_DB.DIGITAL_SHELF_DBT
[0m17:43:49.858234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:51.987727 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:43:51.988729 [debug] [ThreadPool]: On create_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m17:43:52.547053 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m17:43:52.553052 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m17:43:52.554051 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m17:43:52.554051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:54.914498 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.0 seconds
[0m17:43:54.916494 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m17:43:55.525468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c05f9a3-c615-4da2-afbb-9a14c9cf86b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A4CB72B50>]}
[0m17:43:55.526466 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:43:55.527465 [info ] [MainThread]: 
[0m17:43:55.543597 [debug] [Thread-1 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m17:43:55.545598 [info ] [Thread-1 (]: 1 of 2 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m17:43:55.546600 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.my_first_dbt_model'
[0m17:43:55.547601 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m17:43:55.555600 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m17:43:55.558224 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 17:43:55.547601 => 17:43:55.558224
[0m17:43:55.559224 [debug] [Thread-1 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m17:43:55.597221 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m17:43:55.600222 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m17:43:55.601224 [debug] [Thread-1 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m17:43:55.602224 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:43:59.128512 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m17:43:59.153517 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 17:43:55.560227 => 17:43:59.152515
[0m17:43:59.153517 [debug] [Thread-1 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m17:43:59.658069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c05f9a3-c615-4da2-afbb-9a14c9cf86b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A4D4F4C10>]}
[0m17:43:59.659071 [info ] [Thread-1 (]: 1 of 2 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 4.11s]
[0m17:43:59.661069 [debug] [Thread-1 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m17:43:59.662068 [debug] [Thread-3 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m17:43:59.663068 [info ] [Thread-3 (]: 2 of 2 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m17:43:59.665069 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.my_second_dbt_model'
[0m17:43:59.665069 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m17:43:59.669067 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m17:43:59.671071 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 17:43:59.666069 => 17:43:59.671071
[0m17:43:59.672068 [debug] [Thread-3 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m17:43:59.704069 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m17:43:59.712071 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m17:43:59.713073 [debug] [Thread-3 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m17:43:59.713073 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:44:01.600225 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:44:01.603224 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 17:43:59.672068 => 17:44:01.603224
[0m17:44:01.604224 [debug] [Thread-3 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m17:44:02.169705 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c05f9a3-c615-4da2-afbb-9a14c9cf86b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A4D4F6350>]}
[0m17:44:02.170709 [info ] [Thread-3 (]: 2 of 2 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.51s]
[0m17:44:02.172707 [debug] [Thread-3 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m17:44:02.174687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:02.174687 [debug] [MainThread]: Connection 'create_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m17:44:02.175684 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m17:44:02.175684 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m17:44:02.176696 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m17:44:02.177684 [info ] [MainThread]: 
[0m17:44:02.177684 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 15.23 seconds (15.23s).
[0m17:44:02.179684 [debug] [MainThread]: Command end result
[0m17:44:02.186681 [info ] [MainThread]: 
[0m17:44:02.187683 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:44:02.188685 [info ] [MainThread]: 
[0m17:44:02.189684 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:44:02.190683 [debug] [MainThread]: Command `dbt run` succeeded at 17:44:02.190683 after 17.07 seconds
[0m17:44:02.191682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A4BF3C790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A4CBF0E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A4B55ABD0>]}
[0m17:44:02.192684 [debug] [MainThread]: Flushing usage events
[0m17:44:02.244683 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:46:57.218549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF31296D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF316D350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF2C66CD0>]}


============================== 18:46:57.224550 | 0c3d2b79-de63-4174-bc5c-f243bb89676e ==============================
[0m18:46:57.224550 [info ] [MainThread]: Running with dbt=1.5.2
[0m18:46:57.225548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:46:57.226549 [info ] [MainThread]: dbt version: 1.5.2
[0m18:46:57.227551 [info ] [MainThread]: python version: 3.11.4
[0m18:46:57.228556 [info ] [MainThread]: python path: C:\Users\SNando01\dbt-venv\Scripts\python.exe
[0m18:46:57.231548 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m18:46:57.232547 [info ] [MainThread]: Using profiles.yml file at C:\Users\SNando01\.dbt\profiles.yml
[0m18:46:57.233547 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SNando01\DBT_POC\dbt_project.yml
[0m18:46:57.234547 [info ] [MainThread]: Configuration:
[0m18:46:57.588552 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:46:57.640552 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:46:57.642550 [info ] [MainThread]: Required dependencies:
[0m18:46:57.644551 [debug] [MainThread]: Executing "git --help"
[0m18:46:58.195551 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:46:58.196552 [debug] [MainThread]: STDERR: "b''"
[0m18:46:58.197551 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:46:58.198555 [info ] [MainThread]: Connection:
[0m18:46:58.199552 [info ] [MainThread]:   account: bk40750.east-us-2.azure
[0m18:46:58.200553 [info ] [MainThread]:   user: MHennes3
[0m18:46:58.201551 [info ] [MainThread]:   database: COMMEX_DB
[0m18:46:58.202553 [info ] [MainThread]:   schema: DIGITAL_SHELF_DBT
[0m18:46:58.203551 [info ] [MainThread]:   warehouse: DEV_COMX_GLOBAL_APP1_WH
[0m18:46:58.205552 [info ] [MainThread]:   role: DEV_COMX_GLOBAL_DEVELOPER_FR
[0m18:46:58.206550 [info ] [MainThread]:   client_session_keep_alive: False
[0m18:46:58.207553 [info ] [MainThread]:   query_tag: None
[0m18:46:58.208553 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m18:46:58.210554 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m18:46:58.211553 [debug] [MainThread]: Using snowflake connection "debug"
[0m18:46:58.212553 [debug] [MainThread]: On debug: select 1 as id
[0m18:46:58.212553 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:47:00.365334 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:47:00.367335 [debug] [MainThread]: On debug: Close
[0m18:47:00.865699 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:47:00.866697 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:47:00.868697 [debug] [MainThread]: Command `dbt debug` succeeded at 18:47:00.868697 after 3.96 seconds
[0m18:47:00.869699 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:47:00.869699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF36F1290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF2CD6910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF316CDD0>]}
[0m18:47:00.870700 [debug] [MainThread]: Flushing usage events
[0m18:47:00.942698 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:47:09.216589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165645D16D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016564548D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656454F510>]}


============================== 18:47:09.222590 | b7d376c7-01ad-4f47-8422-d3dd198cf0b2 ==============================
[0m18:47:09.222590 [info ] [MainThread]: Running with dbt=1.5.2
[0m18:47:09.224590 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:47:09.670160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7d376c7-01ad-4f47-8422-d3dd198cf0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016564B79D90>]}
[0m18:47:09.692159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7d376c7-01ad-4f47-8422-d3dd198cf0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016565645850>]}
[0m18:47:09.693165 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m18:47:09.751163 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m18:47:09.789159 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:47:09.791160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b7d376c7-01ad-4f47-8422-d3dd198cf0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016564B79D90>]}
[0m18:47:11.297165 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m18:47:11.311161 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m18:47:11.317164 [debug] [MainThread]: 1699: static parser successfully parsed RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m18:47:11.321161 [debug] [MainThread]: 1699: static parser successfully parsed RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m18:47:11.384166 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_poc.L1
[0m18:47:11.391164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7d376c7-01ad-4f47-8422-d3dd198cf0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656579C910>]}
[0m18:47:11.479165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7d376c7-01ad-4f47-8422-d3dd198cf0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656563D250>]}
[0m18:47:11.480163 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:47:11.482163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7d376c7-01ad-4f47-8422-d3dd198cf0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656020AC50>]}
[0m18:47:11.485163 [info ] [MainThread]: 
[0m18:47:11.486163 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:47:11.488163 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m18:47:11.515165 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m18:47:11.516165 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m18:47:11.516165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:13.634520 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m18:47:13.636523 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m18:47:14.144623 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m18:47:14.151625 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m18:47:14.151625 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m18:47:14.152630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:15.870396 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.0 seconds
[0m18:47:15.872397 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m18:47:16.442276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7d376c7-01ad-4f47-8422-d3dd198cf0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656578B9D0>]}
[0m18:47:16.443275 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:47:16.444271 [info ] [MainThread]: 
[0m18:47:16.470275 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m18:47:16.470275 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m18:47:16.471276 [debug] [Thread-3 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m18:47:16.471276 [info ] [Thread-1 (]: 1 of 4 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m18:47:16.472278 [info ] [Thread-2 (]: 2 of 4 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m18:47:16.474274 [info ] [Thread-3 (]: 3 of 4 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m18:47:16.475275 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m18:47:16.476276 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m18:47:16.477274 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.my_first_dbt_model'
[0m18:47:16.478277 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m18:47:16.478277 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m18:47:16.479274 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m18:47:16.482278 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m18:47:16.484279 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m18:47:16.487275 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m18:47:16.489275 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 18:47:16.479274 => 18:47:16.488278
[0m18:47:16.490274 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m18:47:16.545273 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m18:47:16.546272 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 18:47:16.485273 => 18:47:16.546272
[0m18:47:16.547274 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 18:47:16.482278 => 18:47:16.547274
[0m18:47:16.548276 [debug] [Thread-3 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m18:47:16.549275 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m18:47:16.550273 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m18:47:16.555274 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m18:47:16.572274 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m18:47:16.575276 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m18:47:16.575276 [debug] [Thread-3 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m18:47:16.576276 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:47:16.572274 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (

with source_data as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
        );
[0m18:47:16.578276 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m18:47:16.582276 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with source_data as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date from COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
        );
[0m18:47:16.587273 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:47:16.581276 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:47:20.212728 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m18:47:20.240729 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 18:47:16.551276 => 18:47:20.239727
[0m18:47:20.240729 [debug] [Thread-3 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m18:47:20.293729 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m18:47:20.296730 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 18:47:16.490274 => 18:47:20.296730
[0m18:47:20.297732 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m18:47:20.381730 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m18:47:20.384728 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 18:47:16.556276 => 18:47:20.384728
[0m18:47:20.385726 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m18:47:20.732738 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7d376c7-01ad-4f47-8422-d3dd198cf0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016566002850>]}
[0m18:47:20.733731 [info ] [Thread-3 (]: 3 of 4 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 4.25s]
[0m18:47:20.734735 [debug] [Thread-3 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m18:47:20.735735 [debug] [Thread-4 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m18:47:20.736732 [info ] [Thread-4 (]: 4 of 4 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m18:47:20.738734 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.my_second_dbt_model'
[0m18:47:20.738734 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m18:47:20.743735 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m18:47:20.755731 [debug] [Thread-4 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 18:47:20.739734 => 18:47:20.748731
[0m18:47:20.756734 [debug] [Thread-4 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m18:47:20.828731 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m18:47:20.830735 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m18:47:20.831734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7d376c7-01ad-4f47-8422-d3dd198cf0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016565ED6190>]}
[0m18:47:20.832736 [debug] [Thread-4 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m18:47:20.834735 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:47:20.833734 [info ] [Thread-1 (]: 1 of 4 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.36s]
[0m18:47:20.839732 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m18:47:20.875731 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7d376c7-01ad-4f47-8422-d3dd198cf0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656602E6D0>]}
[0m18:47:20.876733 [info ] [Thread-2 (]: 2 of 4 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 4.40s]
[0m18:47:20.885734 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m18:47:22.847236 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:47:22.852232 [debug] [Thread-4 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 18:47:20.756734 => 18:47:22.852232
[0m18:47:22.853233 [debug] [Thread-4 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m18:47:23.345081 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7d376c7-01ad-4f47-8422-d3dd198cf0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016565ED6590>]}
[0m18:47:23.346085 [info ] [Thread-4 (]: 4 of 4 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.61s]
[0m18:47:23.348081 [debug] [Thread-4 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m18:47:23.350081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:23.351082 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m18:47:23.351082 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m18:47:23.352082 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM' was properly closed.
[0m18:47:23.353083 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m18:47:23.356079 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m18:47:23.362078 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m18:47:23.367080 [info ] [MainThread]: 
[0m18:47:23.368081 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 11.88 seconds (11.88s).
[0m18:47:23.371082 [debug] [MainThread]: Command end result
[0m18:47:23.392081 [info ] [MainThread]: 
[0m18:47:23.394083 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:47:23.395084 [info ] [MainThread]: 
[0m18:47:23.396080 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:47:23.398085 [debug] [MainThread]: Command `dbt run` succeeded at 18:47:23.398085 after 14.47 seconds
[0m18:47:23.399084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656403E910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001655F13FE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001655F13F150>]}
[0m18:47:23.400084 [debug] [MainThread]: Flushing usage events
[0m18:47:23.527080 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:14:15.508720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216672296D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021667199F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216676F7BD0>]}


============================== 19:14:15.519722 | 767cc706-70f8-4c7b-9547-280fc7ee3242 ==============================
[0m19:14:15.519722 [info ] [MainThread]: Running with dbt=1.5.2
[0m19:14:15.520719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:14:15.521720 [info ] [MainThread]: dbt version: 1.5.2
[0m19:14:15.522721 [info ] [MainThread]: python version: 3.11.4
[0m19:14:15.525716 [info ] [MainThread]: python path: C:\Users\SNando01\dbt-venv\Scripts\python.exe
[0m19:14:15.526718 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m19:14:15.527719 [info ] [MainThread]: Using profiles.yml file at C:\Users\SNando01\.dbt\profiles.yml
[0m19:14:15.528718 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SNando01\DBT_POC\dbt_project.yml
[0m19:14:15.529718 [info ] [MainThread]: Configuration:
[0m19:14:17.245959 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:14:17.291960 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:14:17.293961 [info ] [MainThread]: Required dependencies:
[0m19:14:17.294962 [debug] [MainThread]: Executing "git --help"
[0m19:14:17.742756 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:14:17.743756 [debug] [MainThread]: STDERR: "b''"
[0m19:14:17.744758 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:14:17.745757 [info ] [MainThread]: Connection:
[0m19:14:17.746756 [info ] [MainThread]:   account: bk40750.east-us-2.azure
[0m19:14:17.747757 [info ] [MainThread]:   user: MHennes3
[0m19:14:17.748757 [info ] [MainThread]:   database: COMMEX_DB
[0m19:14:17.749757 [info ] [MainThread]:   schema: DIGITAL_SHELF_DBT
[0m19:14:17.750755 [info ] [MainThread]:   warehouse: DEV_COMX_GLOBAL_APP1_WH
[0m19:14:17.759755 [info ] [MainThread]:   role: DEV_COMX_GLOBAL_DEVELOPER_FR
[0m19:14:17.762757 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:14:17.763758 [info ] [MainThread]:   query_tag: None
[0m19:14:17.771756 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m19:14:17.773757 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:14:17.774757 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:14:17.775760 [debug] [MainThread]: On debug: select 1 as id
[0m19:14:17.776758 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:14:20.365438 [debug] [MainThread]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:14:20.366436 [debug] [MainThread]: On debug: Close
[0m19:14:20.889091 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:14:20.891094 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:14:20.892091 [debug] [MainThread]: Command `dbt debug` succeeded at 19:14:20.892091 after 5.75 seconds
[0m19:14:20.893093 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:14:20.893093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216672D6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216672D7390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021666DACFD0>]}
[0m19:14:20.894091 [debug] [MainThread]: Flushing usage events
[0m19:14:21.847719 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:14:33.090509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001769D12DC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001769D0CA990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001769CB655D0>]}


============================== 19:14:33.094510 | 535779e3-aa9e-4d14-8e29-9b3f15d18ad5 ==============================
[0m19:14:33.094510 [info ] [MainThread]: Running with dbt=1.5.2
[0m19:14:33.096510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:14:33.413508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '535779e3-aa9e-4d14-8e29-9b3f15d18ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001769CB54410>]}
[0m19:14:33.426509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '535779e3-aa9e-4d14-8e29-9b3f15d18ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001769E166F10>]}
[0m19:14:33.427511 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m19:14:33.457508 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m19:14:34.040509 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m19:14:34.040509 [debug] [MainThread]: Partial parsing: added file: dbt_poc://models\L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m19:14:34.041510 [debug] [MainThread]: Partial parsing: added file: dbt_poc://models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:14:34.042511 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:14:34.061510 [debug] [MainThread]: 1699: static parser successfully parsed L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m19:14:34.076828 [debug] [MainThread]: 1699: static parser successfully parsed L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:14:34.080826 [debug] [MainThread]: 1699: static parser successfully parsed RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:14:34.093827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '535779e3-aa9e-4d14-8e29-9b3f15d18ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001769E244D10>]}
[0m19:14:34.103830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '535779e3-aa9e-4d14-8e29-9b3f15d18ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001769E3442D0>]}
[0m19:14:34.105829 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:14:34.107830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '535779e3-aa9e-4d14-8e29-9b3f15d18ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017698D0AC50>]}
[0m19:14:34.126831 [info ] [MainThread]: 
[0m19:14:34.133827 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:14:34.139826 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m19:14:34.167832 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m19:14:34.167832 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m19:14:34.168833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:36.179365 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m19:14:36.181365 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m19:14:36.705478 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m19:14:36.712515 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m19:14:36.712515 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m19:14:36.713517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:38.512945 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m19:14:38.514944 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m19:14:39.015807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '535779e3-aa9e-4d14-8e29-9b3f15d18ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001769E265F90>]}
[0m19:14:39.016806 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:14:39.017805 [info ] [MainThread]: 
[0m19:14:39.042814 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:14:39.043806 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:14:39.043806 [debug] [Thread-3 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:14:39.043806 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:14:39.044808 [info ] [Thread-1 (]: 1 of 6 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m19:14:39.045808 [info ] [Thread-2 (]: 2 of 6 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m19:14:39.046809 [info ] [Thread-3 (]: 3 of 6 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m19:14:39.047806 [info ] [Thread-4 (]: 4 of 6 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m19:14:39.048806 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m19:14:39.049807 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m19:14:39.050811 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m19:14:39.051806 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT'
[0m19:14:39.052809 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:14:39.053806 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:14:39.053806 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:14:39.054805 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:14:39.059805 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m19:14:39.087808 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 19:14:39.055825 => 19:14:39.087808
[0m19:14:39.088809 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:14:39.080808 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m19:14:39.077805 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:14:39.085806 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:14:39.142806 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m19:14:39.144806 [debug] [Thread-3 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 19:14:39.078808 => 19:14:39.144806
[0m19:14:39.145808 [debug] [Thread-3 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:14:39.174807 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m19:14:39.175809 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 19:14:39.060807 => 19:14:39.174807
[0m19:14:39.175809 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m19:14:39.176808 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 19:14:39.081807 => 19:14:39.176808
[0m19:14:39.176808 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (

with source_data as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
        );
[0m19:14:39.177809 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:14:39.178808 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:14:39.179806 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:14:39.181808 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m19:14:39.184806 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:14:39.188809 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:14:39.191805 [debug] [Thread-3 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with source_data as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
  );
[0m19:14:39.194807 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:14:39.194807 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:14:39.196809 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:14:39.196809 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with source_data as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
        );
[0m19:14:39.200810 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with source_data as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
  );
[0m19:14:39.201809 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:14:39.203806 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:14:41.337783 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:14:41.357783 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 19:14:39.185810 => 19:14:41.356783
[0m19:14:41.357783 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m19:14:41.372782 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:14:41.375783 [debug] [Thread-3 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 19:14:39.145808 => 19:14:41.374783
[0m19:14:41.375783 [debug] [Thread-3 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m19:14:41.866350 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '535779e3-aa9e-4d14-8e29-9b3f15d18ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001769E270A10>]}
[0m19:14:41.867351 [info ] [Thread-4 (]: 4 of 6 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.81s]
[0m19:14:41.869372 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:14:41.870352 [debug] [Thread-4 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m19:14:41.871352 [info ] [Thread-4 (]: 5 of 6 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m19:14:41.874353 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_first_dbt_model)
[0m19:14:41.875354 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m19:14:41.876352 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '535779e3-aa9e-4d14-8e29-9b3f15d18ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001769E247D50>]}
[0m19:14:41.880352 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m19:14:41.882351 [info ] [Thread-3 (]: 3 of 6 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 2.83s]
[0m19:14:41.883352 [debug] [Thread-3 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:14:41.884354 [debug] [Thread-4 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 19:14:41.876352 => 19:14:41.884354
[0m19:14:41.885351 [debug] [Thread-4 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m19:14:41.889353 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m19:14:41.891354 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m19:14:41.892355 [debug] [Thread-4 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:14:41.893353 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:14:42.087352 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:14:42.094352 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 19:14:39.182809 => 19:14:42.093354
[0m19:14:42.094352 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m19:14:42.602252 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '535779e3-aa9e-4d14-8e29-9b3f15d18ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001769EAA7950>]}
[0m19:14:42.603253 [info ] [Thread-2 (]: 2 of 6 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 3.55s]
[0m19:14:42.604248 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:14:42.660294 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:14:42.664294 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 19:14:39.090804 => 19:14:42.664294
[0m19:14:42.665293 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m19:14:43.164450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '535779e3-aa9e-4d14-8e29-9b3f15d18ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001769EAD5E10>]}
[0m19:14:43.164450 [info ] [Thread-1 (]: 1 of 6 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.11s]
[0m19:14:43.166448 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:14:44.130896 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:14:44.133893 [debug] [Thread-4 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 19:14:41.886353 => 19:14:44.133893
[0m19:14:44.134894 [debug] [Thread-4 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m19:14:44.659453 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '535779e3-aa9e-4d14-8e29-9b3f15d18ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001769E244890>]}
[0m19:14:44.659453 [info ] [Thread-4 (]: 5 of 6 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 2.79s]
[0m19:14:44.661453 [debug] [Thread-4 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m19:14:44.662456 [debug] [Thread-3 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m19:14:44.663453 [info ] [Thread-3 (]: 6 of 6 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m19:14:44.664453 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.my_second_dbt_model)
[0m19:14:44.665461 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m19:14:44.681451 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m19:14:44.683451 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 19:14:44.665461 => 19:14:44.683451
[0m19:14:44.686453 [debug] [Thread-3 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m19:14:44.702455 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m19:14:44.703455 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m19:14:44.704452 [debug] [Thread-3 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m19:14:44.705454 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:14:46.815017 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:14:46.817942 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 19:14:44.686453 => 19:14:46.817942
[0m19:14:46.818942 [debug] [Thread-3 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m19:14:47.347513 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '535779e3-aa9e-4d14-8e29-9b3f15d18ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001769EAD7290>]}
[0m19:14:47.348517 [info ] [Thread-3 (]: 6 of 6 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.68s]
[0m19:14:47.350515 [debug] [Thread-3 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m19:14:47.354512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:47.361511 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m19:14:47.365512 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m19:14:47.369514 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM' was properly closed.
[0m19:14:47.369514 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m19:14:47.370512 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m19:14:47.371518 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m19:14:47.371518 [info ] [MainThread]: 
[0m19:14:47.373513 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 13.24 seconds (13.24s).
[0m19:14:47.375514 [debug] [MainThread]: Command end result
[0m19:14:47.383515 [info ] [MainThread]: 
[0m19:14:47.385513 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:14:47.386516 [info ] [MainThread]: 
[0m19:14:47.387512 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:14:47.389514 [debug] [MainThread]: Command `dbt run` succeeded at 19:14:47.389514 after 14.57 seconds
[0m19:14:47.390514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001769D046E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017697C3F150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001769D034E10>]}
[0m19:14:47.390514 [debug] [MainThread]: Flushing usage events
[0m19:14:47.469511 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m17:26:13.436836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198B23D16D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198B2028F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198B2062A50>]}


============================== 17:26:13.447835 | 7d4a97e5-7e2c-480f-a8b0-183ac3419c01 ==============================
[0m17:26:13.447835 [info ] [MainThread]: Running with dbt=1.5.2
[0m17:26:13.448837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:26:13.449757 [info ] [MainThread]: dbt version: 1.5.2
[0m17:26:13.450757 [info ] [MainThread]: python version: 3.11.4
[0m17:26:13.451757 [info ] [MainThread]: python path: C:\Users\SNando01\dbt-venv\Scripts\python.exe
[0m17:26:13.452758 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m17:26:13.453757 [info ] [MainThread]: Using profiles.yml file at C:\Users\SNando01\.dbt\profiles.yml
[0m17:26:13.455757 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SNando01\DBT_POC\dbt_project.yml
[0m17:26:13.456756 [info ] [MainThread]: Configuration:
[0m17:26:15.190336 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:26:15.228336 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:26:15.232334 [info ] [MainThread]: Required dependencies:
[0m17:26:15.233335 [debug] [MainThread]: Executing "git --help"
[0m17:26:15.728936 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:26:15.728936 [debug] [MainThread]: STDERR: "b''"
[0m17:26:15.728936 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:26:15.745682 [info ] [MainThread]: Connection:
[0m17:26:15.757680 [info ] [MainThread]:   account: bk40750.east-us-2.azure
[0m17:26:15.759681 [info ] [MainThread]:   user: MHennes3
[0m17:26:15.759681 [info ] [MainThread]:   database: COMMEX_DB
[0m17:26:15.761679 [info ] [MainThread]:   schema: DIGITAL_SHELF_DBT
[0m17:26:15.762680 [info ] [MainThread]:   warehouse: DEV_COMX_GLOBAL_APP1_WH
[0m17:26:15.763679 [info ] [MainThread]:   role: DEV_COMX_GLOBAL_DEVELOPER_FR
[0m17:26:15.763679 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:26:15.770678 [info ] [MainThread]:   query_tag: None
[0m17:26:15.787680 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m17:26:15.788680 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:26:15.789678 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:26:15.790678 [debug] [MainThread]: On debug: select 1 as id
[0m17:26:15.791681 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:26:19.201051 [debug] [MainThread]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:26:19.201051 [debug] [MainThread]: On debug: Close
[0m17:26:19.684499 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:26:19.684499 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:26:19.692233 [debug] [MainThread]: Command `dbt debug` succeeded at 17:26:19.691230 after 6.60 seconds
[0m17:26:19.692233 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:26:19.693232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198B230B750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198AD0CBCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198AD0C92D0>]}
[0m17:26:19.693232 [debug] [MainThread]: Flushing usage events
[0m17:26:20.562586 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m17:26:29.027614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC9AD716D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC9AD62C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC9B899F50>]}


============================== 17:26:29.027614 | dd1f3187-3616-4528-a6ac-7028d256ff6d ==============================
[0m17:26:29.027614 [info ] [MainThread]: Running with dbt=1.5.2
[0m17:26:29.027614 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:26:29.385191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd1f3187-3616-4528-a6ac-7028d256ff6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC9ADEE9D0>]}
[0m17:26:29.388704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd1f3187-3616-4528-a6ac-7028d256ff6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC9AD72450>]}
[0m17:26:29.404892 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m17:26:29.442893 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m17:26:30.011195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:26:30.011195 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m17:26:30.026847 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m17:26:30.042852 [error] [MainThread]: Encountered an error:
Compilation Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql)
  invalid syntax for function call expression
    line 1
      {{ config(materialized='table',
[0m17:26:30.047961 [debug] [MainThread]: Command `dbt run` failed at 17:26:30.047961 after 1.28 seconds
[0m17:26:30.048964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC9AD29090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC9B879610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC9B274150>]}
[0m17:26:30.049961 [debug] [MainThread]: Flushing usage events
[0m17:26:30.116961 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:44:36.946178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E9F6416D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E9F166750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E9F155690>]}


============================== 18:44:36.961805 | 2da44a64-7028-445b-a052-ba23ccf45b05 ==============================
[0m18:44:36.961805 [info ] [MainThread]: Running with dbt=1.5.2
[0m18:44:36.961805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:44:36.969487 [info ] [MainThread]: dbt version: 1.5.2
[0m18:44:36.970489 [info ] [MainThread]: python version: 3.11.4
[0m18:44:36.971488 [info ] [MainThread]: python path: C:\Users\SNando01\dbt-venv\Scripts\python.exe
[0m18:44:36.971488 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m18:44:36.972492 [info ] [MainThread]: Using profiles.yml file at C:\Users\SNando01\.dbt\profiles.yml
[0m18:44:36.973491 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SNando01\DBT_POC\dbt_project.yml
[0m18:44:36.973491 [info ] [MainThread]: Configuration:
[0m18:44:38.737166 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:44:38.779919 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:44:38.780919 [info ] [MainThread]: Required dependencies:
[0m18:44:38.781920 [debug] [MainThread]: Executing "git --help"
[0m18:44:39.257545 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:44:39.257545 [debug] [MainThread]: STDERR: "b''"
[0m18:44:39.257545 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:44:39.257545 [info ] [MainThread]: Connection:
[0m18:44:39.266938 [info ] [MainThread]:   account: bk40750.east-us-2.azure
[0m18:44:39.267937 [info ] [MainThread]:   user: MHennes3
[0m18:44:39.268937 [info ] [MainThread]:   database: COMMEX_DB
[0m18:44:39.269941 [info ] [MainThread]:   schema: DIGITAL_SHELF_DBT
[0m18:44:39.270937 [info ] [MainThread]:   warehouse: DEV_COMX_GLOBAL_APP1_WH
[0m18:44:39.275936 [info ] [MainThread]:   role: DEV_COMX_GLOBAL_DEVELOPER_FR
[0m18:44:39.282938 [info ] [MainThread]:   client_session_keep_alive: False
[0m18:44:39.283937 [info ] [MainThread]:   query_tag: None
[0m18:44:39.326940 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m18:44:39.356941 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m18:44:39.358939 [debug] [MainThread]: Using snowflake connection "debug"
[0m18:44:39.359940 [debug] [MainThread]: On debug: select 1 as id
[0m18:44:39.359940 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:44:59.302371 [debug] [MainThread]: SQL status: SUCCESS 1 in 20.0 seconds
[0m18:44:59.302371 [debug] [MainThread]: On debug: Close
[0m18:44:59.956371 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:44:59.963076 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:44:59.964077 [debug] [MainThread]: Command `dbt debug` succeeded at 18:44:59.964077 after 23.37 seconds
[0m18:44:59.965088 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:44:59.965088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E9F62C150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E9A23F1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E9A23F150>]}
[0m18:44:59.967074 [debug] [MainThread]: Flushing usage events
[0m18:45:00.924956 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:45:13.784941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FAED46A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FAF14BC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FAE83DD90>]}


============================== 18:45:13.784941 | 299fe582-261d-47a3-834d-2989e0ad778c ==============================
[0m18:45:13.784941 [info ] [MainThread]: Running with dbt=1.5.2
[0m18:45:13.784941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:45:14.099304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '299fe582-261d-47a3-834d-2989e0ad778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FAF39A3D0>]}
[0m18:45:14.115338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '299fe582-261d-47a3-834d-2989e0ad778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FAFF50FD0>]}
[0m18:45:14.115338 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m18:45:14.144420 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m18:45:14.716278 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m18:45:14.716278 [debug] [MainThread]: Partial parsing: added file: dbt_poc://models\RAW\TBL_.sql
[0m18:45:14.716278 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m18:45:14.716278 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m18:45:14.731907 [debug] [MainThread]: 1699: static parser successfully parsed RAW\TBL_.sql
[0m18:45:14.747532 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m18:45:14.768441 [error] [MainThread]: Encountered an error:
Compilation Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql)
  invalid syntax for function call expression
    line 1
      {{ config(materialized='table',
[0m18:45:14.770442 [debug] [MainThread]: Command `dbt run` failed at 18:45:14.770442 after 1.24 seconds
[0m18:45:14.771440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FAED46C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FAED5C150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FB001C210>]}
[0m18:45:14.778438 [debug] [MainThread]: Flushing usage events
[0m18:45:14.833442 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:45:51.628674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189AC17C2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189AC167790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189AC166ED0>]}


============================== 18:45:51.628674 | cd579118-3499-40d5-a5de-7463474e53d7 ==============================
[0m18:45:51.628674 [info ] [MainThread]: Running with dbt=1.5.2
[0m18:45:51.628674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:45:51.929812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd579118-3499-40d5-a5de-7463474e53d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189AC730CD0>]}
[0m18:45:51.945455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd579118-3499-40d5-a5de-7463474e53d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189AD780350>]}
[0m18:45:51.945455 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m18:45:51.980013 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m18:45:52.063013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m18:45:52.064015 [debug] [MainThread]: Partial parsing: added file: dbt_poc://models\RAW\TBL_.sql
[0m18:45:52.065012 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m18:45:52.066015 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m18:45:52.095015 [debug] [MainThread]: 1699: static parser successfully parsed RAW\TBL_.sql
[0m18:45:52.110014 [debug] [MainThread]: 1699: static parser successfully parsed L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m18:45:52.114014 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m18:45:52.114014 [error] [MainThread]: Encountered an error:
Compilation Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql)
  expected token ',', got '='
    line 2
      post-hook= 'TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m18:45:52.119091 [debug] [MainThread]: Command `dbt run` failed at 18:45:52.119091 after 0.75 seconds
[0m18:45:52.120093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189AC12E790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189ACC78DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189AC17C150>]}
[0m18:45:52.123089 [debug] [MainThread]: Flushing usage events
[0m18:45:52.882885 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:47:43.929953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2CDD66C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2CDD66F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2CE23D650>]}


============================== 18:47:43.929953 | d05338f0-69eb-41b1-879f-28d1855ef7fa ==============================
[0m18:47:43.929953 [info ] [MainThread]: Running with dbt=1.5.2
[0m18:47:43.929953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:47:44.241164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd05338f0-69eb-41b1-879f-28d1855ef7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2CDD29650>]}
[0m18:47:44.256810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd05338f0-69eb-41b1-879f-28d1855ef7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2CF36BD50>]}
[0m18:47:44.256810 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m18:47:44.291846 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m18:47:44.377850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m18:47:44.378852 [debug] [MainThread]: Partial parsing: added file: dbt_poc://models\RAW\TBL_.sql
[0m18:47:44.379849 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m18:47:44.379849 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m18:47:44.402850 [debug] [MainThread]: 1699: static parser successfully parsed RAW\TBL_.sql
[0m18:47:44.418851 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m18:47:44.421852 [error] [MainThread]: Encountered an error:
Compilation Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql)
  expected token ',', got '='
    line 2
      pre-hook='TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m18:47:44.424849 [debug] [MainThread]: Command `dbt run` failed at 18:47:44.424849 after 0.75 seconds
[0m18:47:44.424849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2CDD64150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2CE8796D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2CF41C210>]}
[0m18:47:44.425850 [debug] [MainThread]: Flushing usage events
[0m18:47:44.501847 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:15:10.712811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B8A3296D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B8A352190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B8A3511D0>]}


============================== 19:15:10.728444 | 554c2908-043a-4b9b-ad9c-fcaac655cd75 ==============================
[0m19:15:10.728444 [info ] [MainThread]: Running with dbt=1.5.2
[0m19:15:10.728444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:15:12.506182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '554c2908-043a-4b9b-ad9c-fcaac655cd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B8A9987D0>]}
[0m19:15:12.521824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '554c2908-043a-4b9b-ad9c-fcaac655cd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B8B56C2D0>]}
[0m19:15:12.521824 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m19:15:12.574958 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m19:15:12.645957 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_poc: example\schema.yml - Runtime Error
    Syntax error near line 19
    ------------------------------
    16 |           identifier: false
    17 | 
    18 | PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 18, column 1
    could not find expected ':'
      in "<unicode string>", line 19, column 1
[0m19:15:12.652955 [debug] [MainThread]: Command `dbt run` failed at 19:15:12.649957 after 2.31 seconds
[0m19:15:12.658957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B89E55D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B8A99A190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B8A999650>]}
[0m19:15:12.659961 [debug] [MainThread]: Flushing usage events
[0m19:15:13.506275 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:20:15.483324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1E964CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1E929E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1EE29F90>]}


============================== 20:20:15.499334 | 11d57119-b72b-40f1-80a7-bf4e8121194f ==============================
[0m20:20:15.499334 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:20:15.499334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:20:17.172960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11d57119-b72b-40f1-80a7-bf4e8121194f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1F4A8D90>]}
[0m20:20:17.188987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11d57119-b72b-40f1-80a7-bf4e8121194f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1FF6BDD0>]}
[0m20:20:17.188987 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:20:17.237082 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:20:17.799193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m20:20:17.799193 [debug] [MainThread]: Partial parsing: added file: dbt_poc://models\RAW\TBL_.sql
[0m20:20:17.799193 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\example\schema.yml
[0m20:20:17.799193 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m20:20:17.799193 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m20:20:17.830436 [debug] [MainThread]: 1699: static parser successfully parsed RAW\TBL_.sql
[0m20:20:17.830436 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m20:20:17.846062 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m20:20:17.846062 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m20:20:17.846062 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m20:20:17.846062 [debug] [MainThread]: 1699: static parser successfully parsed L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m20:20:17.877319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11d57119-b72b-40f1-80a7-bf4e8121194f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1FF70050>]}
[0m20:20:17.892942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11d57119-b72b-40f1-80a7-bf4e8121194f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1EE3FC50>]}
[0m20:20:17.892942 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m20:20:17.900725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11d57119-b72b-40f1-80a7-bf4e8121194f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1AB0AE90>]}
[0m20:20:17.903724 [info ] [MainThread]: 
[0m20:20:17.913724 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:20:17.918724 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m20:20:17.935727 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m20:20:17.935727 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m20:20:17.936722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:20.451501 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m20:20:20.451501 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m20:20:20.956949 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m20:20:20.956949 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m20:20:20.956949 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m20:20:20.956949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:22.807818 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m20:20:22.809819 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m20:20:23.348992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11d57119-b72b-40f1-80a7-bf4e8121194f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A20163150>]}
[0m20:20:23.349992 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:20:23.350989 [info ] [MainThread]: 
[0m20:20:23.358246 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:20:23.358246 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:20:23.359247 [debug] [Thread-3 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:20:23.359247 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:20:23.359247 [info ] [Thread-1 (]: 1 of 6 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m20:20:23.360248 [info ] [Thread-2 (]: 2 of 6 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m20:20:23.361250 [info ] [Thread-3 (]: 3 of 6 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m20:20:23.362250 [info ] [Thread-4 (]: 4 of 6 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m20:20:23.363248 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m20:20:23.364252 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m20:20:23.365246 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m20:20:23.366248 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT'
[0m20:20:23.366248 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:20:23.367248 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:20:23.367248 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:20:23.368248 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:20:23.371247 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:20:23.374248 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:20:23.377250 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:20:23.389251 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:20:23.391247 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 20:20:23.368248 => 20:20:23.391247
[0m20:20:23.392250 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:20:23.371247 => 20:20:23.392250
[0m20:20:23.393250 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:20:23.394251 [debug] [Thread-3 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 20:20:23.375249 => 20:20:23.393250
[0m20:20:23.394551 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:20:23.395247 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:20:23.379245 => 20:20:23.395247
[0m20:20:23.429249 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:20:23.429249 [debug] [Thread-3 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:20:23.456244 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:20:23.457244 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:20:23.458248 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:20:23.482252 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:20:23.485251 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:20:23.486249 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:20:23.487247 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:20:23.490248 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:20:23.492250 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:20:23.494250 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with source_data as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
        );
[0m20:20:23.495250 [debug] [Thread-3 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with source_data as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
  );
[0m20:20:23.496251 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with source_data as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
  );
[0m20:20:23.496251 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:20:23.497248 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:20:23.499249 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:20:25.779087 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:20:25.779087 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:20:25.779087 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:20:25.779087 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with source_data as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
        );
[0m20:20:25.794692 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:20:25.810321 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:20:23.482252 => 20:20:25.810321
[0m20:20:25.810321 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:20:25.857195 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:20:25.857195 [debug] [Thread-3 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 20:20:23.458248 => 20:20:25.857195
[0m20:20:25.872818 [debug] [Thread-3 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m20:20:26.326686 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d57119-b72b-40f1-80a7-bf4e8121194f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A2097D950>]}
[0m20:20:26.326686 [info ] [Thread-4 (]: 4 of 6 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.96s]
[0m20:20:26.342310 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:20:26.342310 [debug] [Thread-4 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m20:20:26.342310 [info ] [Thread-4 (]: 5 of 6 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m20:20:26.342310 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_first_dbt_model)
[0m20:20:26.342310 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m20:20:26.353608 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m20:20:26.355606 [debug] [Thread-4 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 20:20:26.342310 => 20:20:26.355606
[0m20:20:26.356606 [debug] [Thread-4 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m20:20:26.360606 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m20:20:26.363608 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m20:20:26.363608 [debug] [Thread-4 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:20:26.364609 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:20:26.371609 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d57119-b72b-40f1-80a7-bf4e8121194f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A2097C5D0>]}
[0m20:20:26.372609 [info ] [Thread-3 (]: 3 of 6 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 3.01s]
[0m20:20:26.374609 [debug] [Thread-3 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:20:27.344154 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m20:20:27.359794 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:20:23.430248 => 20:20:27.359794
[0m20:20:27.359794 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:20:27.469168 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:20:27.469168 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 20:20:23.395247 => 20:20:27.469168
[0m20:20:27.469168 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m20:20:27.889344 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d57119-b72b-40f1-80a7-bf4e8121194f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A2098FDD0>]}
[0m20:20:27.889344 [info ] [Thread-2 (]: 2 of 6 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 4.53s]
[0m20:20:27.904984 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:20:27.977393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d57119-b72b-40f1-80a7-bf4e8121194f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1FF723D0>]}
[0m20:20:27.978393 [info ] [Thread-1 (]: 1 of 6 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.61s]
[0m20:20:27.983392 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:20:29.173089 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:20:29.176087 [debug] [Thread-4 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 20:20:26.356606 => 20:20:29.176087
[0m20:20:29.176087 [debug] [Thread-4 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m20:20:29.712588 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d57119-b72b-40f1-80a7-bf4e8121194f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A20AC5010>]}
[0m20:20:29.712588 [info ] [Thread-4 (]: 5 of 6 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 3.37s]
[0m20:20:29.714590 [debug] [Thread-4 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m20:20:29.715593 [debug] [Thread-3 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m20:20:29.716590 [info ] [Thread-3 (]: 6 of 6 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m20:20:29.717590 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.my_second_dbt_model)
[0m20:20:29.718592 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m20:20:29.727588 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m20:20:29.735590 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 20:20:29.718592 => 20:20:29.734588
[0m20:20:29.735590 [debug] [Thread-3 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m20:20:29.831019 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m20:20:29.832017 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m20:20:29.833021 [debug] [Thread-3 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m20:20:29.834021 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:20:31.842013 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:20:31.842013 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 20:20:29.736593 => 20:20:31.842013
[0m20:20:31.842013 [debug] [Thread-3 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m20:20:32.365570 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d57119-b72b-40f1-80a7-bf4e8121194f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1FF30CD0>]}
[0m20:20:32.366569 [info ] [Thread-3 (]: 6 of 6 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.65s]
[0m20:20:32.367571 [debug] [Thread-3 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m20:20:32.370293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:32.370293 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m20:20:32.371295 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m20:20:32.371295 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM' was properly closed.
[0m20:20:32.372295 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m20:20:32.372295 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m20:20:32.373294 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m20:20:32.374293 [info ] [MainThread]: 
[0m20:20:32.375294 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 14.46 seconds (14.46s).
[0m20:20:32.377296 [debug] [MainThread]: Command end result
[0m20:20:32.401293 [info ] [MainThread]: 
[0m20:20:32.402295 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:20:32.403292 [info ] [MainThread]: 
[0m20:20:32.404295 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:20:32.406295 [debug] [MainThread]: Command `dbt run` succeeded at 20:20:32.406295 after 17.26 seconds
[0m20:20:32.407295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1F33DA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1E702510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A19A3F150>]}
[0m20:20:32.407295 [debug] [MainThread]: Flushing usage events
[0m20:20:33.296442 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:28:26.152859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C88D5C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C8E9AD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C88CF310>]}


============================== 20:28:26.165862 | 810a1351-862b-4a9f-9f29-1699b5f32043 ==============================
[0m20:28:26.165862 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:28:26.167859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:28:28.030099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '810a1351-862b-4a9f-9f29-1699b5f32043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C8E79750>]}
[0m20:28:28.045738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '810a1351-862b-4a9f-9f29-1699b5f32043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C995CE50>]}
[0m20:28:28.061366 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:28:28.102481 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:28:28.658719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:28:28.658719 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:28:28.658719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '810a1351-862b-4a9f-9f29-1699b5f32043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C3879250>]}
[0m20:28:28.674338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '810a1351-862b-4a9f-9f29-1699b5f32043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C99C9550>]}
[0m20:28:28.674338 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m20:28:28.679170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '810a1351-862b-4a9f-9f29-1699b5f32043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C450AC50>]}
[0m20:28:28.682175 [info ] [MainThread]: 
[0m20:28:28.683170 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:28:28.714171 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m20:28:28.737170 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m20:28:28.738167 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m20:28:28.738167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:31.264496 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m20:28:31.264496 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m20:28:31.795557 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m20:28:31.811166 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m20:28:31.811166 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m20:28:31.811166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:33.701909 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m20:28:33.701909 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m20:28:34.217379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '810a1351-862b-4a9f-9f29-1699b5f32043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C7A30990>]}
[0m20:28:34.217379 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:28:34.217379 [info ] [MainThread]: 
[0m20:28:34.241009 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:28:34.241451 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:28:34.241451 [debug] [Thread-3 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:28:34.242448 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:28:34.242448 [info ] [Thread-1 (]: 1 of 6 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m20:28:34.243446 [info ] [Thread-2 (]: 2 of 6 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m20:28:34.244446 [info ] [Thread-3 (]: 3 of 6 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m20:28:34.245450 [info ] [Thread-4 (]: 4 of 6 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m20:28:34.246448 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m20:28:34.247447 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m20:28:34.248449 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m20:28:34.249450 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT'
[0m20:28:34.250449 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:28:34.250449 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:28:34.251449 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:28:34.252447 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:28:34.264445 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:28:34.268450 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:28:34.271448 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:28:34.273445 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:28:34.275447 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:28:34.265449 => 20:28:34.274448
[0m20:28:34.275447 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 20:28:34.252447 => 20:28:34.275447
[0m20:28:34.277449 [debug] [Thread-3 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 20:28:34.269447 => 20:28:34.276447
[0m20:28:34.279449 [debug] [Thread-3 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:28:34.277449 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:28:34.279449 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:28:34.271448 => 20:28:34.278449
[0m20:28:34.278449 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:28:34.349447 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:28:34.361446 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:28:34.362444 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:28:34.364445 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:28:34.369445 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:28:34.369445 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:28:34.373448 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:28:34.371449 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:28:34.372448 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:28:34.377449 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with source_data as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
        );
[0m20:28:34.378448 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:28:34.379449 [debug] [Thread-3 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with source_data as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
  );
[0m20:28:34.380449 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:28:34.381449 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with source_data as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
  );
[0m20:28:34.381449 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:28:34.384446 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:28:36.592466 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:28:36.608096 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:28:34.366446 => 20:28:36.608096
[0m20:28:36.608096 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:28:36.608096 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:28:36.623715 [debug] [Thread-3 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 20:28:34.280449 => 20:28:36.623715
[0m20:28:36.623715 [debug] [Thread-3 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m20:28:36.717466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:28:36.734311 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:28:36.736316 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:28:36.736316 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with source_data as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
        );
[0m20:28:37.129280 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '810a1351-862b-4a9f-9f29-1699b5f32043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CA134810>]}
[0m20:28:37.129280 [info ] [Thread-4 (]: 4 of 6 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.88s]
[0m20:28:37.129280 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:28:37.133661 [debug] [Thread-4 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m20:28:37.134663 [info ] [Thread-4 (]: 5 of 6 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m20:28:37.135660 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_first_dbt_model)
[0m20:28:37.136660 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m20:28:37.142659 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m20:28:37.144659 [debug] [Thread-4 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 20:28:37.137664 => 20:28:37.144659
[0m20:28:37.145660 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '810a1351-862b-4a9f-9f29-1699b5f32043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CA133F50>]}
[0m20:28:37.146660 [debug] [Thread-4 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m20:28:37.147660 [info ] [Thread-3 (]: 3 of 6 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 2.90s]
[0m20:28:37.161659 [debug] [Thread-3 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:28:37.169659 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m20:28:37.175662 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m20:28:37.176663 [debug] [Thread-4 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:28:37.177663 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:28:37.284665 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:28:37.289661 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:28:34.298447 => 20:28:37.288664
[0m20:28:37.289661 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:28:37.789442 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '810a1351-862b-4a9f-9f29-1699b5f32043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C892FED0>]}
[0m20:28:37.789442 [info ] [Thread-2 (]: 2 of 6 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 3.53s]
[0m20:28:37.789442 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:28:38.029820 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:28:38.045456 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 20:28:34.362444 => 20:28:38.029820
[0m20:28:38.045456 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m20:28:38.561764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '810a1351-862b-4a9f-9f29-1699b5f32043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CA1E9E90>]}
[0m20:28:38.561764 [info ] [Thread-1 (]: 1 of 6 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.32s]
[0m20:28:38.561764 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:28:39.546100 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:28:39.546100 [debug] [Thread-4 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 20:28:37.153663 => 20:28:39.546100
[0m20:28:39.546100 [debug] [Thread-4 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m20:28:40.046847 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '810a1351-862b-4a9f-9f29-1699b5f32043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C99D4150>]}
[0m20:28:40.046847 [info ] [Thread-4 (]: 5 of 6 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 2.91s]
[0m20:28:40.051454 [debug] [Thread-4 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m20:28:40.052454 [debug] [Thread-3 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m20:28:40.052454 [info ] [Thread-3 (]: 6 of 6 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m20:28:40.070454 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.my_second_dbt_model)
[0m20:28:40.070454 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m20:28:40.074457 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m20:28:40.076453 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 20:28:40.071454 => 20:28:40.075455
[0m20:28:40.076453 [debug] [Thread-3 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m20:28:40.080456 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m20:28:40.082455 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m20:28:40.083455 [debug] [Thread-3 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m20:28:40.083455 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:28:41.941194 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:28:41.941194 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 20:28:40.077456 => 20:28:41.941194
[0m20:28:41.941194 [debug] [Thread-3 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m20:28:42.467169 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '810a1351-862b-4a9f-9f29-1699b5f32043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C99D2B10>]}
[0m20:28:42.467169 [info ] [Thread-3 (]: 6 of 6 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.40s]
[0m20:28:42.471855 [debug] [Thread-3 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m20:28:42.473858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:42.477853 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m20:28:42.485852 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m20:28:42.489854 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM' was properly closed.
[0m20:28:42.490857 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m20:28:42.490857 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m20:28:42.491856 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m20:28:42.492857 [info ] [MainThread]: 
[0m20:28:42.493983 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 13.81 seconds (13.81s).
[0m20:28:42.495856 [debug] [MainThread]: Command end result
[0m20:28:42.503855 [info ] [MainThread]: 
[0m20:28:42.519853 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:28:42.523858 [info ] [MainThread]: 
[0m20:28:42.526856 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:28:42.527854 [debug] [MainThread]: Command `dbt run` succeeded at 20:28:42.527854 after 16.74 seconds
[0m20:28:42.528857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C8EA17D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C85F7E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C3890AD0>]}
[0m20:28:42.529856 [debug] [MainThread]: Flushing usage events
[0m20:28:43.483366 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:49:54.346060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F9216B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F8D6AB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F924FBD0>]}


============================== 20:49:54.361688 | 24ac26cd-73a6-4851-87ff-754b9b16ee72 ==============================
[0m20:49:54.361688 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:49:54.361688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:49:56.099501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24ac26cd-73a6-4851-87ff-754b9b16ee72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F9873A10>]}
[0m20:49:56.115139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24ac26cd-73a6-4851-87ff-754b9b16ee72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228FA380350>]}
[0m20:49:56.126149 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:49:56.158712 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:49:56.733253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m20:49:56.734253 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:49:56.735253 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m20:49:56.735253 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_.sql
[0m20:49:56.755257 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:49:56.770253 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:49:56.774254 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m20:49:56.779255 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m20:49:56.781255 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_.sql
[0m20:49:56.782256 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_.sql
[0m20:49:56.782256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24ac26cd-73a6-4851-87ff-754b9b16ee72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F924D5D0>]}
[0m20:49:56.797923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24ac26cd-73a6-4851-87ff-754b9b16ee72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228FA564DD0>]}
[0m20:49:56.797923 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m20:49:56.797923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ac26cd-73a6-4851-87ff-754b9b16ee72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228FA42A710>]}
[0m20:49:56.811123 [info ] [MainThread]: 
[0m20:49:56.817120 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:49:56.829122 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m20:49:56.843119 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m20:49:56.843119 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m20:49:56.844121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:59.438495 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m20:49:59.438495 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m20:49:59.955798 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m20:49:59.964798 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m20:49:59.964798 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m20:49:59.965799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:01.641865 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m20:50:01.657495 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m20:50:02.191399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ac26cd-73a6-4851-87ff-754b9b16ee72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228FA51C2D0>]}
[0m20:50:02.191399 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:50:02.191399 [info ] [MainThread]: 
[0m20:50:02.215607 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_
[0m20:50:02.216069 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:50:02.216069 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:50:02.216607 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:50:02.216607 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_ ............................ [RUN]
[0m20:50:02.217607 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m20:50:02.218611 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m20:50:02.219608 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m20:50:02.221609 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_'
[0m20:50:02.228607 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_
[0m20:50:02.222608 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m20:50:02.224607 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m20:50:02.223609 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m20:50:02.237609 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_"
[0m20:50:02.237609 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:50:02.238610 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:50:02.239607 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:50:02.239607 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_ (compile): 20:50:02.231608 => 20:50:02.239607
[0m20:50:02.242606 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:50:02.244609 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:50:02.247605 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:50:02.247605 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_
[0m20:50:02.249608 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 20:50:02.242606 => 20:50:02.249608
[0m20:50:02.286606 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:50:02.282605 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_"
[0m20:50:02.284609 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:50:02.245609 => 20:50:02.283606
[0m20:50:02.283606 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 20:50:02.240611 => 20:50:02.283606
[0m20:50:02.331608 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:50:02.332610 [debug] [Thread-1 (]: On model.dbt_poc.TBL_: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:50:02.333608 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:50:02.334608 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:50:02.335608 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:50:02.336607 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:50:02.340608 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:50:02.343608 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:50:02.347609 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with source_data as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
  );
[0m20:50:02.348607 [debug] [Thread-3 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:50:02.349608 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:50:02.349608 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:50:02.351609 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:50:02.351609 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:50:04.564248 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:50:04.579854 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:50:04.579854 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:50:04.595484 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 20:50:02.291606 => 20:50:04.595484
[0m20:50:04.595484 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:50:04.595484 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m20:50:04.595484 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with source_data as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
        );
[0m20:50:04.720343 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:50:04.720343 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:50:04.720343 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:50:04.720343 [debug] [Thread-3 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with source_data as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
        );
[0m20:50:05.099732 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ac26cd-73a6-4851-87ff-754b9b16ee72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228FA521010>]}
[0m20:50:05.099732 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 2.88s]
[0m20:50:05.099732 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:50:05.115080 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:50:05.116079 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m20:50:05.118081 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m20:50:05.118081 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:50:05.124081 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:50:05.125081 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:50:05.119081 => 20:50:05.125081
[0m20:50:05.126081 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:50:05.131081 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:50:05.133080 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:50:05.134080 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with source_data as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
  );
[0m20:50:05.135080 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:50:06.469726 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:50:06.469726 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 20:50:02.340608 => 20:50:06.469726
[0m20:50:06.469726 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m20:50:06.563462 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:50:06.579091 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:50:02.337608 => 20:50:06.579091
[0m20:50:06.579091 [debug] [Thread-3 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:50:06.823481 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m20:50:06.825478 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_"
[0m20:50:06.826477 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_"
[0m20:50:06.827478 [debug] [Thread-1 (]: On model.dbt_poc.TBL_: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_
         as
        (
        );
[0m20:50:07.007257 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ac26cd-73a6-4851-87ff-754b9b16ee72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228FAD7B750>]}
[0m20:50:07.007257 [info ] [Thread-2 (]: 2 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.79s]
[0m20:50:07.022883 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:50:07.023250 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m20:50:07.024252 [info ] [Thread-2 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m20:50:07.026253 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:50:07.026253 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM, now model.dbt_poc.my_first_dbt_model)
[0m20:50:07.032251 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:50:05.126081 => 20:50:07.032251
[0m20:50:07.033250 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m20:50:07.034250 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:50:07.038251 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m20:50:07.049250 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 20:50:07.034250 => 20:50:07.048564
[0m20:50:07.050252 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m20:50:07.054251 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m20:50:07.056251 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m20:50:07.057251 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:50:07.058253 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:50:07.106250 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ac26cd-73a6-4851-87ff-754b9b16ee72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228FAE4F990>]}
[0m20:50:07.107252 [info ] [Thread-3 (]: 3 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 4.88s]
[0m20:50:07.118252 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:50:07.295251 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad7298-0b04-b5e4-0002-a65600eefe8a
[0m20:50:07.295251 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 8 unexpected ')'.
[0m20:50:07.296249 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_ (execute): 20:50:02.249608 => 20:50:07.296249
[0m20:50:07.297252 [debug] [Thread-1 (]: On model.dbt_poc.TBL_: Close
[0m20:50:07.574535 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ac26cd-73a6-4851-87ff-754b9b16ee72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228FA564A10>]}
[0m20:50:07.574535 [info ] [Thread-4 (]: 5 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.46s]
[0m20:50:07.574535 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:50:07.815273 [debug] [Thread-1 (]: Database Error in model TBL_ (models\RAW\TBL_.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 8 unexpected ')'.
  compiled Code at target\run\dbt_poc\models\RAW\TBL_.sql
[0m20:50:07.816275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ac26cd-73a6-4851-87ff-754b9b16ee72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228FA565050>]}
[0m20:50:07.816275 [error] [Thread-1 (]: 1 of 7 ERROR creating sql table model DIGITAL_SHELF_DBT.TBL_ ................... [[31mERROR[0m in 5.59s]
[0m20:50:07.818269 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_
[0m20:50:09.464948 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:50:09.468947 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 20:50:07.050252 => 20:50:09.468947
[0m20:50:09.469947 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m20:50:09.970171 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ac26cd-73a6-4851-87ff-754b9b16ee72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228FAD88BD0>]}
[0m20:50:09.971170 [info ] [Thread-2 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 2.94s]
[0m20:50:09.972172 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m20:50:09.973175 [debug] [Thread-3 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m20:50:09.974172 [info ] [Thread-3 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m20:50:09.992175 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_second_dbt_model)
[0m20:50:09.993172 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m20:50:09.996169 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m20:50:09.998173 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 20:50:09.993172 => 20:50:09.997169
[0m20:50:09.998173 [debug] [Thread-3 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m20:50:10.007171 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m20:50:10.023173 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m20:50:10.024174 [debug] [Thread-3 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m20:50:10.025173 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:50:12.020126 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:50:12.020126 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 20:50:09.999174 => 20:50:12.020126
[0m20:50:12.020126 [debug] [Thread-3 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m20:50:12.563472 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ac26cd-73a6-4851-87ff-754b9b16ee72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F59D39D0>]}
[0m20:50:12.563472 [info ] [Thread-3 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.57s]
[0m20:50:12.577836 [debug] [Thread-3 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m20:50:12.584833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:12.589833 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m20:50:12.596835 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m20:50:12.596835 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_' was properly closed.
[0m20:50:12.597836 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m20:50:12.598836 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m20:50:12.598836 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m20:50:12.599837 [info ] [MainThread]: 
[0m20:50:12.600836 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 15.79 seconds (15.79s).
[0m20:50:12.618833 [debug] [MainThread]: Command end result
[0m20:50:12.722838 [info ] [MainThread]: 
[0m20:50:12.723837 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:50:12.725835 [info ] [MainThread]: 
[0m20:50:12.726837 [error] [MainThread]: [33mDatabase Error in model TBL_ (models\RAW\TBL_.sql)[0m
[0m20:50:12.727836 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m20:50:12.728835 [error] [MainThread]:   syntax error line 4 at position 8 unexpected ')'.
[0m20:50:12.729835 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\RAW\TBL_.sql
[0m20:50:12.730836 [info ] [MainThread]: 
[0m20:50:12.731834 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m20:50:12.734835 [debug] [MainThread]: Command `dbt run` failed at 20:50:12.734835 after 18.72 seconds
[0m20:50:12.735837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F932B0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F875A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F427BD10>]}
[0m20:50:12.735837 [debug] [MainThread]: Flushing usage events
[0m20:50:13.613136 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:50:50.063519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001714DB516D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001714D18D7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001714D6B6E10>]}


============================== 20:50:50.063519 | 19518439-fa71-402b-943c-c17188758b71 ==============================
[0m20:50:50.063519 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:50:50.063519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:50:50.394390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19518439-fa71-402b-943c-c17188758b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001714E173190>]}
[0m20:50:50.410416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19518439-fa71-402b-943c-c17188758b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001714DB50350>]}
[0m20:50:50.410416 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:50:50.453597 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:50:50.551598 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:50:50.552597 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_.sql
[0m20:50:50.564594 [debug] [MainThread]: 1699: static parser successfully parsed RAW\TBL_.sql
[0m20:50:50.596299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19518439-fa71-402b-943c-c17188758b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001714E1B5450>]}
[0m20:50:50.596299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19518439-fa71-402b-943c-c17188758b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001714ED296D0>]}
[0m20:50:50.596299 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m20:50:50.596299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19518439-fa71-402b-943c-c17188758b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001714980AC50>]}
[0m20:50:50.614104 [info ] [MainThread]: 
[0m20:50:50.631105 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:50:50.644105 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m20:50:50.657100 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m20:50:50.658101 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m20:50:50.658101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:52.670291 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m20:50:52.672291 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m20:50:53.171939 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m20:50:53.178938 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m20:50:53.179937 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m20:50:53.180939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:54.880144 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m20:50:54.880144 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m20:50:55.423194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19518439-fa71-402b-943c-c17188758b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001714E03D710>]}
[0m20:50:55.423194 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:50:55.423194 [info ] [MainThread]: 
[0m20:50:55.449144 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:50:55.450144 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:50:55.453141 [debug] [Thread-3 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:50:55.460141 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:50:55.459141 [info ] [Thread-1 (]: 1 of 6 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m20:50:55.461141 [info ] [Thread-2 (]: 2 of 6 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m20:50:55.462141 [info ] [Thread-3 (]: 3 of 6 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m20:50:55.463142 [info ] [Thread-4 (]: 4 of 6 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m20:50:55.464141 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m20:50:55.465146 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m20:50:55.466141 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m20:50:55.467142 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT'
[0m20:50:55.468141 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:50:55.468141 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:50:55.469141 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:50:55.470143 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:50:55.474140 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:50:55.487143 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:50:55.489140 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:50:55.492140 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:50:55.493142 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 20:50:55.470143 => 20:50:55.493142
[0m20:50:55.494142 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:50:55.475140 => 20:50:55.494142
[0m20:50:55.495144 [debug] [Thread-3 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 20:50:55.487143 => 20:50:55.495144
[0m20:50:55.496144 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:50:55.497143 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:50:55.490139 => 20:50:55.497143
[0m20:50:55.533142 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:50:55.498145 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:50:55.498145 [debug] [Thread-3 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:50:55.576141 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:50:55.591140 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:50:55.594143 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:50:55.599140 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:50:55.600139 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:50:55.601143 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:50:55.602142 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:50:55.603143 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:50:55.605142 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:50:55.605142 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:50:55.606144 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with source_data as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
  );
[0m20:50:55.608144 [debug] [Thread-3 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with source_data as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
  );
[0m20:50:55.612144 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:50:55.613142 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:50:57.788301 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:50:57.803928 [debug] [Thread-3 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 20:50:55.595140 => 20:50:57.803928
[0m20:50:57.803928 [debug] [Thread-3 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m20:50:57.866428 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:50:57.882053 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:50:57.882053 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:50:57.882053 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:50:57.882053 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:50:57.882053 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with source_data as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
        );
[0m20:50:57.882053 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:50:57.882053 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with source_data as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
        );
[0m20:50:58.021079 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:50:58.021079 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:50:55.534143 => 20:50:58.021079
[0m20:50:58.021079 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:50:58.317953 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19518439-fa71-402b-943c-c17188758b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001714DB3E550>]}
[0m20:50:58.317953 [info ] [Thread-3 (]: 3 of 6 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 2.85s]
[0m20:50:58.333578 [debug] [Thread-3 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:50:58.334792 [debug] [Thread-3 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m20:50:58.336793 [info ] [Thread-3 (]: 5 of 6 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m20:50:58.337792 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.my_first_dbt_model)
[0m20:50:58.338791 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m20:50:58.344793 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m20:50:58.345792 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 20:50:58.339790 => 20:50:58.345792
[0m20:50:58.346792 [debug] [Thread-3 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m20:50:58.350790 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m20:50:58.353792 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m20:50:58.353792 [debug] [Thread-3 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:50:58.354792 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:50:58.630184 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19518439-fa71-402b-943c-c17188758b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001714ED5CE50>]}
[0m20:50:58.645823 [info ] [Thread-4 (]: 4 of 6 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 3.16s]
[0m20:50:58.645823 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:50:58.999842 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:50:59.003842 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:50:55.591140 => 20:50:59.003842
[0m20:50:59.004840 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:50:59.404330 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:50:59.419956 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 20:50:55.499146 => 20:50:59.419956
[0m20:50:59.419956 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m20:50:59.488729 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19518439-fa71-402b-943c-c17188758b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001714F70D4D0>]}
[0m20:50:59.489731 [info ] [Thread-2 (]: 2 of 6 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 4.02s]
[0m20:50:59.491732 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:50:59.907511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19518439-fa71-402b-943c-c17188758b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001714F3CC410>]}
[0m20:50:59.907511 [info ] [Thread-1 (]: 1 of 6 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.44s]
[0m20:50:59.907511 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:51:00.866330 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:51:00.870366 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 20:50:58.347793 => 20:51:00.870366
[0m20:51:00.871364 [debug] [Thread-3 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m20:51:01.361758 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19518439-fa71-402b-943c-c17188758b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001714EE0F290>]}
[0m20:51:01.361758 [info ] [Thread-3 (]: 5 of 6 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 3.02s]
[0m20:51:01.361758 [debug] [Thread-3 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m20:51:01.374349 [debug] [Thread-4 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m20:51:01.375352 [info ] [Thread-4 (]: 6 of 6 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m20:51:01.378347 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_second_dbt_model)
[0m20:51:01.383347 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m20:51:01.395350 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m20:51:01.401347 [debug] [Thread-4 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 20:51:01.391347 => 20:51:01.396350
[0m20:51:01.410348 [debug] [Thread-4 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m20:51:01.429347 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m20:51:01.431349 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m20:51:01.432350 [debug] [Thread-4 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m20:51:01.433349 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:51:03.501228 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:51:03.501228 [debug] [Thread-4 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 20:51:01.411348 => 20:51:03.501228
[0m20:51:03.501228 [debug] [Thread-4 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m20:51:04.000873 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19518439-fa71-402b-943c-c17188758b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001714ED5CF90>]}
[0m20:51:04.000873 [info ] [Thread-4 (]: 6 of 6 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.62s]
[0m20:51:04.000873 [debug] [Thread-4 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m20:51:04.011992 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:04.015991 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m20:51:04.021992 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m20:51:04.026991 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM' was properly closed.
[0m20:51:04.027992 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m20:51:04.028994 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m20:51:04.028994 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m20:51:04.029995 [info ] [MainThread]: 
[0m20:51:04.030993 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 13.40 seconds (13.40s).
[0m20:51:04.033515 [debug] [MainThread]: Command end result
[0m20:51:04.060519 [info ] [MainThread]: 
[0m20:51:04.061519 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:51:04.062519 [info ] [MainThread]: 
[0m20:51:04.063517 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:51:04.067518 [debug] [MainThread]: Command `dbt run` succeeded at 20:51:04.067518 after 14.27 seconds
[0m20:51:04.068519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001714C006850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001714E03D550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001714873F150>]}
[0m20:51:04.069516 [debug] [MainThread]: Flushing usage events
[0m20:51:04.876313 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:56:39.752779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370A529290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370A03F310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370A5787D0>]}


============================== 20:56:39.768407 | 1a124389-0bde-4549-bdda-f88902b87725 ==============================
[0m20:56:39.768407 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:56:39.768407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:56:41.473931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a124389-0bde-4549-bdda-f88902b87725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370ABA9F50>]}
[0m20:56:41.489568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a124389-0bde-4549-bdda-f88902b87725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370B6532D0>]}
[0m20:56:41.505587 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:56:41.547343 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:56:42.114432 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m20:56:42.114432 [debug] [MainThread]: Partial parsing: added file: dbt_poc://models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:56:42.114432 [debug] [MainThread]: Partial parsing: deleted file: dbt_poc://models\RAW\TBL_.sql
[0m20:56:42.130058 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:56:42.145685 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:56:42.145685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a124389-0bde-4549-bdda-f88902b87725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370ABB92D0>]}
[0m20:56:42.161308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a124389-0bde-4549-bdda-f88902b87725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370B728ED0>]}
[0m20:56:42.161308 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m20:56:42.169901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a124389-0bde-4549-bdda-f88902b87725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370620AC50>]}
[0m20:56:42.171902 [info ] [MainThread]: 
[0m20:56:42.173900 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:56:42.189899 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m20:56:42.217898 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m20:56:42.217898 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m20:56:42.218899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:44.690452 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m20:56:44.690452 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m20:56:45.173765 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m20:56:45.189372 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m20:56:45.189372 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m20:56:45.189372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:46.959425 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m20:56:46.959425 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m20:56:47.472119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a124389-0bde-4549-bdda-f88902b87725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370B703910>]}
[0m20:56:47.487757 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:56:47.487757 [info ] [MainThread]: 
[0m20:56:47.504302 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:56:47.505306 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:56:47.506304 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:56:47.506304 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:56:47.507307 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m20:56:47.515305 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m20:56:47.516302 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m20:56:47.517306 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m20:56:47.519304 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m20:56:47.520305 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m20:56:47.521303 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m20:56:47.522307 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m20:56:47.523303 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:56:47.523303 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:56:47.524306 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:56:47.524306 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:56:47.527302 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:56:47.530309 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:56:47.532307 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:56:47.535308 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:56:47.536305 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 20:56:47.525304 => 20:56:47.536305
[0m20:56:47.538305 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 20:56:47.533302 => 20:56:47.538305
[0m20:56:47.552307 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:56:47.551306 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:56:47.528305 => 20:56:47.550306
[0m20:56:47.566306 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:56:47.551306 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:56:47.550306 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 20:56:47.530309 => 20:56:47.549302
[0m20:56:47.621302 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:56:47.622304 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:56:47.625302 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:56:47.625302 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:56:47.627305 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:56:47.628303 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:56:47.642305 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:56:47.642305 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:56:47.643304 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:56:47.643304 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:56:47.644306 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with source_data as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
  );
[0m20:56:47.645305 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:56:47.649305 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:56:47.650306 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:56:49.777354 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ad729e-0b04-b614-0002-a65600ef56ce
[0m20:56:49.778354 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Table 'COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN' does not exist or not authorized.
[0m20:56:49.779353 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 20:56:47.629305 => 20:56:49.779353
[0m20:56:49.780355 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m20:56:49.861275 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:56:49.876897 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:56:49.876897 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:56:49.892520 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 20:56:47.553305 => 20:56:49.892520
[0m20:56:49.892520 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m20:56:49.892520 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:56:49.908146 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with source_data as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
        );
[0m20:56:50.017520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:56:50.017520 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:56:50.017520 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:56:50.017520 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with source_data as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
        );
[0m20:56:50.296664 [debug] [Thread-3 (]: Database Error in model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql)
  002003 (42S02): SQL compilation error:
  Table 'COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN' does not exist or not authorized.
[0m20:56:50.297665 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a124389-0bde-4549-bdda-f88902b87725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370C138B10>]}
[0m20:56:50.298661 [error] [Thread-3 (]: 3 of 7 ERROR creating sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[31mERROR[0m in 2.78s]
[0m20:56:50.299660 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:56:50.300660 [debug] [Thread-3 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:56:50.301662 [info ] [Thread-3 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m20:56:50.304657 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m20:56:50.305661 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:56:50.309661 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:56:50.311660 [debug] [Thread-3 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:56:50.306661 => 20:56:50.310661
[0m20:56:50.312661 [debug] [Thread-3 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:56:50.317660 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:56:50.319659 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:56:50.320662 [debug] [Thread-3 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with source_data as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
  );
[0m20:56:50.320662 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:56:50.477661 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a124389-0bde-4549-bdda-f88902b87725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370B81E690>]}
[0m20:56:50.478662 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 2.95s]
[0m20:56:50.480663 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:56:50.480663 [debug] [Thread-4 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m20:56:50.481662 [info ] [Thread-4 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m20:56:50.484659 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.my_first_dbt_model)
[0m20:56:50.485660 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m20:56:50.490661 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m20:56:50.491662 [debug] [Thread-4 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 20:56:50.486661 => 20:56:50.491662
[0m20:56:50.492661 [debug] [Thread-4 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m20:56:50.496661 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m20:56:50.498660 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m20:56:50.499661 [debug] [Thread-4 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:56:50.500662 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:56:51.533801 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:56:51.533801 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:56:47.610305 => 20:56:51.533801
[0m20:56:51.533801 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:56:51.533801 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:56:51.549423 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 20:56:47.623305 => 20:56:51.549423
[0m20:56:51.549423 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m20:56:52.128933 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a124389-0bde-4549-bdda-f88902b87725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370BCED7D0>]}
[0m20:56:52.128933 [info ] [Thread-2 (]: 2 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 4.61s]
[0m20:56:52.133448 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:56:52.183871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a124389-0bde-4549-bdda-f88902b87725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370B6C1FD0>]}
[0m20:56:52.184874 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.66s]
[0m20:56:52.185873 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:56:52.361866 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:56:52.377894 [debug] [Thread-3 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:56:50.312661 => 20:56:52.376879
[0m20:56:52.378160 [debug] [Thread-3 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:56:52.708555 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:56:52.708555 [debug] [Thread-4 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 20:56:50.493661 => 20:56:52.708555
[0m20:56:52.708555 [debug] [Thread-4 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m20:56:52.910039 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a124389-0bde-4549-bdda-f88902b87725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370C023090>]}
[0m20:56:52.911039 [info ] [Thread-3 (]: 5 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.61s]
[0m20:56:52.912040 [debug] [Thread-3 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:56:53.228709 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a124389-0bde-4549-bdda-f88902b87725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370A564FD0>]}
[0m20:56:53.228709 [info ] [Thread-4 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 2.74s]
[0m20:56:53.228709 [debug] [Thread-4 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m20:56:53.234724 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m20:56:53.234724 [info ] [Thread-2 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m20:56:53.236724 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_second_dbt_model)
[0m20:56:53.236724 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m20:56:53.255723 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m20:56:53.273721 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 20:56:53.237725 => 20:56:53.272720
[0m20:56:53.274724 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m20:56:53.279723 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m20:56:53.281724 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m20:56:53.281724 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m20:56:53.282725 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:56:55.111695 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:56:55.111695 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 20:56:53.274724 => 20:56:55.111695
[0m20:56:55.111695 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m20:56:55.616202 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a124389-0bde-4549-bdda-f88902b87725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370C683F50>]}
[0m20:56:55.617205 [info ] [Thread-2 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.38s]
[0m20:56:55.619202 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m20:56:55.621203 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:55.622204 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m20:56:55.622204 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m20:56:55.623202 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM' was properly closed.
[0m20:56:55.623202 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m20:56:55.624205 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m20:56:55.624205 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m20:56:55.625205 [info ] [MainThread]: 
[0m20:56:55.626202 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 13.45 seconds (13.45s).
[0m20:56:55.629204 [debug] [MainThread]: Command end result
[0m20:56:55.781205 [info ] [MainThread]: 
[0m20:56:55.785204 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:56:55.786205 [info ] [MainThread]: 
[0m20:56:55.787204 [error] [MainThread]: [33mDatabase Error in model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql)[0m
[0m20:56:55.788213 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m20:56:55.789206 [error] [MainThread]:   Table 'COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN' does not exist or not authorized.
[0m20:56:55.791206 [info ] [MainThread]: 
[0m20:56:55.792203 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m20:56:55.793203 [debug] [MainThread]: Command `dbt run` failed at 20:56:55.793203 after 16.38 seconds
[0m20:56:55.794204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370513F190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370B69B490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370B69B3D0>]}
[0m20:56:55.795203 [debug] [MainThread]: Flushing usage events
[0m20:56:56.644830 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:57:45.393260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E95EB296D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E95EC2E310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E95EC2E710>]}


============================== 20:57:45.393260 | ee6f19d9-0bfc-4eab-9a2e-8fbdfcce20c2 ==============================
[0m20:57:45.393260 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:57:45.393260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:57:45.731150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee6f19d9-0bfc-4eab-9a2e-8fbdfcce20c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E95EB64350>]}
[0m20:57:45.743154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee6f19d9-0bfc-4eab-9a2e-8fbdfcce20c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E95FD45A10>]}
[0m20:57:45.744152 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:57:45.758154 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:57:45.868153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:57:45.869152 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:57:45.888155 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:57:45.898151 [error] [MainThread]: Encountered an error:
Compilation Error in model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql)
  invalid syntax for function call expression
    line 1
      {{ config(materialized='table',
[0m20:57:45.900154 [debug] [MainThread]: Command `dbt run` failed at 20:57:45.900154 after 0.79 seconds
[0m20:57:45.901152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E95EB28A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E95F199C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E95E4E6210>]}
[0m20:57:45.901152 [debug] [MainThread]: Flushing usage events
[0m20:57:46.629865 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:58:11.236381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE494D16D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE48F61C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE48F3FBD0>]}


============================== 20:58:11.236381 | 3b9031af-7191-4c25-8722-31fe89054986 ==============================
[0m20:58:11.236381 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:58:11.236381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:58:11.548515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b9031af-7191-4c25-8722-31fe89054986', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE49B78DD0>]}
[0m20:58:11.564138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b9031af-7191-4c25-8722-31fe89054986', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE4A652710>]}
[0m20:58:11.564138 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:58:11.606617 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:58:11.699614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:58:11.700614 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:58:11.719614 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:58:11.721619 [error] [MainThread]: Encountered an error:
Compilation Error in model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql)
  expected token ',', got '='
    line 2
      --pre_hook='TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m20:58:11.726407 [debug] [MainThread]: Command `dbt run` failed at 20:58:11.726407 after 0.76 seconds
[0m20:58:11.726407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE49B79C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE49B9BC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE4A71C210>]}
[0m20:58:11.730401 [debug] [MainThread]: Flushing usage events
[0m20:58:11.973352 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:59:29.347429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E709742D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E70479F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E70A2F1D0>]}


============================== 20:59:29.352426 | 1307c463-c3e5-4f9d-982c-0fd225f7b220 ==============================
[0m20:59:29.352426 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:59:29.353430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:59:29.692778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1307c463-c3e5-4f9d-982c-0fd225f7b220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E7043E110>]}
[0m20:59:29.692778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1307c463-c3e5-4f9d-982c-0fd225f7b220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E71A1A410>]}
[0m20:59:29.708419 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:59:29.740481 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:59:29.824485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:59:29.825485 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:59:29.844479 [debug] [MainThread]: 1699: static parser successfully parsed RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:59:29.868481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1307c463-c3e5-4f9d-982c-0fd225f7b220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E71BD6A90>]}
[0m20:59:29.878485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1307c463-c3e5-4f9d-982c-0fd225f7b220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E71B39410>]}
[0m20:59:29.879484 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m20:59:29.880482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1307c463-c3e5-4f9d-982c-0fd225f7b220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E6C62AE90>]}
[0m20:59:29.883483 [info ] [MainThread]: 
[0m20:59:29.884482 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:59:29.887485 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m20:59:29.902485 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m20:59:29.903487 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m20:59:29.903487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:32.377937 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m20:59:32.377937 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m20:59:32.975563 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m20:59:32.975563 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m20:59:32.975563 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m20:59:32.975563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:34.660209 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m20:59:34.662212 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m20:59:35.187036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1307c463-c3e5-4f9d-982c-0fd225f7b220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E71AB3C90>]}
[0m20:59:35.188036 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:59:35.189035 [info ] [MainThread]: 
[0m20:59:35.204035 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:59:35.205034 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:59:35.205034 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:59:35.206035 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:59:35.214034 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m20:59:35.215035 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m20:59:35.217037 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m20:59:35.219035 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m20:59:35.218035 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m20:59:35.220035 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m20:59:35.221036 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m20:59:35.222036 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:59:35.223037 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m20:59:35.224036 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:59:35.225036 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:59:35.238038 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:59:35.239034 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:59:35.241036 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:59:35.244033 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:59:35.247033 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:59:35.248035 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 20:59:35.225036 => 20:59:35.247033
[0m20:59:35.249036 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:59:35.239034 => 20:59:35.248035
[0m20:59:35.250037 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:59:35.251034 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 20:59:35.242035 => 20:59:35.250037
[0m20:59:35.271035 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:59:35.252036 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 20:59:35.244033 => 20:59:35.252036
[0m20:59:35.251034 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:59:35.308038 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:59:35.340034 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:59:35.341033 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:59:35.343036 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:59:35.344033 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:59:35.372038 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:59:35.373034 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:59:35.377037 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:59:35.378036 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:59:35.379036 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:59:35.380036 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:59:35.381037 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--pre_hook='TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND ,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,

--CAMPAIGN dimension columns

dim.PROFILE_ID,

dim.YR,
dim.KEYWORD_CATEGORY,

--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from "DEV_COMX_GLOBAL"."RETMEDIA_INTEGRATION"."KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN" camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_CAMPAIGN a
left join DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG b
on a.tag_id = b.id
left join DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID;
[0m20:59:35.386036 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with source_data as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
  );
[0m20:59:35.387036 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:59:35.388035 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:59:37.534868 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ad72a1-0b04-b614-0002-a65600ef570e
[0m20:59:37.534868 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 84 at position 37 unexpected ';'.
[0m20:59:37.534868 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 20:59:35.272035 => 20:59:37.534868
[0m20:59:37.534868 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m20:59:37.721935 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:59:37.769270 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 20:59:35.345037 => 20:59:37.753626
[0m20:59:37.769270 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m20:59:37.823565 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:59:37.825566 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:59:37.826564 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:59:37.828568 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:59:37.829567 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:59:37.830569 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with source_data as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
        );
[0m20:59:37.833568 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:59:37.834565 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with source_data as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
        );
[0m20:59:38.161710 [debug] [Thread-3 (]: Database Error in model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql)
  001003 (42000): SQL compilation error:
  syntax error line 84 at position 37 unexpected ';'.
  compiled Code at target\run\dbt_poc\models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:59:38.161710 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1307c463-c3e5-4f9d-982c-0fd225f7b220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E71B9A410>]}
[0m20:59:38.161710 [error] [Thread-3 (]: 3 of 7 ERROR creating sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[31mERROR[0m in 2.94s]
[0m20:59:38.161710 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:59:38.172906 [debug] [Thread-3 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:59:38.173907 [info ] [Thread-3 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m20:59:38.174905 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m20:59:38.175915 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:59:38.180904 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:59:38.182904 [debug] [Thread-3 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:59:38.175915 => 20:59:38.182904
[0m20:59:38.183904 [debug] [Thread-3 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:59:38.188904 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:59:38.190904 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:59:38.191903 [debug] [Thread-3 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with source_data as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
  );
[0m20:59:38.191903 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:59:38.307906 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1307c463-c3e5-4f9d-982c-0fd225f7b220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E71AB3BD0>]}
[0m20:59:38.308908 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 3.09s]
[0m20:59:38.310906 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:59:38.311909 [debug] [Thread-4 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m20:59:38.312906 [info ] [Thread-4 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m20:59:38.313908 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.my_first_dbt_model)
[0m20:59:38.314907 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m20:59:38.318908 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m20:59:38.322906 [debug] [Thread-4 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 20:59:38.314907 => 20:59:38.321905
[0m20:59:38.323906 [debug] [Thread-4 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m20:59:38.327905 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m20:59:38.329905 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m20:59:38.330904 [debug] [Thread-4 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:59:38.342905 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:59:38.971720 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:59:38.987352 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:59:35.341033 => 20:59:38.971720
[0m20:59:38.987352 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:59:39.471317 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1307c463-c3e5-4f9d-982c-0fd225f7b220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E725376D0>]}
[0m20:59:39.471317 [info ] [Thread-2 (]: 2 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 4.25s]
[0m20:59:39.479891 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:59:39.523891 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:59:39.528893 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 20:59:35.253038 => 20:59:39.527891
[0m20:59:39.528893 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m20:59:40.080131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1307c463-c3e5-4f9d-982c-0fd225f7b220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E71AC8990>]}
[0m20:59:40.080131 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.86s]
[0m20:59:40.080131 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:59:40.247031 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:59:40.250030 [debug] [Thread-3 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:59:38.183904 => 20:59:40.250030
[0m20:59:40.250030 [debug] [Thread-3 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:59:40.642593 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:59:40.642593 [debug] [Thread-4 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 20:59:38.323906 => 20:59:40.642593
[0m20:59:40.642593 [debug] [Thread-4 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m20:59:40.768092 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1307c463-c3e5-4f9d-982c-0fd225f7b220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E72537050>]}
[0m20:59:40.768092 [info ] [Thread-3 (]: 5 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.59s]
[0m20:59:40.768092 [debug] [Thread-3 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:59:41.127108 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1307c463-c3e5-4f9d-982c-0fd225f7b220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E709D1F10>]}
[0m20:59:41.127108 [info ] [Thread-4 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 2.81s]
[0m20:59:41.127108 [debug] [Thread-4 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m20:59:41.138862 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m20:59:41.138862 [info ] [Thread-2 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m20:59:41.155861 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_second_dbt_model)
[0m20:59:41.155861 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m20:59:41.160866 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m20:59:41.161863 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 20:59:41.156865 => 20:59:41.161863
[0m20:59:41.164859 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m20:59:41.182862 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m20:59:41.184861 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m20:59:41.184861 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m20:59:41.185863 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:59:43.090130 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:59:43.094129 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 20:59:41.171860 => 20:59:43.093129
[0m20:59:43.094129 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m20:59:43.564502 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1307c463-c3e5-4f9d-982c-0fd225f7b220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E71B6AB90>]}
[0m20:59:43.564502 [info ] [Thread-2 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.41s]
[0m20:59:43.564502 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m20:59:43.573690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:59:43.573690 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m20:59:43.574692 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m20:59:43.575691 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM' was properly closed.
[0m20:59:43.575691 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m20:59:43.581688 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m20:59:43.591688 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m20:59:43.593691 [info ] [MainThread]: 
[0m20:59:43.594693 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 13.71 seconds (13.71s).
[0m20:59:43.615689 [debug] [MainThread]: Command end result
[0m20:59:43.625691 [info ] [MainThread]: 
[0m20:59:43.626689 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:59:43.628692 [info ] [MainThread]: 
[0m20:59:43.629692 [error] [MainThread]: [33mDatabase Error in model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql)[0m
[0m20:59:43.631692 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m20:59:43.652690 [error] [MainThread]:   syntax error line 84 at position 37 unexpected ';'.
[0m20:59:43.653690 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:59:43.654692 [info ] [MainThread]: 
[0m20:59:43.656690 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m20:59:43.657692 [debug] [MainThread]: Command `dbt run` failed at 20:59:43.657692 after 14.57 seconds
[0m20:59:43.658691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E70F79FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E7046A890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E704D9C10>]}
[0m20:59:43.659693 [debug] [MainThread]: Flushing usage events
[0m20:59:44.488115 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m21:04:50.913356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC73A196D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC737286D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC73256D10>]}


============================== 21:04:50.928982 | e0093aa8-4eb7-4d28-a6d0-e8f9c37d5808 ==============================
[0m21:04:50.928982 [info ] [MainThread]: Running with dbt=1.5.2
[0m21:04:50.928982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:04:51.252492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0093aa8-4eb7-4d28-a6d0-e8f9c37d5808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC73D78290>]}
[0m21:04:51.263501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0093aa8-4eb7-4d28-a6d0-e8f9c37d5808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC7485B810>]}
[0m21:04:51.263501 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m21:04:51.295801 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m21:04:51.387800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:04:51.388800 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m21:04:51.408801 [debug] [MainThread]: 1699: static parser successfully parsed RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m21:04:51.425478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0093aa8-4eb7-4d28-a6d0-e8f9c37d5808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC73C3D410>]}
[0m21:04:51.441500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0093aa8-4eb7-4d28-a6d0-e8f9c37d5808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC74929290>]}
[0m21:04:51.441500 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m21:04:51.470453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0093aa8-4eb7-4d28-a6d0-e8f9c37d5808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC74868450>]}
[0m21:04:51.473453 [info ] [MainThread]: 
[0m21:04:51.476453 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:04:51.532450 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m21:04:51.582451 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m21:04:51.583452 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m21:04:51.584453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:53.645185 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m21:04:53.645185 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m21:04:54.143852 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m21:04:54.159462 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m21:04:54.159462 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m21:04:54.159462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:55.956031 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m21:04:55.956031 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m21:04:56.472615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0093aa8-4eb7-4d28-a6d0-e8f9c37d5808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC74BEB5D0>]}
[0m21:04:56.472615 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:04:56.488222 [info ] [MainThread]: 
[0m21:04:56.505296 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m21:04:56.505296 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m21:04:56.506303 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m21:04:56.514295 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m21:04:56.512294 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m21:04:56.515296 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m21:04:56.516298 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m21:04:56.519296 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m21:04:56.517297 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m21:04:56.520295 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m21:04:56.521297 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m21:04:56.522294 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m21:04:56.523297 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m21:04:56.524295 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m21:04:56.525296 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m21:04:56.529293 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m21:04:56.529293 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m21:04:56.532294 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m21:04:56.535297 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m21:04:56.539296 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m21:04:56.540298 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 21:04:56.525296 => 21:04:56.540298
[0m21:04:56.541297 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 21:04:56.530297 => 21:04:56.541297
[0m21:04:56.543295 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m21:04:56.543295 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 21:04:56.532294 => 21:04:56.543295
[0m21:04:56.544297 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m21:04:56.545297 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 21:04:56.536298 => 21:04:56.544297
[0m21:04:56.591298 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m21:04:56.591298 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m21:04:56.596296 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m21:04:56.597296 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m21:04:56.597296 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m21:04:56.628296 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m21:04:56.642298 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m21:04:56.669297 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m21:04:56.670298 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:04:56.671295 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:04:56.674295 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m21:04:56.677295 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m21:04:56.680298 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 

select
camp.DATE,
'US' as COUNTRY,
dim.BRAND ,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from "DEV_COMX_GLOBAL"."RETMEDIA_INTEGRATION"."KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN" camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_CAMPAIGN a
left join DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG b
on a.tag_id = b.id
left join DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m21:04:56.681300 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with source_data as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
  );
[0m21:04:56.684298 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:04:56.682295 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:04:58.944484 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:04:58.944484 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m21:04:58.944484 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m21:04:58.944484 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with source_data as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
        );
[0m21:04:59.039598 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:04:59.042601 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m21:04:59.044599 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m21:04:59.045597 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with source_data as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
        );
[0m21:04:59.144777 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:04:59.176025 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 21:04:56.642298 => 21:04:59.176025
[0m21:04:59.176025 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m21:04:59.715943 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0093aa8-4eb7-4d28-a6d0-e8f9c37d5808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC74963890>]}
[0m21:04:59.716943 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 3.19s]
[0m21:04:59.718945 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m21:04:59.719944 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m21:04:59.720944 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m21:04:59.722943 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m21:04:59.723944 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m21:04:59.727945 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m21:04:59.730944 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 21:04:59.723944 => 21:04:59.730944
[0m21:04:59.731944 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m21:04:59.736943 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m21:04:59.747943 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m21:04:59.748943 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with source_data as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
  );
[0m21:04:59.749945 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:05:00.433948 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:05:00.437949 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 21:04:56.592297 => 21:05:00.436947
[0m21:05:00.437949 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m21:05:00.503949 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:05:00.506948 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 21:04:56.545297 => 21:05:00.506948
[0m21:05:00.507947 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m21:05:00.966591 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0093aa8-4eb7-4d28-a6d0-e8f9c37d5808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC74A06B10>]}
[0m21:05:00.967591 [info ] [Thread-2 (]: 2 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 4.45s]
[0m21:05:00.969594 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m21:05:00.970594 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m21:05:00.971595 [info ] [Thread-2 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m21:05:00.973595 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_first_dbt_model)
[0m21:05:00.973595 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m21:05:00.979591 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m21:05:00.981591 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 21:05:00.974595 => 21:05:00.980592
[0m21:05:00.981591 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m21:05:00.986590 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m21:05:00.988591 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m21:05:00.988591 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m21:05:00.989592 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:05:00.996595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0093aa8-4eb7-4d28-a6d0-e8f9c37d5808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC750A9650>]}
[0m21:05:00.997593 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.48s]
[0m21:05:01.000593 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m21:05:01.364594 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 5.0 seconds
[0m21:05:01.367591 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 21:04:56.598295 => 21:05:01.367591
[0m21:05:01.368591 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m21:05:01.853957 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:05:01.856956 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 21:04:59.731944 => 21:05:01.856956
[0m21:05:01.857956 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m21:05:01.879037 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0093aa8-4eb7-4d28-a6d0-e8f9c37d5808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC74954190>]}
[0m21:05:01.879037 [info ] [Thread-3 (]: 3 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[32mSUCCESS 1[0m in 5.36s]
[0m21:05:01.879037 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m21:05:02.377768 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0093aa8-4eb7-4d28-a6d0-e8f9c37d5808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC75274650>]}
[0m21:05:02.377768 [info ] [Thread-4 (]: 5 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.66s]
[0m21:05:02.377768 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m21:05:03.589859 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m21:05:03.593858 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 21:05:00.982593 => 21:05:03.593858
[0m21:05:03.593858 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m21:05:04.104576 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0093aa8-4eb7-4d28-a6d0-e8f9c37d5808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC750D3890>]}
[0m21:05:04.105578 [info ] [Thread-2 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 3.13s]
[0m21:05:04.107578 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m21:05:04.108578 [debug] [Thread-1 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m21:05:04.109578 [info ] [Thread-1 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m21:05:04.110577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM, now model.dbt_poc.my_second_dbt_model)
[0m21:05:04.111582 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m21:05:04.114582 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m21:05:04.115581 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 21:05:04.111582 => 21:05:04.115581
[0m21:05:04.116579 [debug] [Thread-1 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m21:05:04.122575 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m21:05:04.124579 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m21:05:04.124579 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m21:05:04.125578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:06.022976 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:05:06.022976 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 21:05:04.117577 => 21:05:06.022976
[0m21:05:06.022976 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m21:05:06.522978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0093aa8-4eb7-4d28-a6d0-e8f9c37d5808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC748F3F90>]}
[0m21:05:06.522978 [info ] [Thread-1 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.41s]
[0m21:05:06.538240 [debug] [Thread-1 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m21:05:06.544238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:05:06.548238 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m21:05:06.553239 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m21:05:06.557237 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m21:05:06.558240 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m21:05:06.558240 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN' was properly closed.
[0m21:05:06.559244 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m21:05:06.560241 [info ] [MainThread]: 
[0m21:05:06.561240 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 15.08 seconds (15.08s).
[0m21:05:06.563242 [debug] [MainThread]: Command end result
[0m21:05:06.686242 [info ] [MainThread]: 
[0m21:05:06.688242 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:05:06.689239 [info ] [MainThread]: 
[0m21:05:06.690239 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m21:05:06.692239 [debug] [MainThread]: Command `dbt run` succeeded at 21:05:06.692239 after 16.02 seconds
[0m21:05:06.693242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC72DC6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC6E33F190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC6E33F150>]}
[0m21:05:06.693242 [debug] [MainThread]: Flushing usage events
[0m21:05:07.539119 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m21:06:04.003426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C301C74C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C301C55210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C301C29DD0>]}


============================== 21:06:04.019052 | 75f5a8fe-a41a-4828-bd71-3e5e92fdd5c1 ==============================
[0m21:06:04.019052 [info ] [MainThread]: Running with dbt=1.5.2
[0m21:06:04.019052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:06:04.333764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75f5a8fe-a41a-4828-bd71-3e5e92fdd5c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C30279AC50>]}
[0m21:06:04.349794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75f5a8fe-a41a-4828-bd71-3e5e92fdd5c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C303252F10>]}
[0m21:06:04.349794 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m21:06:04.379062 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m21:06:04.494061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:06:04.495061 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m21:06:04.514061 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m21:06:04.529061 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m21:06:04.537119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75f5a8fe-a41a-4828-bd71-3e5e92fdd5c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3032C8D90>]}
[0m21:06:04.537119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75f5a8fe-a41a-4828-bd71-3e5e92fdd5c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3033293D0>]}
[0m21:06:04.553371 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m21:06:04.557372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75f5a8fe-a41a-4828-bd71-3e5e92fdd5c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3032010D0>]}
[0m21:06:04.559373 [info ] [MainThread]: 
[0m21:06:04.561372 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:06:04.563370 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m21:06:04.594373 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m21:06:04.595373 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m21:06:04.596374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:06.736340 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m21:06:06.737341 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m21:06:07.270234 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m21:06:07.276232 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m21:06:07.277232 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m21:06:07.277232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:09.096364 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m21:06:09.096364 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m21:06:09.657622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75f5a8fe-a41a-4828-bd71-3e5e92fdd5c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C30343C090>]}
[0m21:06:09.658622 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:06:09.659617 [info ] [MainThread]: 
[0m21:06:09.675621 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m21:06:09.676616 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m21:06:09.676616 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m21:06:09.677620 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m21:06:09.677620 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m21:06:09.678618 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m21:06:09.679617 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m21:06:09.680617 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m21:06:09.681618 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m21:06:09.682617 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m21:06:09.683617 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m21:06:09.684619 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m21:06:09.684619 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m21:06:09.685619 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m21:06:09.685619 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m21:06:09.686617 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m21:06:09.689618 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m21:06:09.692617 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m21:06:09.694618 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m21:06:09.707618 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m21:06:09.708617 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 21:06:09.686617 => 21:06:09.708617
[0m21:06:09.710619 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 21:06:09.689618 => 21:06:09.709620
[0m21:06:09.711620 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 21:06:09.692617 => 21:06:09.710619
[0m21:06:09.711620 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m21:06:09.712620 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 21:06:09.700615 => 21:06:09.712620
[0m21:06:09.713620 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m21:06:09.713620 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m21:06:09.744615 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m21:06:09.745616 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m21:06:09.747617 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m21:06:09.750615 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m21:06:09.752618 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m21:06:09.783618 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m21:06:09.784618 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m21:06:09.785617 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m21:06:09.786617 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:06:09.787617 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:06:09.788617 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:06:09.789620 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m21:06:09.796616 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with source_data as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
  );
[0m21:06:09.797618 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:06:12.001534 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:06:12.019538 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m21:06:12.021536 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:06:12.023535 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m21:06:12.024536 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m21:06:12.025539 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with source_data as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
        );
[0m21:06:12.029533 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m21:06:12.031541 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND ,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from "DEV_COMX_GLOBAL"."RETMEDIA_INTEGRATION"."KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN" camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_CAMPAIGN a
left join DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG b
on a.tag_id = b.id
left join DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m21:06:12.095536 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:06:12.120534 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 21:06:09.753617 => 21:06:12.119536
[0m21:06:12.120534 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m21:06:12.334790 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m21:06:12.336788 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m21:06:12.338791 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m21:06:12.339790 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with source_data as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
        );
[0m21:06:12.615750 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75f5a8fe-a41a-4828-bd71-3e5e92fdd5c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C301C56510>]}
[0m21:06:12.616755 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 2.93s]
[0m21:06:12.618749 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m21:06:12.618749 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m21:06:12.619755 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m21:06:12.620750 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m21:06:12.621752 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m21:06:12.624752 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m21:06:12.625753 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 21:06:12.621752 => 21:06:12.625753
[0m21:06:12.626753 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m21:06:12.630753 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m21:06:12.633749 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m21:06:12.634749 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with source_data as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from source_data
  );
[0m21:06:12.635751 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:06:13.121667 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:06:13.121667 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 21:06:09.714619 => 21:06:13.121667
[0m21:06:13.121667 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m21:06:13.638494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75f5a8fe-a41a-4828-bd71-3e5e92fdd5c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3032CB310>]}
[0m21:06:13.638494 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 3.96s]
[0m21:06:13.638494 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m21:06:13.645944 [debug] [Thread-1 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m21:06:13.646946 [info ] [Thread-1 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m21:06:13.647945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM, now model.dbt_poc.my_first_dbt_model)
[0m21:06:13.647945 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m21:06:13.653946 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m21:06:13.655946 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 21:06:13.648948 => 21:06:13.654946
[0m21:06:13.655946 [debug] [Thread-1 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m21:06:13.660944 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m21:06:13.662943 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m21:06:13.662943 [debug] [Thread-1 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m21:06:13.663944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:13.909135 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:06:13.909135 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 21:06:09.745616 => 21:06:13.909135
[0m21:06:13.909135 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m21:06:14.393102 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75f5a8fe-a41a-4828-bd71-3e5e92fdd5c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C303B0C9D0>]}
[0m21:06:14.393102 [info ] [Thread-2 (]: 2 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 4.71s]
[0m21:06:14.405540 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m21:06:14.481537 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:06:14.485538 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 21:06:12.626753 => 21:06:14.485538
[0m21:06:14.487542 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m21:06:14.886599 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m21:06:14.886599 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 21:06:09.748619 => 21:06:14.886599
[0m21:06:14.886599 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m21:06:14.965524 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75f5a8fe-a41a-4828-bd71-3e5e92fdd5c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C303BA4DD0>]}
[0m21:06:14.965524 [info ] [Thread-4 (]: 5 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.34s]
[0m21:06:14.965524 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m21:06:15.381475 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75f5a8fe-a41a-4828-bd71-3e5e92fdd5c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C303361450>]}
[0m21:06:15.381475 [info ] [Thread-3 (]: 3 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[32mSUCCESS 1[0m in 5.70s]
[0m21:06:15.383975 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m21:06:16.086585 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:06:16.086585 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 21:06:13.656946 => 21:06:16.086585
[0m21:06:16.102195 [debug] [Thread-1 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m21:06:16.602197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75f5a8fe-a41a-4828-bd71-3e5e92fdd5c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C30330FED0>]}
[0m21:06:16.602197 [info ] [Thread-1 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 2.95s]
[0m21:06:16.602197 [debug] [Thread-1 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m21:06:16.602197 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m21:06:16.602197 [info ] [Thread-2 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m21:06:16.617819 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_second_dbt_model)
[0m21:06:16.617819 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m21:06:16.617819 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m21:06:16.617819 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 21:06:16.617819 => 21:06:16.617819
[0m21:06:16.617819 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m21:06:16.617819 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m21:06:16.617819 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m21:06:16.617819 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m21:06:16.633406 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:06:18.726376 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:06:18.726376 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 21:06:16.617819 => 21:06:18.726376
[0m21:06:18.726376 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m21:06:19.257241 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75f5a8fe-a41a-4828-bd71-3e5e92fdd5c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C303D54550>]}
[0m21:06:19.257241 [info ] [Thread-2 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.64s]
[0m21:06:19.272878 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m21:06:19.275089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:06:19.276092 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m21:06:19.277091 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m21:06:19.277091 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m21:06:19.278091 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m21:06:19.279090 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN' was properly closed.
[0m21:06:19.301087 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m21:06:19.304089 [info ] [MainThread]: 
[0m21:06:19.305088 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 14.74 seconds (14.74s).
[0m21:06:19.326087 [debug] [MainThread]: Command end result
[0m21:06:19.490092 [info ] [MainThread]: 
[0m21:06:19.493092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:06:19.495091 [info ] [MainThread]: 
[0m21:06:19.496091 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m21:06:19.498091 [debug] [MainThread]: Command `dbt run` succeeded at 21:06:19.498091 after 15.74 seconds
[0m21:06:19.499089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C30210A950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C37CD3F150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C37CD3FFD0>]}
[0m21:06:19.499089 [debug] [MainThread]: Flushing usage events
[0m21:06:20.395358 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:26:45.459267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002106926C2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021069259390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021069883690>]}


============================== 18:26:45.474892 | 91bd9216-0610-4a34-b3a8-4826686a788b ==============================
[0m18:26:45.474892 [info ] [MainThread]: Running with dbt=1.5.2
[0m18:26:45.474892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:26:45.477670 [info ] [MainThread]: dbt version: 1.5.2
[0m18:26:45.478673 [info ] [MainThread]: python version: 3.11.4
[0m18:26:45.479671 [info ] [MainThread]: python path: C:\Users\SNando01\dbt-venv\Scripts\python.exe
[0m18:26:45.482667 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m18:26:45.483668 [info ] [MainThread]: Using profiles.yml file at C:\Users\SNando01\.dbt\profiles.yml
[0m18:26:45.484668 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SNando01\DBT_POC\dbt_project.yml
[0m18:26:45.486668 [info ] [MainThread]: Configuration:
[0m18:26:45.771074 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:26:45.820832 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:26:45.821830 [info ] [MainThread]: Required dependencies:
[0m18:26:45.822829 [debug] [MainThread]: Executing "git --help"
[0m18:26:46.275215 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:26:46.275215 [debug] [MainThread]: STDERR: "b''"
[0m18:26:46.275215 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:26:46.290860 [info ] [MainThread]: Connection:
[0m18:26:46.292204 [info ] [MainThread]:   account: bk40750.east-us-2.azure
[0m18:26:46.293202 [info ] [MainThread]:   user: MHennes3
[0m18:26:46.294203 [info ] [MainThread]:   database: COMMEX_DB
[0m18:26:46.295203 [info ] [MainThread]:   schema: DIGITAL_SHELF_DBT
[0m18:26:46.296205 [info ] [MainThread]:   warehouse: DEV_COMX_GLOBAL_APP1_WH
[0m18:26:46.301201 [info ] [MainThread]:   role: DEV_COMX_GLOBAL_DEVELOPER_FR
[0m18:26:46.307204 [info ] [MainThread]:   client_session_keep_alive: False
[0m18:26:46.308205 [info ] [MainThread]:   query_tag: None
[0m18:26:46.325202 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m18:26:46.326203 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m18:26:46.327203 [debug] [MainThread]: Using snowflake connection "debug"
[0m18:26:46.328202 [debug] [MainThread]: On debug: select 1 as id
[0m18:26:46.328202 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:26:49.427651 [debug] [MainThread]: SQL status: SUCCESS 1 in 3.0 seconds
[0m18:26:49.427651 [debug] [MainThread]: On debug: Close
[0m18:26:49.911700 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:26:49.927307 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:26:49.929396 [debug] [MainThread]: Command `dbt debug` succeeded at 18:26:49.929396 after 4.73 seconds
[0m18:26:49.929396 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:26:49.930399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021068D291D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002106A450A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021063F3FD10>]}
[0m18:26:49.931396 [debug] [MainThread]: Flushing usage events
[0m18:26:49.980395 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:27:00.474885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C271496D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C27217BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2779BCD0>]}


============================== 18:27:00.474885 | 2941973d-0b1e-42ce-96d5-51121c398562 ==============================
[0m18:27:00.474885 [info ] [MainThread]: Running with dbt=1.5.2
[0m18:27:00.474885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:27:00.786394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2941973d-0b1e-42ce-96d5-51121c398562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C27163410>]}
[0m18:27:00.802020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2941973d-0b1e-42ce-96d5-51121c398562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C28268350>]}
[0m18:27:00.802020 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m18:27:00.831360 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m18:27:00.856360 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:27:00.857362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2941973d-0b1e-42ce-96d5-51121c398562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C26C57DD0>]}
[0m18:27:01.969949 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m18:27:01.983951 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m18:27:01.987951 [debug] [MainThread]: 1699: static parser successfully parsed L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m18:27:01.991950 [debug] [MainThread]: 1603: static parser failed on L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m18:27:01.996950 [debug] [MainThread]: 1602: parser fallback to jinja rendering on L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m18:27:01.998949 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m18:27:02.003950 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m18:27:02.005950 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m18:27:02.009949 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m18:27:02.012950 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m18:27:02.016949 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m18:27:02.046949 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "KENVUE_KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("KENVUE", "KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM").
  
  To fix this, change the name of one of these resources:
  - source.dbt_poc.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM (models\example\schema.yml)
  - source.dbt_poc.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM (models\Source.yml)
[0m18:27:02.048952 [debug] [MainThread]: Command `dbt run` failed at 18:27:02.048952 after 1.83 seconds
[0m18:27:02.049955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2777A650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2836D650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2834DF10>]}
[0m18:27:02.050954 [debug] [MainThread]: Flushing usage events
[0m18:27:02.123950 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:05:28.136669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188620896D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001886273CA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188621CEA10>]}


============================== 19:05:28.152311 | 62a7c364-109a-40ca-9dfb-f676e5e13f21 ==============================
[0m19:05:28.152311 [info ] [MainThread]: Running with dbt=1.5.2
[0m19:05:28.152311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:05:28.154797 [info ] [MainThread]: dbt version: 1.5.2
[0m19:05:28.155798 [info ] [MainThread]: python version: 3.11.4
[0m19:05:28.156797 [info ] [MainThread]: python path: C:\Users\SNando01\dbt-venv\Scripts\python.exe
[0m19:05:28.158796 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m19:05:28.159797 [info ] [MainThread]: Using profiles.yml file at C:\Users\SNando01\.dbt\profiles.yml
[0m19:05:28.160796 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SNando01\DBT_POC\dbt_project.yml
[0m19:05:28.161796 [info ] [MainThread]: Configuration:
[0m19:05:29.998356 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:05:30.042413 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:05:30.044415 [info ] [MainThread]: Required dependencies:
[0m19:05:30.057415 [debug] [MainThread]: Executing "git --help"
[0m19:05:30.510135 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:05:30.510135 [debug] [MainThread]: STDERR: "b''"
[0m19:05:30.510135 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:05:30.518401 [info ] [MainThread]: Connection:
[0m19:05:30.519415 [info ] [MainThread]:   account: bk40750.east-us-2.azure
[0m19:05:30.520417 [info ] [MainThread]:   user: MHennes3
[0m19:05:30.529415 [info ] [MainThread]:   database: COMMEX_DB
[0m19:05:30.530414 [info ] [MainThread]:   schema: DIGITAL_SHELF_DBT
[0m19:05:30.531413 [info ] [MainThread]:   warehouse: DEV_COMX_GLOBAL_APP1_WH
[0m19:05:30.532415 [info ] [MainThread]:   role: DEV_COMX_GLOBAL_DEVELOPER_FR
[0m19:05:30.533414 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:05:30.535413 [info ] [MainThread]:   query_tag: None
[0m19:05:30.545414 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m19:05:30.546413 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:05:30.554412 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:05:30.555414 [debug] [MainThread]: On debug: select 1 as id
[0m19:05:30.556415 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:05:33.497302 [debug] [MainThread]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:05:33.497302 [debug] [MainThread]: On debug: Close
[0m19:05:34.009860 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:05:34.009860 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:05:34.013366 [debug] [MainThread]: Command `dbt debug` succeeded at 19:05:34.012352 after 6.23 seconds
[0m19:05:34.013366 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:05:34.014365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018863150D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885CE3F190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885CE3F150>]}
[0m19:05:34.014365 [debug] [MainThread]: Flushing usage events
[0m19:05:34.911405 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:06:30.584110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F2E370C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F2DE295D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F2DE66390>]}


============================== 19:06:30.590106 | 7a81f32a-9ad9-45ad-9115-a0f21c2f4f2f ==============================
[0m19:06:30.590106 [info ] [MainThread]: Running with dbt=1.5.2
[0m19:06:30.591119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:06:30.951206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a81f32a-9ad9-45ad-9115-a0f21c2f4f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F2DE2A450>]}
[0m19:06:30.966849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a81f32a-9ad9-45ad-9115-a0f21c2f4f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F2E9C0790>]}
[0m19:06:30.966849 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m19:06:31.026944 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m19:06:31.067940 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:06:31.069941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7a81f32a-9ad9-45ad-9115-a0f21c2f4f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F2F5B27D0>]}
[0m19:06:32.967219 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m19:06:32.983250 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m19:06:32.998895 [debug] [MainThread]: 1699: static parser successfully parsed L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m19:06:32.998895 [debug] [MainThread]: 1603: static parser failed on L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:06:33.014928 [debug] [MainThread]: 1602: parser fallback to jinja rendering on L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:06:33.014928 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m19:06:33.014928 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m19:06:33.030568 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:06:33.030568 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:06:33.041583 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m19:06:33.046597 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m19:06:33.093911 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "KENVUE_KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("KENVUE", "KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM").
  
  To fix this, change the name of one of these resources:
  - source.dbt_poc.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM (models\example\schema.yml)
  - source.dbt_poc.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM (models\Source.yml)
[0m19:06:33.104883 [debug] [MainThread]: Command `dbt docs generate` failed at 19:06:33.104883 after 2.83 seconds
[0m19:06:33.113879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F2E2FBBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F2E978B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F2E3578D0>]}
[0m19:06:33.114883 [debug] [MainThread]: Flushing usage events
[0m19:06:33.205880 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:10:08.660558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D5365790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D1CEB850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D533E7D0>]}


============================== 19:10:08.671556 | 30a38989-7aca-4e73-8b9d-fea4fb3ffef2 ==============================
[0m19:10:08.671556 [info ] [MainThread]: Running with dbt=1.5.2
[0m19:10:08.673557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:10:10.391395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30a38989-7aca-4e73-8b9d-fea4fb3ffef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D5973190>]}
[0m19:10:10.407035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30a38989-7aca-4e73-8b9d-fea4fb3ffef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D6568350>]}
[0m19:10:10.416546 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m19:10:10.448210 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m19:10:10.476207 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:10:10.478210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '30a38989-7aca-4e73-8b9d-fea4fb3ffef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D533F110>]}
[0m19:10:11.606985 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m19:10:11.622623 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m19:10:11.635134 [debug] [MainThread]: 1699: static parser successfully parsed L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m19:10:11.638648 [debug] [MainThread]: 1603: static parser failed on L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:10:11.638648 [debug] [MainThread]: 1602: parser fallback to jinja rendering on L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:10:11.638648 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m19:10:11.638648 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m19:10:11.654290 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:10:11.654290 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:10:11.654290 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m19:10:11.666302 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m19:10:11.760306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30a38989-7aca-4e73-8b9d-fea4fb3ffef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D5F55450>]}
[0m19:10:11.765325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30a38989-7aca-4e73-8b9d-fea4fb3ffef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D66E8550>]}
[0m19:10:11.765325 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m19:10:11.806895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30a38989-7aca-4e73-8b9d-fea4fb3ffef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D110AC50>]}
[0m19:10:11.810900 [info ] [MainThread]: 
[0m19:10:11.812898 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:10:11.814899 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m19:10:11.841898 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m19:10:11.842898 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m19:10:11.842898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:14.394480 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m19:10:14.394480 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m19:10:14.906050 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m19:10:14.922079 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m19:10:14.922079 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m19:10:14.922079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:16.518763 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m19:10:16.518763 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m19:10:17.031364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30a38989-7aca-4e73-8b9d-fea4fb3ffef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D5315E50>]}
[0m19:10:17.031364 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:10:17.031364 [info ] [MainThread]: 
[0m19:10:17.070515 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:10:17.071514 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:10:17.071514 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:10:17.072515 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:10:17.073517 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m19:10:17.074518 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m19:10:17.075515 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m19:10:17.086515 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m19:10:17.076515 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m19:10:17.087517 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m19:10:17.089517 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m19:10:17.089517 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:10:17.090517 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m19:10:17.091515 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:10:17.091515 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:10:17.096517 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m19:10:17.097519 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:10:17.099516 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:10:17.103520 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m19:10:17.107517 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m19:10:17.108518 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 19:10:17.092520 => 19:10:17.108518
[0m19:10:17.109516 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 19:10:17.097519 => 19:10:17.109516
[0m19:10:17.121518 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 19:10:17.100517 => 19:10:17.120515
[0m19:10:17.122516 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 19:10:17.103520 => 19:10:17.121518
[0m19:10:17.122516 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:10:17.123517 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:10:17.124517 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:10:17.124517 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:10:17.161517 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m19:10:17.164514 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:10:17.167517 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m19:10:17.179516 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:10:17.202518 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m19:10:17.203518 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:10:17.204516 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:10:17.205516 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:10:17.206516 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:10:17.207516 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:10:17.208515 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m19:10:17.215518 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m19:10:17.216517 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:10:19.482266 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:10:19.497909 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m19:10:19.497909 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m19:10:19.497909 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
        );
[0m19:10:19.513935 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:10:19.513935 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m19:10:19.513935 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m19:10:19.513935 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND ,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from source ('RETMEDIA_INTEGRATION', 'KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN') camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from source('RETMEDIA_INTEGRATION', 'KENVUE_CITRUS_AD_CAMPAIGN') a
left join source('RETMEDIA_INTEGRATION', 'KENVUE_CITRUS_AD_TAG') b
on a.tag_id = b.id
left join source('RETMEDIA_INTEGRATION', 'KENVUE_CITRUS_AD_TAG') c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m19:10:19.608923 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:10:19.624558 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:10:19.624558 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:10:19.624558 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from source ('DIGITAL_SHELF', 'KENVUE_CRITEO_AD__DAYREPORT_PRODUCT') a
left join souce ('DIGITAL_SHELF', 'KENVUE_CRITEO_RETAILERS') b
on  a.retailer_id = b.retailer_id
group by 1,2

)



select *
from final
        );
[0m19:10:19.719547 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:10:19.735570 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 19:10:17.168515 => 19:10:19.735570
[0m19:10:19.735570 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m19:10:19.963214 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01ad77d4-0b04-b558-0002-a65600f16256
[0m19:10:19.963214 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ad77d4-0b04-b614-0002-a65600f1927a
[0m19:10:19.978732 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 12 unexpected '('.
syntax error line 8 at position 13 unexpected ''DIGITAL_SHELF''.
syntax error line 8 at position 69 unexpected 'a'.
syntax error line 10 at position 4 unexpected 'a'.
[0m19:10:19.978732 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 46 at position 12 unexpected '('.
syntax error line 46 at position 76 unexpected 'camp'.
[0m19:10:19.978732 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 19:10:17.162517 => 19:10:19.978732
[0m19:10:19.978732 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 19:10:17.164514 => 19:10:19.978732
[0m19:10:19.978732 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m19:10:19.978732 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m19:10:20.233536 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30a38989-7aca-4e73-8b9d-fea4fb3ffef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D6BF0790>]}
[0m19:10:20.233536 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 3.14s]
[0m19:10:20.233536 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:10:20.233536 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:10:20.242238 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m19:10:20.243242 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m19:10:20.244239 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:10:20.247242 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:10:20.249240 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 19:10:20.244239 => 19:10:20.249240
[0m19:10:20.250242 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:10:20.256236 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:10:20.259236 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:10:20.259236 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from source ('DIGITAL_SHELF', 'KENVUE_CRITEO_AD__DAYREPORT_PRODUCT') a
left join souce ('DIGITAL_SHELF', 'KENVUE_CRITEO_RETAILERS') b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m19:10:20.260236 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:10:20.510457 [debug] [Thread-3 (]: Database Error in model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql)
  001003 (42000): SQL compilation error:
  syntax error line 46 at position 12 unexpected '('.
  syntax error line 46 at position 76 unexpected 'camp'.
  compiled Code at target\run\dbt_poc\models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m19:10:20.510457 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30a38989-7aca-4e73-8b9d-fea4fb3ffef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D70ADCD0>]}
[0m19:10:20.510457 [error] [Thread-3 (]: 3 of 7 ERROR creating sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[31mERROR[0m in 3.42s]
[0m19:10:20.510457 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:10:20.515135 [debug] [Thread-3 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m19:10:20.516138 [info ] [Thread-3 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m19:10:20.517134 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN, now model.dbt_poc.my_first_dbt_model)
[0m19:10:20.518137 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m19:10:20.522133 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m19:10:20.523133 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 19:10:20.518137 => 19:10:20.523133
[0m19:10:20.524135 [debug] [Thread-3 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m19:10:20.528135 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m19:10:20.530137 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m19:10:20.530137 [debug] [Thread-3 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:10:20.531137 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:10:20.643133 [debug] [Thread-2 (]: Database Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 12 unexpected '('.
  syntax error line 8 at position 13 unexpected ''DIGITAL_SHELF''.
  syntax error line 8 at position 69 unexpected 'a'.
  syntax error line 10 at position 4 unexpected 'a'.
  compiled Code at target\run\dbt_poc\models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:10:20.644133 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30a38989-7aca-4e73-8b9d-fea4fb3ffef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D66F2210>]}
[0m19:10:20.645134 [error] [Thread-2 (]: 2 of 7 ERROR creating sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[31mERROR[0m in 3.56s]
[0m19:10:20.651133 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:10:21.260034 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:10:21.260034 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 19:10:17.125518 => 19:10:21.260034
[0m19:10:21.260034 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m19:10:21.749861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30a38989-7aca-4e73-8b9d-fea4fb3ffef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D6E42750>]}
[0m19:10:21.749861 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.66s]
[0m19:10:21.749861 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:10:22.312317 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01ad77d4-0b04-b65c-0002-a65600f0ab16
[0m19:10:22.312317 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 12 unexpected '('.
syntax error line 9 at position 13 unexpected ''DIGITAL_SHELF''.
syntax error line 9 at position 69 unexpected 'a'.
[0m19:10:22.312317 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 19:10:20.250242 => 19:10:22.312317
[0m19:10:22.312317 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m19:10:22.812143 [debug] [Thread-4 (]: Database Error in model VW_CRITEO_AD__DAYREPORT_PRODUCT (models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 12 unexpected '('.
  syntax error line 9 at position 13 unexpected ''DIGITAL_SHELF''.
  syntax error line 9 at position 69 unexpected 'a'.
  compiled Code at target\run\dbt_poc\models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:10:22.812143 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30a38989-7aca-4e73-8b9d-fea4fb3ffef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D6F13890>]}
[0m19:10:22.812143 [error] [Thread-4 (]: 5 of 7 ERROR creating sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[31mERROR[0m in 2.57s]
[0m19:10:22.812143 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:10:23.166587 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:10:23.166587 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 19:10:20.525137 => 19:10:23.166587
[0m19:10:23.166587 [debug] [Thread-3 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m19:10:23.652515 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30a38989-7aca-4e73-8b9d-fea4fb3ffef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D6F43CD0>]}
[0m19:10:23.652515 [info ] [Thread-3 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 3.14s]
[0m19:10:23.652515 [debug] [Thread-3 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m19:10:23.666607 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m19:10:23.667620 [info ] [Thread-2 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m19:10:23.668619 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_second_dbt_model)
[0m19:10:23.669619 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m19:10:23.688621 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m19:10:23.693618 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 19:10:23.670619 => 19:10:23.690620
[0m19:10:23.701618 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m19:10:23.728618 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m19:10:23.731621 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m19:10:23.732619 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m19:10:23.733619 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:10:25.589914 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:10:25.592914 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 19:10:23.707617 => 19:10:25.592914
[0m19:10:25.593911 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m19:10:26.094357 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30a38989-7aca-4e73-8b9d-fea4fb3ffef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D6BDE6D0>]}
[0m19:10:26.094357 [info ] [Thread-2 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.43s]
[0m19:10:26.094357 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m19:10:26.100941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:10:26.100941 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m19:10:26.101941 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m19:10:26.101941 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM' was properly closed.
[0m19:10:26.102942 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m19:10:26.107938 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m19:10:26.117937 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m19:10:26.121938 [info ] [MainThread]: 
[0m19:10:26.122940 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 14.31 seconds (14.31s).
[0m19:10:26.143938 [debug] [MainThread]: Command end result
[0m19:10:26.170941 [info ] [MainThread]: 
[0m19:10:26.187939 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m19:10:26.188940 [info ] [MainThread]: 
[0m19:10:26.189939 [error] [MainThread]: [33mDatabase Error in model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql)[0m
[0m19:10:26.190939 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m19:10:26.191939 [error] [MainThread]:   syntax error line 46 at position 12 unexpected '('.
[0m19:10:26.192939 [error] [MainThread]:   syntax error line 46 at position 76 unexpected 'camp'.
[0m19:10:26.193939 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m19:10:26.194938 [info ] [MainThread]: 
[0m19:10:26.195940 [error] [MainThread]: [33mDatabase Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql)[0m
[0m19:10:26.197939 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m19:10:26.198939 [error] [MainThread]:   syntax error line 8 at position 12 unexpected '('.
[0m19:10:26.208939 [error] [MainThread]:   syntax error line 8 at position 13 unexpected ''DIGITAL_SHELF''.
[0m19:10:26.214940 [error] [MainThread]:   syntax error line 8 at position 69 unexpected 'a'.
[0m19:10:26.217942 [error] [MainThread]:   syntax error line 10 at position 4 unexpected 'a'.
[0m19:10:26.218942 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:10:26.219941 [info ] [MainThread]: 
[0m19:10:26.220940 [error] [MainThread]: [33mDatabase Error in model VW_CRITEO_AD__DAYREPORT_PRODUCT (models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql)[0m
[0m19:10:26.221940 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m19:10:26.222938 [error] [MainThread]:   syntax error line 9 at position 12 unexpected '('.
[0m19:10:26.223939 [error] [MainThread]:   syntax error line 9 at position 13 unexpected ''DIGITAL_SHELF''.
[0m19:10:26.224939 [error] [MainThread]:   syntax error line 9 at position 69 unexpected 'a'.
[0m19:10:26.225939 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:10:26.226941 [info ] [MainThread]: 
[0m19:10:26.227940 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
[0m19:10:26.257939 [debug] [MainThread]: Command `dbt run` failed at 19:10:26.246938 after 17.94 seconds
[0m19:10:26.259940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D4EDD9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D53D4150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D305ADD0>]}
[0m19:10:26.259940 [debug] [MainThread]: Flushing usage events
[0m19:10:27.093317 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:56:16.680597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A2317390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A2350A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A299B750>]}


============================== 19:56:16.700247 | fe14d6c1-b332-4d65-ac6c-85d61835195c ==============================
[0m19:56:16.700247 [info ] [MainThread]: Running with dbt=1.5.2
[0m19:56:16.700247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:56:18.462257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe14d6c1-b332-4d65-ac6c-85d61835195c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A1EDD0D0>]}
[0m19:56:18.481407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe14d6c1-b332-4d65-ac6c-85d61835195c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A1E3FB90>]}
[0m19:56:18.481407 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m19:56:18.533461 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m19:56:19.106994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m19:56:19.107994 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:56:19.108990 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:56:19.108990 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m19:56:19.109991 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m19:56:19.110989 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m19:56:19.138059 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:56:19.151073 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:56:19.151073 [debug] [MainThread]: 1603: static parser failed on L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:56:19.151073 [debug] [MainThread]: 1602: parser fallback to jinja rendering on L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:56:19.151073 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m19:56:19.175240 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m19:56:19.182341 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m19:56:19.182341 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m19:56:19.182341 [debug] [MainThread]: 1699: static parser successfully parsed L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m19:56:19.200477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe14d6c1-b332-4d65-ac6c-85d61835195c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A3615010>]}
[0m19:56:19.299526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe14d6c1-b332-4d65-ac6c-85d61835195c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A3625CD0>]}
[0m19:56:19.299526 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m19:56:19.350498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe14d6c1-b332-4d65-ac6c-85d61835195c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001909E03AE90>]}
[0m19:56:19.353499 [info ] [MainThread]: 
[0m19:56:19.357498 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:56:19.360496 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m19:56:19.385499 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m19:56:19.386496 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m19:56:19.386496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:21.954137 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m19:56:21.954137 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m19:56:22.452674 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m19:56:22.452674 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m19:56:22.452674 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m19:56:22.452674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:24.157474 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m19:56:24.157474 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m19:56:24.671650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe14d6c1-b332-4d65-ac6c-85d61835195c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A3555FD0>]}
[0m19:56:24.671650 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:56:24.671650 [info ] [MainThread]: 
[0m19:56:24.697000 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:56:24.697000 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:56:24.698000 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:56:24.698000 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:56:24.698999 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m19:56:24.699999 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m19:56:24.700999 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m19:56:24.701999 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m19:56:24.714998 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m19:56:24.705001 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m19:56:24.707998 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m19:56:24.704003 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m19:56:24.716001 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:56:24.717000 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:56:24.718002 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:56:24.719001 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:56:24.723999 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m19:56:24.729000 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:56:24.734001 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m19:56:24.748001 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m19:56:24.751000 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 19:56:24.725000 => 19:56:24.751000
[0m19:56:24.752001 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 19:56:24.730000 => 19:56:24.751000
[0m19:56:24.752001 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:56:24.753000 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 19:56:24.735001 => 19:56:24.753000
[0m19:56:24.775997 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:56:24.755001 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:56:24.754002 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 19:56:24.719001 => 19:56:24.754002
[0m19:56:24.795001 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:56:24.810001 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m19:56:24.813003 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m19:56:24.814001 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:56:24.815002 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:56:24.815002 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:56:24.816001 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:56:24.841000 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m19:56:24.842001 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:56:24.843000 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:56:24.843000 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:56:24.848002 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m19:56:24.854999 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM as a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS as b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m19:56:24.856001 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:56:27.297251 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:56:27.297251 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m19:56:27.297251 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:56:27.312888 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:56:27.312888 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m19:56:27.312888 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND ,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from source ('RETMEDIA_INTEGRATION', 'KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN') as camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from source('RETMEDIA_INTEGRATION', 'KENVUE_CITRUS_AD_CAMPAIGN') as a
left join source('RETMEDIA_INTEGRATION', 'KENVUE_CITRUS_AD_TAG') as b
on a.tag_id = b.id
left join source('RETMEDIA_INTEGRATION', 'KENVUE_CITRUS_AD_TAG') as c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m19:56:27.312888 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:56:27.312888 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from source ('DIGITAL_SHELF', 'KENVUE_CRITEO_AD__DAYREPORT_PRODUCT') a
left join souce ('DIGITAL_SHELF', 'KENVUE_CRITEO_RETAILERS') b
on  a.retailer_id = b.retailer_id
group by 1,2

)



select *
from final
        );
[0m19:56:27.360563 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:56:27.392235 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 19:56:24.818000 => 19:56:27.392235
[0m19:56:27.392235 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m19:56:27.407872 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:56:27.407872 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m19:56:27.407872 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m19:56:27.407872 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM as a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS as b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
        );
[0m19:56:27.702198 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01ad7802-0b04-b614-0002-a65600f192de
[0m19:56:27.702198 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ad7802-0b04-b65c-0002-a65600f0ab3a
[0m19:56:27.702198 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 12 unexpected '('.
syntax error line 8 at position 13 unexpected ''DIGITAL_SHELF''.
syntax error line 8 at position 69 unexpected 'a'.
syntax error line 10 at position 4 unexpected 'a'.
[0m19:56:27.702198 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 46 at position 12 unexpected '('.
syntax error line 46 at position 76 unexpected 'as'.
[0m19:56:27.702198 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 19:56:24.755001 => 19:56:27.702198
[0m19:56:27.702198 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 19:56:24.810001 => 19:56:27.702198
[0m19:56:27.702198 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m19:56:27.702198 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m19:56:28.002697 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe14d6c1-b332-4d65-ac6c-85d61835195c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A3522F90>]}
[0m19:56:28.002697 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 3.29s]
[0m19:56:28.002697 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:56:28.002697 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:56:28.006535 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m19:56:28.007541 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m19:56:28.009534 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:56:28.015534 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:56:28.016534 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 19:56:28.010535 => 19:56:28.016534
[0m19:56:28.017536 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:56:28.022534 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:56:28.024534 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:56:28.025536 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from source ('DIGITAL_SHELF', 'KENVUE_CRITEO_AD__DAYREPORT_PRODUCT') as a
left join souce ('DIGITAL_SHELF', 'KENVUE_CRITEO_RETAILERS') as b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m19:56:28.025536 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:56:28.255535 [debug] [Thread-2 (]: Database Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 12 unexpected '('.
  syntax error line 8 at position 13 unexpected ''DIGITAL_SHELF''.
  syntax error line 8 at position 69 unexpected 'a'.
  syntax error line 10 at position 4 unexpected 'a'.
  compiled Code at target\run\dbt_poc\models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:56:28.257537 [debug] [Thread-3 (]: Database Error in model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql)
  001003 (42000): SQL compilation error:
  syntax error line 46 at position 12 unexpected '('.
  syntax error line 46 at position 76 unexpected 'as'.
  compiled Code at target\run\dbt_poc\models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m19:56:28.258536 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe14d6c1-b332-4d65-ac6c-85d61835195c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A3E77A50>]}
[0m19:56:28.259534 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe14d6c1-b332-4d65-ac6c-85d61835195c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A23505D0>]}
[0m19:56:28.260535 [error] [Thread-2 (]: 2 of 7 ERROR creating sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[31mERROR[0m in 3.55s]
[0m19:56:28.263538 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:56:28.263905 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m19:56:28.262534 [error] [Thread-3 (]: 3 of 7 ERROR creating sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[31mERROR[0m in 3.55s]
[0m19:56:28.264907 [info ] [Thread-2 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m19:56:28.273912 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:56:28.279907 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_first_dbt_model)
[0m19:56:28.280905 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m19:56:28.284907 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m19:56:28.286906 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 19:56:28.281907 => 19:56:28.285908
[0m19:56:28.287907 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m19:56:28.291906 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m19:56:28.293907 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m19:56:28.294907 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:56:28.295908 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:56:29.159384 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:56:29.163389 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 19:56:24.796002 => 19:56:29.162389
[0m19:56:29.163389 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m19:56:29.644319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe14d6c1-b332-4d65-ac6c-85d61835195c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A3E16B10>]}
[0m19:56:29.644319 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.94s]
[0m19:56:29.644319 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:56:29.920757 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01ad7802-0b04-b65c-0002-a65600f0ab42
[0m19:56:29.920757 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 12 unexpected '('.
syntax error line 9 at position 13 unexpected ''DIGITAL_SHELF''.
syntax error line 9 at position 69 unexpected 'as'.
[0m19:56:29.920757 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 19:56:28.017536 => 19:56:29.920757
[0m19:56:29.920757 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m19:56:30.419137 [debug] [Thread-4 (]: Database Error in model VW_CRITEO_AD__DAYREPORT_PRODUCT (models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 12 unexpected '('.
  syntax error line 9 at position 13 unexpected ''DIGITAL_SHELF''.
  syntax error line 9 at position 69 unexpected 'as'.
  compiled Code at target\run\dbt_poc\models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:56:30.421644 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe14d6c1-b332-4d65-ac6c-85d61835195c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A3468D50>]}
[0m19:56:30.421644 [error] [Thread-4 (]: 5 of 7 ERROR creating sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[31mERROR[0m in 2.41s]
[0m19:56:30.421644 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:56:30.561186 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:56:30.564185 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 19:56:28.287907 => 19:56:30.563185
[0m19:56:30.564185 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m19:56:31.044177 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe14d6c1-b332-4d65-ac6c-85d61835195c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A23759D0>]}
[0m19:56:31.047694 [info ] [Thread-2 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 2.77s]
[0m19:56:31.047694 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m19:56:31.049709 [debug] [Thread-3 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m19:56:31.050711 [info ] [Thread-3 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m19:56:31.051709 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN, now model.dbt_poc.my_second_dbt_model)
[0m19:56:31.052711 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m19:56:31.071711 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m19:56:31.073709 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 19:56:31.052711 => 19:56:31.073709
[0m19:56:31.074711 [debug] [Thread-3 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m19:56:31.080708 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m19:56:31.100710 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m19:56:31.102711 [debug] [Thread-3 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m19:56:31.102711 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:56:33.044156 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:56:33.044156 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 19:56:31.075709 => 19:56:33.044156
[0m19:56:33.044156 [debug] [Thread-3 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m19:56:33.980462 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe14d6c1-b332-4d65-ac6c-85d61835195c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A3625CD0>]}
[0m19:56:33.980462 [info ] [Thread-3 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.93s]
[0m19:56:33.981522 [debug] [Thread-3 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m19:56:33.984278 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:33.985280 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m19:56:33.987278 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m19:56:33.994276 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM' was properly closed.
[0m19:56:34.000277 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m19:56:34.004278 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m19:56:34.004278 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m19:56:34.005278 [info ] [MainThread]: 
[0m19:56:34.006280 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 14.65 seconds (14.65s).
[0m19:56:34.009279 [debug] [MainThread]: Command end result
[0m19:56:34.032277 [info ] [MainThread]: 
[0m19:56:34.037281 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m19:56:34.038281 [info ] [MainThread]: 
[0m19:56:34.039279 [error] [MainThread]: [33mDatabase Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql)[0m
[0m19:56:34.040282 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m19:56:34.042278 [error] [MainThread]:   syntax error line 8 at position 12 unexpected '('.
[0m19:56:34.043278 [error] [MainThread]:   syntax error line 8 at position 13 unexpected ''DIGITAL_SHELF''.
[0m19:56:34.044281 [error] [MainThread]:   syntax error line 8 at position 69 unexpected 'a'.
[0m19:56:34.045281 [error] [MainThread]:   syntax error line 10 at position 4 unexpected 'a'.
[0m19:56:34.046281 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:56:34.047278 [info ] [MainThread]: 
[0m19:56:34.048282 [error] [MainThread]: [33mDatabase Error in model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql)[0m
[0m19:56:34.049280 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m19:56:34.067279 [error] [MainThread]:   syntax error line 46 at position 12 unexpected '('.
[0m19:56:34.068280 [error] [MainThread]:   syntax error line 46 at position 76 unexpected 'as'.
[0m19:56:34.069279 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m19:56:34.070280 [info ] [MainThread]: 
[0m19:56:34.071279 [error] [MainThread]: [33mDatabase Error in model VW_CRITEO_AD__DAYREPORT_PRODUCT (models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql)[0m
[0m19:56:34.072278 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m19:56:34.073279 [error] [MainThread]:   syntax error line 9 at position 12 unexpected '('.
[0m19:56:34.074282 [error] [MainThread]:   syntax error line 9 at position 13 unexpected ''DIGITAL_SHELF''.
[0m19:56:34.076278 [error] [MainThread]:   syntax error line 9 at position 69 unexpected 'as'.
[0m19:56:34.077279 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:56:34.080281 [info ] [MainThread]: 
[0m19:56:34.095281 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
[0m19:56:34.097279 [debug] [MainThread]: Command `dbt run` failed at 19:56:34.097279 after 17.78 seconds
[0m19:56:34.098279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A1D99CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A29A0750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001909CF3FE10>]}
[0m19:56:34.099280 [debug] [MainThread]: Flushing usage events
[0m19:56:34.985791 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:01:15.658151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023452A696D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023452B16090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023452A7D550>]}


============================== 20:01:15.669661 | 5b0f5432-2ea3-47ad-97dc-12c50362609c ==============================
[0m20:01:15.669661 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:01:15.669661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:01:15.673340 [info ] [MainThread]: dbt version: 1.5.2
[0m20:01:15.674344 [info ] [MainThread]: python version: 3.11.4
[0m20:01:15.675340 [info ] [MainThread]: python path: C:\Users\SNando01\dbt-venv\Scripts\python.exe
[0m20:01:15.678340 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m20:01:15.679340 [info ] [MainThread]: Using profiles.yml file at C:\Users\SNando01\.dbt\profiles.yml
[0m20:01:15.680340 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SNando01\DBT_POC\dbt_project.yml
[0m20:01:15.681339 [info ] [MainThread]: Configuration:
[0m20:01:15.968146 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:01:16.033298 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:01:16.034300 [info ] [MainThread]: Required dependencies:
[0m20:01:16.035302 [debug] [MainThread]: Executing "git --help"
[0m20:01:16.514094 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:01:16.514094 [debug] [MainThread]: STDERR: "b''"
[0m20:01:16.514094 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:01:16.526792 [info ] [MainThread]: Connection:
[0m20:01:16.527792 [info ] [MainThread]:   account: bk40750.east-us-2.azure
[0m20:01:16.530792 [info ] [MainThread]:   user: MHennes3
[0m20:01:16.539794 [info ] [MainThread]:   database: COMMEX_DB
[0m20:01:16.541792 [info ] [MainThread]:   schema: DIGITAL_SHELF_DBT
[0m20:01:16.542791 [info ] [MainThread]:   warehouse: DEV_COMX_GLOBAL_APP1_WH
[0m20:01:16.543796 [info ] [MainThread]:   role: DEV_COMX_GLOBAL_DEVELOPER_FR
[0m20:01:16.544794 [info ] [MainThread]:   client_session_keep_alive: False
[0m20:01:16.545793 [info ] [MainThread]:   query_tag: None
[0m20:01:16.547793 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:01:16.548792 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m20:01:16.550791 [debug] [MainThread]: Using snowflake connection "debug"
[0m20:01:16.554791 [debug] [MainThread]: On debug: select 1 as id
[0m20:01:16.558791 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:01:18.607871 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:01:18.607871 [debug] [MainThread]: On debug: Close
[0m20:01:19.115601 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:01:19.116602 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:01:19.118604 [debug] [MainThread]: Command `dbt debug` succeeded at 20:01:19.117606 after 3.71 seconds
[0m20:01:19.118604 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:01:19.119601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023453B50D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002344D63FD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002344D63F150>]}
[0m20:01:19.119601 [debug] [MainThread]: Flushing usage events
[0m20:01:20.206311 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:01:36.109930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EBC296D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EC1C6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EBC28D90>]}


============================== 20:01:36.109930 | dfc19906-9377-4038-8eef-b0107ae91901 ==============================
[0m20:01:36.109930 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:01:36.109930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:01:37.763066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfc19906-9377-4038-8eef-b0107ae91901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EC7F9AD0>]}
[0m20:01:37.773083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfc19906-9377-4038-8eef-b0107ae91901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217ED268350>]}
[0m20:01:37.773083 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:01:37.820035 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:01:38.381041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m20:01:38.381041 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:01:38.381041 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:01:38.381041 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:01:38.397063 [debug] [MainThread]: 1603: static parser failed on L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:01:38.419723 [debug] [MainThread]: 1602: parser fallback to jinja rendering on L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:01:38.419723 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:01:38.428739 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:01:38.428739 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:01:38.428739 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:01:38.444379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfc19906-9377-4038-8eef-b0107ae91901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217ED33D290>]}
[0m20:01:38.450889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfc19906-9377-4038-8eef-b0107ae91901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217ED36A950>]}
[0m20:01:38.450889 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m20:01:38.454839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfc19906-9377-4038-8eef-b0107ae91901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217E7E3AC50>]}
[0m20:01:38.458839 [info ] [MainThread]: 
[0m20:01:38.473841 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:01:38.477838 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m20:01:38.500840 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m20:01:38.501840 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m20:01:38.501840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:41.013083 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m20:01:41.028729 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m20:01:41.563587 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m20:01:41.575607 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m20:01:41.575607 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m20:01:41.575607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:43.562276 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m20:01:43.562276 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m20:01:44.062596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfc19906-9377-4038-8eef-b0107ae91901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EC8006D0>]}
[0m20:01:44.062596 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:01:44.062596 [info ] [MainThread]: 
[0m20:01:44.089141 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:01:44.090143 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:01:44.091143 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:01:44.091143 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:01:44.092142 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m20:01:44.093141 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m20:01:44.094144 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m20:01:44.095142 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m20:01:44.097142 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m20:01:44.098143 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m20:01:44.099145 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m20:01:44.100143 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m20:01:44.101141 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:01:44.102141 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:01:44.102141 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:01:44.103141 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:01:44.108143 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:01:44.113143 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:01:44.128143 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:01:44.132142 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:01:44.134142 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 20:01:44.104142 => 20:01:44.134142
[0m20:01:44.135141 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:01:44.136144 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 20:01:44.128143 => 20:01:44.136144
[0m20:01:44.137141 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:01:44.109144 => 20:01:44.136144
[0m20:01:44.143142 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 20:01:44.123140 => 20:01:44.142141
[0m20:01:44.184143 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:01:44.184143 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:01:44.185144 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:01:44.186143 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:01:44.227144 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:01:44.227144 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:01:44.231144 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:01:44.235143 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:01:44.236142 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:01:44.237144 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:01:44.238144 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:01:44.239140 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:01:44.242146 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:01:44.243144 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM as a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS as b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m20:01:44.244142 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:01:44.247142 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:01:46.408716 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:01:46.472045 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:01:46.472045 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:01:46.472045 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:01:46.472045 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:01:46.472045 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:01:46.488071 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 20:01:44.186143 => 20:01:46.488071
[0m20:01:46.488071 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:01:46.488071 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:01:46.503712 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m20:01:46.503712 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND ,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from source ('RETMEDIA_INTEGRATION', 'KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN') as camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from source('RETMEDIA_INTEGRATION', 'KENVUE_CITRUS_AD_CAMPAIGN') as a
left join source('RETMEDIA_INTEGRATION', 'KENVUE_CITRUS_AD_TAG') as b
on a.tag_id = b.id
left join source('RETMEDIA_INTEGRATION', 'KENVUE_CITRUS_AD_TAG') as c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m20:01:46.503712 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:01:46.503712 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:01:46.503712 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from source ('DIGITAL_SHELF', 'KENVUE_CRITEO_AD__DAYREPORT_PRODUCT') a
left join source ('DIGITAL_SHELF', 'KENVUE_CRITEO_RETAILERS') b
on  a.retailer_id = b.retailer_id
group by 1,2

)



select *
from final
        );
[0m20:01:46.503712 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM as a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS as b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
        );
[0m20:01:46.919647 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01ad7807-0b04-b65c-0002-a65600f0ab9a
[0m20:01:46.919647 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ad7807-0b04-b614-0002-a65600f19326
[0m20:01:46.919647 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 12 unexpected '('.
syntax error line 8 at position 13 unexpected ''DIGITAL_SHELF''.
syntax error line 8 at position 69 unexpected 'a'.
syntax error line 10 at position 4 unexpected 'a'.
[0m20:01:46.919647 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 46 at position 12 unexpected '('.
syntax error line 46 at position 76 unexpected 'as'.
[0m20:01:46.919647 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:01:44.228144 => 20:01:46.919647
[0m20:01:46.919647 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 20:01:44.231144 => 20:01:46.919647
[0m20:01:46.919647 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:01:46.924156 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m20:01:46.987465 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfc19906-9377-4038-8eef-b0107ae91901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217ED43FC10>]}
[0m20:01:46.987465 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 2.89s]
[0m20:01:46.987465 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:01:46.991654 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:01:46.992656 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m20:01:46.995651 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m20:01:46.996655 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:01:47.001654 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:01:47.002655 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:01:46.996655 => 20:01:47.002655
[0m20:01:47.003653 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:01:47.008653 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:01:47.010654 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:01:47.011653 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from source ('DIGITAL_SHELF', 'KENVUE_CRITEO_AD__DAYREPORT_PRODUCT') as a
left join source ('DIGITAL_SHELF', 'KENVUE_CRITEO_RETAILERS') as b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m20:01:47.011653 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:01:47.423954 [debug] [Thread-3 (]: Database Error in model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql)
  001003 (42000): SQL compilation error:
  syntax error line 46 at position 12 unexpected '('.
  syntax error line 46 at position 76 unexpected 'as'.
  compiled Code at target\run\dbt_poc\models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:01:47.423954 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfc19906-9377-4038-8eef-b0107ae91901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217ED3E9810>]}
[0m20:01:47.423954 [error] [Thread-3 (]: 3 of 7 ERROR creating sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[31mERROR[0m in 3.32s]
[0m20:01:47.423954 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:01:47.430524 [debug] [Thread-2 (]: Database Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 12 unexpected '('.
  syntax error line 8 at position 13 unexpected ''DIGITAL_SHELF''.
  syntax error line 8 at position 69 unexpected 'a'.
  syntax error line 10 at position 4 unexpected 'a'.
  compiled Code at target\run\dbt_poc\models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:01:47.430524 [debug] [Thread-3 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m20:01:47.431522 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfc19906-9377-4038-8eef-b0107ae91901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217ED2C0250>]}
[0m20:01:47.432522 [info ] [Thread-3 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m20:01:47.436521 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN, now model.dbt_poc.my_first_dbt_model)
[0m20:01:47.433523 [error] [Thread-2 (]: 2 of 7 ERROR creating sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[31mERROR[0m in 3.33s]
[0m20:01:47.437523 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m20:01:47.438521 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:01:47.442521 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m20:01:47.451522 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 20:01:47.438521 => 20:01:47.451522
[0m20:01:47.452522 [debug] [Thread-3 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m20:01:47.458519 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m20:01:47.460522 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:01:47.464521 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 20:01:44.137141 => 20:01:47.464521
[0m20:01:47.465520 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m20:01:47.466521 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m20:01:47.470524 [debug] [Thread-3 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:01:47.471522 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:01:47.987371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfc19906-9377-4038-8eef-b0107ae91901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217ED5B5C50>]}
[0m20:01:47.987371 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 3.89s]
[0m20:01:47.987371 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:01:48.780459 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01ad7807-0b04-b614-0002-a65600f1932a
[0m20:01:48.780459 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 12 unexpected '('.
syntax error line 9 at position 13 unexpected ''DIGITAL_SHELF''.
syntax error line 9 at position 69 unexpected 'as'.
[0m20:01:48.780459 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:01:47.004653 => 20:01:48.780459
[0m20:01:48.780459 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:01:49.280446 [debug] [Thread-4 (]: Database Error in model VW_CRITEO_AD__DAYREPORT_PRODUCT (models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 12 unexpected '('.
  syntax error line 9 at position 13 unexpected ''DIGITAL_SHELF''.
  syntax error line 9 at position 69 unexpected 'as'.
  compiled Code at target\run\dbt_poc\models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:01:49.280446 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfc19906-9377-4038-8eef-b0107ae91901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EDDD1290>]}
[0m20:01:49.280446 [error] [Thread-4 (]: 5 of 7 ERROR creating sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[31mERROR[0m in 2.29s]
[0m20:01:49.280446 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:01:49.726682 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:01:49.729712 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 20:01:47.452522 => 20:01:49.729712
[0m20:01:49.730712 [debug] [Thread-3 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m20:01:50.206498 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfc19906-9377-4038-8eef-b0107ae91901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EDDAD650>]}
[0m20:01:50.206498 [info ] [Thread-3 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 2.77s]
[0m20:01:50.206498 [debug] [Thread-3 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m20:01:50.214632 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m20:01:50.215631 [info ] [Thread-2 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m20:01:50.216633 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_second_dbt_model)
[0m20:01:50.217634 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m20:01:50.236631 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m20:01:50.245629 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 20:01:50.218633 => 20:01:50.240629
[0m20:01:50.254629 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m20:01:50.259630 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m20:01:50.261632 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m20:01:50.262632 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m20:01:50.262632 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:01:52.332152 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:01:52.332152 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 20:01:50.255634 => 20:01:52.332152
[0m20:01:52.332152 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m20:01:52.816116 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfc19906-9377-4038-8eef-b0107ae91901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EDC94C50>]}
[0m20:01:52.825628 [info ] [Thread-2 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.60s]
[0m20:01:52.825628 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m20:01:52.833271 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:01:52.842270 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m20:01:52.847271 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m20:01:52.848273 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM' was properly closed.
[0m20:01:52.849273 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m20:01:52.849273 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m20:01:52.850275 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m20:01:52.851271 [info ] [MainThread]: 
[0m20:01:52.852272 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 14.38 seconds (14.38s).
[0m20:01:52.854276 [debug] [MainThread]: Command end result
[0m20:01:52.880273 [info ] [MainThread]: 
[0m20:01:52.881275 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:01:52.882274 [info ] [MainThread]: 
[0m20:01:52.884272 [error] [MainThread]: [33mDatabase Error in model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql)[0m
[0m20:01:52.885277 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m20:01:52.886273 [error] [MainThread]:   syntax error line 46 at position 12 unexpected '('.
[0m20:01:52.887275 [error] [MainThread]:   syntax error line 46 at position 76 unexpected 'as'.
[0m20:01:52.888272 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:01:52.889272 [info ] [MainThread]: 
[0m20:01:52.891274 [error] [MainThread]: [33mDatabase Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql)[0m
[0m20:01:52.909273 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m20:01:52.911272 [error] [MainThread]:   syntax error line 8 at position 12 unexpected '('.
[0m20:01:52.912274 [error] [MainThread]:   syntax error line 8 at position 13 unexpected ''DIGITAL_SHELF''.
[0m20:01:52.913274 [error] [MainThread]:   syntax error line 8 at position 69 unexpected 'a'.
[0m20:01:52.914274 [error] [MainThread]:   syntax error line 10 at position 4 unexpected 'a'.
[0m20:01:52.915274 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:01:52.916274 [info ] [MainThread]: 
[0m20:01:52.917273 [error] [MainThread]: [33mDatabase Error in model VW_CRITEO_AD__DAYREPORT_PRODUCT (models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql)[0m
[0m20:01:52.918274 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m20:01:52.919274 [error] [MainThread]:   syntax error line 9 at position 12 unexpected '('.
[0m20:01:52.921274 [error] [MainThread]:   syntax error line 9 at position 13 unexpected ''DIGITAL_SHELF''.
[0m20:01:52.922274 [error] [MainThread]:   syntax error line 9 at position 69 unexpected 'as'.
[0m20:01:52.923273 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:01:52.924273 [info ] [MainThread]: 
[0m20:01:52.925271 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
[0m20:01:52.933270 [debug] [MainThread]: Command `dbt run` failed at 20:01:52.932270 after 17.17 seconds
[0m20:01:52.939270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217E6D3FD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217E6D3F1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EBCCE750>]}
[0m20:01:52.940272 [debug] [MainThread]: Flushing usage events
[0m20:01:53.004271 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:03:20.491179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209FC5CDC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209FC552990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209FC488690>]}


============================== 20:03:20.491179 | 734be70f-1477-4fce-9ecc-815ba702f4df ==============================
[0m20:03:20.491179 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:03:20.491179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:03:20.950821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '734be70f-1477-4fce-9ecc-815ba702f4df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209FC615E90>]}
[0m20:03:20.965836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '734be70f-1477-4fce-9ecc-815ba702f4df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209FD645910>]}
[0m20:03:20.965836 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:03:21.009802 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:03:21.107805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m20:03:21.108811 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:03:21.109804 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:03:21.109804 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m20:03:21.110803 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m20:03:21.129803 [debug] [MainThread]: 1603: static parser failed on L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:03:21.145802 [debug] [MainThread]: 1602: parser fallback to jinja rendering on L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:03:21.148802 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:03:21.153802 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:03:21.155802 [debug] [MainThread]: 1699: static parser successfully parsed L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m20:03:21.160804 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m20:03:21.166802 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m20:03:21.176802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '734be70f-1477-4fce-9ecc-815ba702f4df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209FD79B310>]}
[0m20:03:21.185806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '734be70f-1477-4fce-9ecc-815ba702f4df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209FD87A5D0>]}
[0m20:03:21.186807 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m20:03:21.188804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '734be70f-1477-4fce-9ecc-815ba702f4df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209F822AC50>]}
[0m20:03:21.191812 [info ] [MainThread]: 
[0m20:03:21.207805 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:03:21.211804 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m20:03:21.242803 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m20:03:21.245806 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m20:03:21.246807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:23.658634 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m20:03:23.658634 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m20:03:24.174310 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m20:03:24.195174 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m20:03:24.195174 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m20:03:24.195174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:25.799457 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m20:03:25.799457 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m20:03:26.315099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '734be70f-1477-4fce-9ecc-815ba702f4df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209FDAB95D0>]}
[0m20:03:26.315099 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:03:26.315099 [info ] [MainThread]: 
[0m20:03:26.339987 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:03:26.339987 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:03:26.340985 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:03:26.340985 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:03:26.349984 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m20:03:26.350983 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m20:03:26.351983 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m20:03:26.354985 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m20:03:26.352986 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m20:03:26.355988 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m20:03:26.356985 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m20:03:26.357986 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:03:26.358987 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m20:03:26.359986 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:03:26.359986 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:03:26.373985 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:03:26.374986 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:03:26.377988 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:03:26.380982 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:03:26.384982 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:03:26.385984 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 20:03:26.360987 => 20:03:26.384982
[0m20:03:26.388987 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:03:26.387984 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 20:03:26.378985 => 20:03:26.387984
[0m20:03:26.386984 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:03:26.375988 => 20:03:26.386984
[0m20:03:26.389985 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 20:03:26.381984 => 20:03:26.388987
[0m20:03:26.434985 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:03:26.435988 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:03:26.436986 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:03:26.436986 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:03:26.437984 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:03:26.439982 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:03:26.442985 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:03:26.471984 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:03:26.476988 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:03:26.476988 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:03:26.477986 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:03:26.480984 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:03:26.482986 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:03:26.484984 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:03:26.487986 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m20:03:26.490985 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:03:28.605726 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:03:28.655389 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:03:28.655389 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:03:28.671421 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 20:03:26.443982 => 20:03:28.671421
[0m20:03:28.671421 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m20:03:28.687062 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:03:28.687062 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND ,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from source ('RETMEDIA_INTEGRATION', 'KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN') as camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from source('RETMEDIA_INTEGRATION', 'KENVUE_CITRUS_AD_CAMPAIGN')  a
left join source('RETMEDIA_INTEGRATION', 'KENVUE_CITRUS_AD_TAG')  b
on a.tag_id = b.id
left join source('RETMEDIA_INTEGRATION', 'KENVUE_CITRUS_AD_TAG')  c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m20:03:28.702793 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:03:28.702793 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:03:28.702793 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:03:28.702793 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from source ('DIGITAL_SHELF', 'KENVUE_CRITEO_AD__DAYREPORT_PRODUCT') a
left join source ('DIGITAL_SHELF', 'KENVUE_CRITEO_RETAILERS') b
on  a.retailer_id = b.retailer_id
group by 1,2

)



select *
from final
        );
[0m20:03:28.734447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:03:28.734447 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:03:28.734447 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:03:28.734447 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
        );
[0m20:03:28.971660 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01ad7809-0b04-b614-0002-a65600f1933e
[0m20:03:28.971660 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 12 unexpected '('.
syntax error line 8 at position 13 unexpected ''DIGITAL_SHELF''.
syntax error line 8 at position 69 unexpected 'a'.
syntax error line 10 at position 4 unexpected 'a'.
[0m20:03:28.982167 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:03:26.440982 => 20:03:28.982167
[0m20:03:28.982167 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:03:28.982167 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ad7809-0b04-b65c-0002-a65600f0abb2
[0m20:03:28.987677 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 46 at position 12 unexpected '('.
syntax error line 46 at position 76 unexpected 'as'.
[0m20:03:28.987677 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 20:03:26.437984 => 20:03:28.987677
[0m20:03:28.987677 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m20:03:29.700415 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '734be70f-1477-4fce-9ecc-815ba702f4df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209FE172450>]}
[0m20:03:29.701468 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 3.34s]
[0m20:03:29.705423 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:03:29.705423 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:03:29.706426 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m20:03:29.711423 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m20:03:29.712424 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:03:29.717423 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:03:29.720423 [debug] [Thread-3 (]: Database Error in model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql)
  001003 (42000): SQL compilation error:
  syntax error line 46 at position 12 unexpected '('.
  syntax error line 46 at position 76 unexpected 'as'.
  compiled Code at target\run\dbt_poc\models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:03:29.721425 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '734be70f-1477-4fce-9ecc-815ba702f4df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209FE17CAD0>]}
[0m20:03:29.723424 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:03:29.713424 => 20:03:29.722425
[0m20:03:29.722425 [error] [Thread-3 (]: 3 of 7 ERROR creating sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[31mERROR[0m in 3.36s]
[0m20:03:29.723424 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:03:29.724424 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:03:29.729426 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:03:29.730424 [debug] [Thread-3 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m20:03:29.734423 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:03:29.732424 [info ] [Thread-3 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m20:03:29.735426 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from source ('DIGITAL_SHELF', 'KENVUE_CRITEO_AD__DAYREPORT_PRODUCT')  a
left join source ('DIGITAL_SHELF', 'KENVUE_CRITEO_RETAILERS')  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m20:03:29.736426 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN, now model.dbt_poc.my_first_dbt_model)
[0m20:03:29.741421 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:03:29.742424 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m20:03:29.748424 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m20:03:29.739421 [debug] [Thread-2 (]: Database Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 12 unexpected '('.
  syntax error line 8 at position 13 unexpected ''DIGITAL_SHELF''.
  syntax error line 8 at position 69 unexpected 'a'.
  syntax error line 10 at position 4 unexpected 'a'.
  compiled Code at target\run\dbt_poc\models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:03:29.753421 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '734be70f-1477-4fce-9ecc-815ba702f4df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209FE09BC50>]}
[0m20:03:29.755425 [error] [Thread-2 (]: 2 of 7 ERROR creating sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[31mERROR[0m in 3.40s]
[0m20:03:29.757425 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:03:29.761423 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 20:03:29.745423 => 20:03:29.761423
[0m20:03:29.762423 [debug] [Thread-3 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m20:03:29.767425 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m20:03:29.786423 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m20:03:29.787421 [debug] [Thread-3 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:03:29.788425 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:03:30.297645 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:03:30.297645 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 20:03:26.389985 => 20:03:30.297645
[0m20:03:30.297645 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m20:03:30.827431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '734be70f-1477-4fce-9ecc-815ba702f4df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209FD72FD10>]}
[0m20:03:30.827431 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.47s]
[0m20:03:30.827431 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:03:31.627476 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01ad7809-0b04-b614-0002-a65600f19342
[0m20:03:31.638484 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 12 unexpected '('.
syntax error line 9 at position 13 unexpected ''DIGITAL_SHELF''.
syntax error line 9 at position 70 unexpected 'a'.
[0m20:03:31.638484 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:03:29.725425 => 20:03:31.638484
[0m20:03:31.638484 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:03:32.174391 [debug] [Thread-4 (]: Database Error in model VW_CRITEO_AD__DAYREPORT_PRODUCT (models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 12 unexpected '('.
  syntax error line 9 at position 13 unexpected ''DIGITAL_SHELF''.
  syntax error line 9 at position 70 unexpected 'a'.
  compiled Code at target\run\dbt_poc\models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:03:32.174391 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '734be70f-1477-4fce-9ecc-815ba702f4df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209FE1A2350>]}
[0m20:03:32.174391 [error] [Thread-4 (]: 5 of 7 ERROR creating sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[31mERROR[0m in 2.46s]
[0m20:03:32.174391 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:03:32.206207 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:03:32.210207 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 20:03:29.762423 => 20:03:32.210207
[0m20:03:32.211207 [debug] [Thread-3 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m20:03:32.732143 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '734be70f-1477-4fce-9ecc-815ba702f4df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209FD7D8E10>]}
[0m20:03:32.732143 [info ] [Thread-3 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 3.00s]
[0m20:03:32.732143 [debug] [Thread-3 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m20:03:32.736150 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m20:03:32.737151 [info ] [Thread-2 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m20:03:32.739152 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_second_dbt_model)
[0m20:03:32.739152 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m20:03:32.758150 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m20:03:32.760152 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 20:03:32.740153 => 20:03:32.759151
[0m20:03:32.760152 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m20:03:32.765152 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m20:03:32.767154 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m20:03:32.767154 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m20:03:32.768153 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:03:34.736071 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:03:34.736071 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 20:03:32.761150 => 20:03:34.736071
[0m20:03:34.736071 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m20:03:35.235582 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '734be70f-1477-4fce-9ecc-815ba702f4df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209FD879450>]}
[0m20:03:35.235582 [info ] [Thread-2 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.50s]
[0m20:03:35.235582 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m20:03:35.248388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:03:35.248388 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m20:03:35.249388 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m20:03:35.249388 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM' was properly closed.
[0m20:03:35.250388 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m20:03:35.260383 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m20:03:35.265384 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m20:03:35.269386 [info ] [MainThread]: 
[0m20:03:35.271385 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 14.06 seconds (14.06s).
[0m20:03:35.292387 [debug] [MainThread]: Command end result
[0m20:03:35.302387 [info ] [MainThread]: 
[0m20:03:35.323460 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:03:35.323972 [info ] [MainThread]: 
[0m20:03:35.324983 [error] [MainThread]: [33mDatabase Error in model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql)[0m
[0m20:03:35.326986 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m20:03:35.327985 [error] [MainThread]:   syntax error line 46 at position 12 unexpected '('.
[0m20:03:35.328984 [error] [MainThread]:   syntax error line 46 at position 76 unexpected 'as'.
[0m20:03:35.329986 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:03:35.349984 [info ] [MainThread]: 
[0m20:03:35.351986 [error] [MainThread]: [33mDatabase Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql)[0m
[0m20:03:35.353985 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m20:03:35.354985 [error] [MainThread]:   syntax error line 8 at position 12 unexpected '('.
[0m20:03:35.360984 [error] [MainThread]:   syntax error line 8 at position 13 unexpected ''DIGITAL_SHELF''.
[0m20:03:35.374987 [error] [MainThread]:   syntax error line 8 at position 69 unexpected 'a'.
[0m20:03:35.375984 [error] [MainThread]:   syntax error line 10 at position 4 unexpected 'a'.
[0m20:03:35.376984 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:03:35.377984 [info ] [MainThread]: 
[0m20:03:35.378983 [error] [MainThread]: [33mDatabase Error in model VW_CRITEO_AD__DAYREPORT_PRODUCT (models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql)[0m
[0m20:03:35.379985 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m20:03:35.380987 [error] [MainThread]:   syntax error line 9 at position 12 unexpected '('.
[0m20:03:35.381989 [error] [MainThread]:   syntax error line 9 at position 13 unexpected ''DIGITAL_SHELF''.
[0m20:03:35.382986 [error] [MainThread]:   syntax error line 9 at position 70 unexpected 'a'.
[0m20:03:35.382986 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:03:35.383988 [info ] [MainThread]: 
[0m20:03:35.384996 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
[0m20:03:35.386985 [debug] [MainThread]: Command `dbt run` failed at 20:03:35.386985 after 15.15 seconds
[0m20:03:35.386985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209FC528910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209FC0EEFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209FD66F090>]}
[0m20:03:35.387986 [debug] [MainThread]: Flushing usage events
[0m20:03:36.237763 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:06:59.951161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237403596D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023740868650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374086A190>]}


============================== 20:06:59.960956 | 7f33dfe6-50ea-4662-963a-fdb989a47d38 ==============================
[0m20:06:59.960956 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:06:59.961956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:07:00.242483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f33dfe6-50ea-4662-963a-fdb989a47d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023741A0FD50>]}
[0m20:07:00.263638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f33dfe6-50ea-4662-963a-fdb989a47d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023740366850>]}
[0m20:07:00.263638 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:07:00.295176 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:07:00.399175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m20:07:00.400175 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m20:07:00.400175 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:07:00.401176 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m20:07:00.402176 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:07:00.421175 [debug] [MainThread]: 1603: static parser failed on L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m20:07:00.421175 [debug] [MainThread]: 1602: parser fallback to jinja rendering on L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m20:07:00.436842 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:07:00.436842 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:07:00.436842 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m20:07:00.436842 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m20:07:00.452496 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:07:00.452496 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:07:00.468135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f33dfe6-50ea-4662-963a-fdb989a47d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023741B35290>]}
[0m20:07:00.468135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f33dfe6-50ea-4662-963a-fdb989a47d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237403D7ED0>]}
[0m20:07:00.468135 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m20:07:00.480656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f33dfe6-50ea-4662-963a-fdb989a47d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023741A68110>]}
[0m20:07:00.484656 [info ] [MainThread]: 
[0m20:07:00.497655 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:07:00.510656 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m20:07:00.534656 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m20:07:00.535657 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m20:07:00.536657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:02.523193 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m20:07:02.538834 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m20:07:03.066057 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m20:07:03.076064 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m20:07:03.076064 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m20:07:03.076064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:04.691013 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m20:07:04.691013 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m20:07:05.190629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f33dfe6-50ea-4662-963a-fdb989a47d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023740851C90>]}
[0m20:07:05.190629 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:07:05.190629 [info ] [MainThread]: 
[0m20:07:05.218808 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:07:05.219812 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:07:05.219812 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:07:05.222811 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:07:05.221810 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m20:07:05.223810 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m20:07:05.226810 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m20:07:05.227810 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m20:07:05.224811 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m20:07:05.228810 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:07:05.229811 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:07:05.225812 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m20:07:05.230811 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m20:07:05.235811 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:07:05.248810 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:07:05.250814 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m20:07:05.251810 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:07:05.252811 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:07:05.253811 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 20:07:05.231811 => 20:07:05.253811
[0m20:07:05.254811 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:07:05.236810 => 20:07:05.253811
[0m20:07:05.265811 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:07:05.259810 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:07:05.264812 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:07:05.263811 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:07:05.318812 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:07:05.322811 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:07:05.326811 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:07:05.327812 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:07:05.325809 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:07:05.323811 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 20:07:05.254811 => 20:07:05.323811
[0m20:07:05.325809 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 20:07:05.259810 => 20:07:05.324810
[0m20:07:05.341812 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:07:05.342810 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:07:05.343810 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:07:05.349813 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:07:05.362809 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:07:05.385811 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:07:05.385811 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:07:05.389810 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:07:05.404809 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from source ('KENVUE', 'KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM')  a
left join  source ('DIGITAL_SHELF', 'KENVUE_CRITEO_RETAILERS')  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m20:07:05.405808 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:07:07.473157 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01ad780d-0b04-b614-0002-a65600f1934e
[0m20:07:07.473157 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 12 unexpected '('.
syntax error line 10 at position 13 unexpected ''KENVUE''.
syntax error line 10 at position 65 unexpected 'a'.
[0m20:07:07.482669 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 20:07:05.349813 => 20:07:07.473157
[0m20:07:07.482669 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m20:07:07.599768 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:07:07.663087 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:07:07.670102 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:07:07.670102 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND ,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from source ('RETMEDIA_INTEGRATION', 'KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN') as camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from source ('RETMEDIA_INTEGRATION', 'KENVUE_CITRUS_AD_CAMPAIGN')  a
left join source ('RETMEDIA_INTEGRATION', 'KENVUE_CITRUS_AD_TAG')  b
on a.tag_id = b.id
left join source ('RETMEDIA_INTEGRATION', 'KENVUE_CITRUS_AD_TAG')  c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m20:07:07.789299 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:07:07.789299 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:07:07.789299 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:07:07.789299 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from source ('DIGITAL_SHELF', 'KENVUE_CRITEO_AD__DAYREPORT_PRODUCT') a
left join source ('DIGITAL_SHELF', 'KENVUE_CRITEO_RETAILERS') b
on  a.retailer_id = b.retailer_id
group by 1,2

)



select *
from final
        );
[0m20:07:07.851799 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:07:07.851799 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:07:07.867425 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:07:07.867425 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from source ('KENVUE', 'KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM')  a
left join source ('DIGITAL_SHELF', 'KENVUE_CRITEO_RETAILERS') b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
        );
[0m20:07:07.944152 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ad780d-0b04-b614-0002-a65600f1935a
[0m20:07:07.945154 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 46 at position 12 unexpected '('.
syntax error line 46 at position 76 unexpected 'as'.
[0m20:07:07.946156 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 20:07:05.345811 => 20:07:07.945154
[0m20:07:07.947156 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m20:07:07.983368 [debug] [Thread-4 (]: Database Error in model VW_CRITEO_AD__DAYREPORT_LINE_ITEM (models\L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 12 unexpected '('.
  syntax error line 10 at position 13 unexpected ''KENVUE''.
  syntax error line 10 at position 65 unexpected 'a'.
  compiled Code at target\run\dbt_poc\models\L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m20:07:07.983368 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f33dfe6-50ea-4662-963a-fdb989a47d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023741B5F710>]}
[0m20:07:07.983368 [error] [Thread-4 (]: 4 of 7 ERROR creating sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[31mERROR[0m in 2.73s]
[0m20:07:07.983368 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:07:07.983368 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:07:07.997415 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m20:07:07.998417 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m20:07:08.000414 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:07:08.005413 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:07:08.007413 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:07:08.001414 => 20:07:08.006413
[0m20:07:08.007413 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:07:08.012413 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:07:08.015414 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:07:08.015414 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from source ('DIGITAL_SHELF', 'KENVUE_CRITEO_AD__DAYREPORT_PRODUCT')  a
left join source ('DIGITAL_SHELF', 'KENVUE_CRITEO_RETAILERS')  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m20:07:08.016415 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:07:08.098416 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01ad780d-0b04-b614-0002-a65600f1935e
[0m20:07:08.098416 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 12 unexpected '('.
syntax error line 8 at position 13 unexpected ''DIGITAL_SHELF''.
syntax error line 8 at position 69 unexpected 'a'.
syntax error line 10 at position 4 unexpected 'a'.
[0m20:07:08.100418 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:07:05.265811 => 20:07:08.099417
[0m20:07:08.100418 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:07:08.160416 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad780d-0b04-b65c-0002-a65600f0abc6
[0m20:07:08.160416 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 12 unexpected '('.
syntax error line 9 at position 13 unexpected ''KENVUE''.
syntax error line 9 at position 65 unexpected 'a'.
syntax error line 11 at position 4 unexpected 'a'.
[0m20:07:08.161417 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 20:07:05.319812 => 20:07:08.161417
[0m20:07:08.162417 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m20:07:08.448882 [debug] [Thread-3 (]: Database Error in model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql)
  001003 (42000): SQL compilation error:
  syntax error line 46 at position 12 unexpected '('.
  syntax error line 46 at position 76 unexpected 'as'.
  compiled Code at target\run\dbt_poc\models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:07:08.449879 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f33dfe6-50ea-4662-963a-fdb989a47d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023742284510>]}
[0m20:07:08.450884 [error] [Thread-3 (]: 3 of 7 ERROR creating sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[31mERROR[0m in 3.22s]
[0m20:07:08.451885 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:07:08.452883 [debug] [Thread-3 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m20:07:08.453883 [info ] [Thread-3 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m20:07:08.456884 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN, now model.dbt_poc.my_first_dbt_model)
[0m20:07:08.456884 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m20:07:08.461880 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m20:07:08.462880 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 20:07:08.457880 => 20:07:08.462880
[0m20:07:08.463879 [debug] [Thread-3 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m20:07:08.467879 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m20:07:08.469883 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m20:07:08.470879 [debug] [Thread-3 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:07:08.471880 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:07:08.590883 [debug] [Thread-2 (]: Database Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 12 unexpected '('.
  syntax error line 8 at position 13 unexpected ''DIGITAL_SHELF''.
  syntax error line 8 at position 69 unexpected 'a'.
  syntax error line 10 at position 4 unexpected 'a'.
  compiled Code at target\run\dbt_poc\models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:07:08.591883 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f33dfe6-50ea-4662-963a-fdb989a47d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023741C0A2D0>]}
[0m20:07:08.592883 [error] [Thread-2 (]: 2 of 7 ERROR creating sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[31mERROR[0m in 3.36s]
[0m20:07:08.593883 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:07:08.659882 [debug] [Thread-1 (]: Database Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 12 unexpected '('.
  syntax error line 9 at position 13 unexpected ''KENVUE''.
  syntax error line 9 at position 65 unexpected 'a'.
  syntax error line 11 at position 4 unexpected 'a'.
  compiled Code at target\run\dbt_poc\models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m20:07:08.660885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f33dfe6-50ea-4662-963a-fdb989a47d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023741A68410>]}
[0m20:07:08.661884 [error] [Thread-1 (]: 1 of 7 ERROR creating sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[31mERROR[0m in 3.43s]
[0m20:07:08.662882 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:07:09.687661 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01ad780d-0b04-b614-0002-a65600f19362
[0m20:07:09.687661 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 12 unexpected '('.
syntax error line 9 at position 13 unexpected ''DIGITAL_SHELF''.
syntax error line 9 at position 70 unexpected 'a'.
[0m20:07:09.687661 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:07:08.008413 => 20:07:09.687661
[0m20:07:09.687661 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:07:10.187259 [debug] [Thread-4 (]: Database Error in model VW_CRITEO_AD__DAYREPORT_PRODUCT (models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 12 unexpected '('.
  syntax error line 9 at position 13 unexpected ''DIGITAL_SHELF''.
  syntax error line 9 at position 70 unexpected 'a'.
  compiled Code at target\run\dbt_poc\models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:07:10.187259 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f33dfe6-50ea-4662-963a-fdb989a47d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023741BFF890>]}
[0m20:07:10.187259 [error] [Thread-4 (]: 5 of 7 ERROR creating sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[31mERROR[0m in 2.19s]
[0m20:07:10.187259 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:07:10.703041 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:07:10.718677 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 20:07:08.464879 => 20:07:10.718677
[0m20:07:10.718677 [debug] [Thread-3 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m20:07:11.218358 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f33dfe6-50ea-4662-963a-fdb989a47d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023742310250>]}
[0m20:07:11.218358 [info ] [Thread-3 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 2.76s]
[0m20:07:11.218358 [debug] [Thread-3 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m20:07:11.225629 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m20:07:11.226629 [info ] [Thread-2 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m20:07:11.243628 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_second_dbt_model)
[0m20:07:11.244626 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m20:07:11.248626 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m20:07:11.267628 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 20:07:11.244626 => 20:07:11.266626
[0m20:07:11.268629 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m20:07:11.290628 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m20:07:11.292626 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m20:07:11.292626 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m20:07:11.293628 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:07:13.088341 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:07:13.088341 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 20:07:11.268629 => 20:07:13.088341
[0m20:07:13.088341 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m20:07:13.596668 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f33dfe6-50ea-4662-963a-fdb989a47d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374035A590>]}
[0m20:07:13.596668 [info ] [Thread-2 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.35s]
[0m20:07:13.596668 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m20:07:13.609752 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:13.616752 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m20:07:13.623755 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m20:07:13.624758 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM' was properly closed.
[0m20:07:13.624758 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m20:07:13.625756 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m20:07:13.626755 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m20:07:13.626755 [info ] [MainThread]: 
[0m20:07:13.628754 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 13.13 seconds (13.13s).
[0m20:07:13.647754 [debug] [MainThread]: Command end result
[0m20:07:13.673754 [info ] [MainThread]: 
[0m20:07:13.679751 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m20:07:13.696756 [info ] [MainThread]: 
[0m20:07:13.699755 [error] [MainThread]: [33mDatabase Error in model VW_CRITEO_AD__DAYREPORT_LINE_ITEM (models\L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql)[0m
[0m20:07:13.700754 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m20:07:13.701753 [error] [MainThread]:   syntax error line 10 at position 12 unexpected '('.
[0m20:07:13.706757 [error] [MainThread]:   syntax error line 10 at position 13 unexpected ''KENVUE''.
[0m20:07:13.709754 [error] [MainThread]:   syntax error line 10 at position 65 unexpected 'a'.
[0m20:07:13.712756 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m20:07:13.731755 [info ] [MainThread]: 
[0m20:07:13.732756 [error] [MainThread]: [33mDatabase Error in model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql)[0m
[0m20:07:13.734756 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m20:07:13.735755 [error] [MainThread]:   syntax error line 46 at position 12 unexpected '('.
[0m20:07:13.736754 [error] [MainThread]:   syntax error line 46 at position 76 unexpected 'as'.
[0m20:07:13.737755 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:07:13.738754 [info ] [MainThread]: 
[0m20:07:13.739754 [error] [MainThread]: [33mDatabase Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql)[0m
[0m20:07:13.740755 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m20:07:13.753752 [error] [MainThread]:   syntax error line 8 at position 12 unexpected '('.
[0m20:07:13.755756 [error] [MainThread]:   syntax error line 8 at position 13 unexpected ''DIGITAL_SHELF''.
[0m20:07:13.756753 [error] [MainThread]:   syntax error line 8 at position 69 unexpected 'a'.
[0m20:07:13.757754 [error] [MainThread]:   syntax error line 10 at position 4 unexpected 'a'.
[0m20:07:13.758752 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:07:13.759754 [info ] [MainThread]: 
[0m20:07:13.760755 [error] [MainThread]: [33mDatabase Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql)[0m
[0m20:07:13.761756 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m20:07:13.762755 [error] [MainThread]:   syntax error line 9 at position 12 unexpected '('.
[0m20:07:13.763754 [error] [MainThread]:   syntax error line 9 at position 13 unexpected ''KENVUE''.
[0m20:07:13.768754 [error] [MainThread]:   syntax error line 9 at position 65 unexpected 'a'.
[0m20:07:13.827753 [error] [MainThread]:   syntax error line 11 at position 4 unexpected 'a'.
[0m20:07:13.829755 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m20:07:13.830756 [info ] [MainThread]: 
[0m20:07:13.831753 [error] [MainThread]: [33mDatabase Error in model VW_CRITEO_AD__DAYREPORT_PRODUCT (models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql)[0m
[0m20:07:13.832754 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m20:07:13.833756 [error] [MainThread]:   syntax error line 9 at position 12 unexpected '('.
[0m20:07:13.834754 [error] [MainThread]:   syntax error line 9 at position 13 unexpected ''DIGITAL_SHELF''.
[0m20:07:13.835754 [error] [MainThread]:   syntax error line 9 at position 70 unexpected 'a'.
[0m20:07:13.836757 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:07:13.849752 [info ] [MainThread]: 
[0m20:07:13.889756 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=5 SKIP=0 TOTAL=7
[0m20:07:13.915756 [debug] [MainThread]: Command `dbt run` failed at 20:07:13.915756 after 14.22 seconds
[0m20:07:13.916757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374033DA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237408D8210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002373B53FD50>]}
[0m20:07:13.917757 [debug] [MainThread]: Flushing usage events
[0m20:07:14.810820 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:11:24.124450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F10AD050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F0C26750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F1366D50>]}


============================== 20:11:24.124450 | 29c2d126-8d42-4284-94a1-9197ed09481f ==============================
[0m20:11:24.124450 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:11:24.124450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:11:24.425073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29c2d126-8d42-4284-94a1-9197ed09481f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1EF1EB950>]}
[0m20:11:24.440717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29c2d126-8d42-4284-94a1-9197ed09481f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F1F30ED0>]}
[0m20:11:24.451734 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:11:24.477020 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:11:24.598017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m20:11:24.599017 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:11:24.600020 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:11:24.600020 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m20:11:24.601020 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m20:11:24.602020 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:11:24.609019 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:11:24.624694 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:11:24.639208 [debug] [MainThread]: 1699: static parser successfully parsed L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:11:24.640721 [debug] [MainThread]: 1699: static parser successfully parsed L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m20:11:24.640721 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m20:11:24.640721 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m20:11:24.640721 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:11:24.656360 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:11:24.656360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29c2d126-8d42-4284-94a1-9197ed09481f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F2C1F010>]}
[0m20:11:24.672385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29c2d126-8d42-4284-94a1-9197ed09481f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F2B62750>]}
[0m20:11:24.672385 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m20:11:24.672385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29c2d126-8d42-4284-94a1-9197ed09481f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1ED60AE90>]}
[0m20:11:24.684269 [info ] [MainThread]: 
[0m20:11:24.686268 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:11:24.699265 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m20:11:24.728266 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m20:11:24.729268 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m20:11:24.730266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:27.107690 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m20:11:27.111702 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m20:11:27.628840 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m20:11:27.644865 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m20:11:27.644865 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m20:11:27.644865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:29.337439 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m20:11:29.339438 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m20:11:29.890433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29c2d126-8d42-4284-94a1-9197ed09481f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F2B02490>]}
[0m20:11:29.890433 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:11:29.890433 [info ] [MainThread]: 
[0m20:11:29.910263 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:11:29.910263 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:11:29.911265 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:11:29.911265 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:11:29.912266 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m20:11:29.913266 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m20:11:29.914262 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m20:11:29.915264 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m20:11:29.916264 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m20:11:29.917265 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m20:11:29.918265 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m20:11:29.919264 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m20:11:29.919264 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:11:29.920263 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:11:29.920263 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:11:29.921263 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:11:29.927262 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:11:29.939267 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:11:29.943268 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:11:29.946261 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:11:29.948263 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:11:29.935261 => 20:11:29.947263
[0m20:11:29.949266 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 20:11:29.922262 => 20:11:29.948263
[0m20:11:29.949266 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:11:29.950266 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 20:11:29.943268 => 20:11:29.950266
[0m20:11:29.951265 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:11:29.951265 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 20:11:29.939267 => 20:11:29.951265
[0m20:11:30.004266 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:11:30.003266 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:11:30.007264 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:11:30.008265 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:11:30.036267 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:11:30.042261 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:11:30.042261 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:11:30.045262 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:11:30.045262 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:11:30.046264 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:11:30.047263 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:11:30.049265 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:11:30.054262 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:11:30.055263 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join   COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m20:11:30.058263 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:11:32.236374 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:11:32.283708 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:11:32.295220 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:11:32.295220 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:11:32.299731 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:11:32.299731 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND ,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from source ('RETMEDIA_INTEGRATION', 'KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN') as camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_CAMPAIGN  a
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  b
on a.tag_id = b.id
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m20:11:32.299731 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:11:32.299731 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
        );
[0m20:11:32.357981 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:11:32.362990 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:11:32.362990 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:11:32.362990 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)



select *
from final
        );
[0m20:11:32.394640 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:11:32.420285 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 20:11:30.008265 => 20:11:32.420285
[0m20:11:32.420285 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m20:11:32.600486 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ad7811-0b04-b614-0002-a65600f1939a
[0m20:11:32.600486 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 46 at position 12 unexpected '('.
syntax error line 46 at position 76 unexpected 'as'.
[0m20:11:32.600486 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 20:11:30.043261 => 20:11:32.600486
[0m20:11:32.607904 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m20:11:32.964577 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29c2d126-8d42-4284-94a1-9197ed09481f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F1357D10>]}
[0m20:11:32.964577 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 3.05s]
[0m20:11:32.964577 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:11:32.974193 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:11:32.975192 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m20:11:32.976194 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m20:11:32.977196 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:11:32.984193 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:11:32.986194 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:11:32.978194 => 20:11:32.985194
[0m20:11:32.986194 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:11:32.991192 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:11:32.993194 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:11:32.994194 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m20:11:32.995195 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:11:33.202195 [debug] [Thread-3 (]: Database Error in model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql)
  001003 (42000): SQL compilation error:
  syntax error line 46 at position 12 unexpected '('.
  syntax error line 46 at position 76 unexpected 'as'.
  compiled Code at target\run\dbt_poc\models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:11:33.202195 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29c2d126-8d42-4284-94a1-9197ed09481f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F347BC90>]}
[0m20:11:33.217866 [error] [Thread-3 (]: 3 of 7 ERROR creating sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[31mERROR[0m in 3.28s]
[0m20:11:33.217866 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:11:33.219688 [debug] [Thread-3 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m20:11:33.220690 [info ] [Thread-3 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m20:11:33.221687 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN, now model.dbt_poc.my_first_dbt_model)
[0m20:11:33.222690 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m20:11:33.228686 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m20:11:33.229687 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 20:11:33.223686 => 20:11:33.229687
[0m20:11:33.230688 [debug] [Thread-3 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m20:11:33.235687 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m20:11:33.237687 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m20:11:33.237687 [debug] [Thread-3 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:11:33.238687 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:11:33.516051 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:11:33.516051 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 20:11:30.005263 => 20:11:33.516051
[0m20:11:33.516051 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:11:33.516051 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m20:11:33.516051 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:11:29.952265 => 20:11:33.516051
[0m20:11:33.516051 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:11:34.020577 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29c2d126-8d42-4284-94a1-9197ed09481f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F1357B10>]}
[0m20:11:34.020577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29c2d126-8d42-4284-94a1-9197ed09481f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F34DFED0>]}
[0m20:11:34.020577 [info ] [Thread-2 (]: 2 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 4.10s]
[0m20:11:34.020577 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.11s]
[0m20:11:34.025974 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:11:34.026975 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:11:35.154114 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:11:35.157115 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:11:32.987194 => 20:11:35.157115
[0m20:11:35.158117 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:11:35.532376 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:11:35.532376 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 20:11:33.231688 => 20:11:35.532376
[0m20:11:35.532376 [debug] [Thread-3 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m20:11:35.647005 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29c2d126-8d42-4284-94a1-9197ed09481f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F2AC18D0>]}
[0m20:11:35.648006 [info ] [Thread-4 (]: 5 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.67s]
[0m20:11:35.648705 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:11:36.032641 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29c2d126-8d42-4284-94a1-9197ed09481f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F34E1750>]}
[0m20:11:36.045148 [info ] [Thread-3 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 2.81s]
[0m20:11:36.045148 [debug] [Thread-3 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m20:11:36.047246 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m20:11:36.048259 [info ] [Thread-2 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m20:11:36.049259 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_second_dbt_model)
[0m20:11:36.050260 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m20:11:36.069263 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m20:11:36.070261 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 20:11:36.052257 => 20:11:36.070261
[0m20:11:36.071261 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m20:11:36.077261 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m20:11:36.079261 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m20:11:36.080261 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m20:11:36.081261 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:11:38.080502 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:11:38.080502 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 20:11:36.072259 => 20:11:38.080502
[0m20:11:38.080502 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m20:11:38.576561 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29c2d126-8d42-4284-94a1-9197ed09481f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F2A6CF90>]}
[0m20:11:38.576561 [info ] [Thread-2 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.53s]
[0m20:11:38.580569 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m20:11:38.581840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:11:38.582846 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m20:11:38.582846 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m20:11:38.583842 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM' was properly closed.
[0m20:11:38.584841 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m20:11:38.589839 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m20:11:38.599839 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m20:11:38.602842 [info ] [MainThread]: 
[0m20:11:38.603843 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 13.92 seconds (13.92s).
[0m20:11:38.605843 [debug] [MainThread]: Command end result
[0m20:11:38.630841 [info ] [MainThread]: 
[0m20:11:38.631840 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:11:38.633843 [info ] [MainThread]: 
[0m20:11:38.635843 [error] [MainThread]: [33mDatabase Error in model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql)[0m
[0m20:11:38.642842 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m20:11:38.644843 [error] [MainThread]:   syntax error line 46 at position 12 unexpected '('.
[0m20:11:38.646844 [error] [MainThread]:   syntax error line 46 at position 76 unexpected 'as'.
[0m20:11:38.647841 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:11:38.648842 [info ] [MainThread]: 
[0m20:11:38.665851 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m20:11:38.666841 [debug] [MainThread]: Command `dbt run` failed at 20:11:38.666841 after 14.81 seconds
[0m20:11:38.667844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F13294D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F187C2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1EC53FD50>]}
[0m20:11:38.667844 [debug] [MainThread]: Flushing usage events
[0m20:11:39.484188 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:22:17.986795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001801111DC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018011152D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018010C29E10>]}


============================== 20:22:18.002437 | 033a3245-0b8b-46d4-afd1-01568ce37832 ==============================
[0m20:22:18.002437 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:22:18.002437 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:22:19.702763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '033a3245-0b8b-46d4-afd1-01568ce37832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180117A8550>]}
[0m20:22:19.706772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '033a3245-0b8b-46d4-afd1-01568ce37832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018011166090>]}
[0m20:22:19.706772 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:22:19.760524 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:22:20.330075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:22:20.330075 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:22:20.361735 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:22:20.377379 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:22:20.400904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '033a3245-0b8b-46d4-afd1-01568ce37832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018011151B10>]}
[0m20:22:20.409906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '033a3245-0b8b-46d4-afd1-01568ce37832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018012327110>]}
[0m20:22:20.410903 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m20:22:20.413904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '033a3245-0b8b-46d4-afd1-01568ce37832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001800CE0AC50>]}
[0m20:22:20.416905 [info ] [MainThread]: 
[0m20:22:20.418902 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:22:20.420903 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m20:22:20.447900 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m20:22:20.447900 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m20:22:20.448901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:22.941478 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m20:22:22.941478 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m20:22:23.441005 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m20:22:23.441005 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m20:22:23.441005 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m20:22:23.441005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:25.019376 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m20:22:25.019376 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m20:22:25.519438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '033a3245-0b8b-46d4-afd1-01568ce37832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018012B02310>]}
[0m20:22:25.519438 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:22:25.519438 [info ] [MainThread]: 
[0m20:22:25.544417 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:22:25.544417 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:22:25.545417 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:22:25.545417 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:22:25.546419 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m20:22:25.554416 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m20:22:25.560417 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:22:25.547419 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m20:22:25.548420 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m20:22:25.549420 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m20:22:25.566417 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:22:25.568419 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m20:22:25.569419 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m20:22:25.570419 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m20:22:25.571417 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:22:25.572418 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 20:22:25.561419 => 20:22:25.572418
[0m20:22:25.572418 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:22:25.573419 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:22:25.577415 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:22:25.578418 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:22:25.587415 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:22:25.597418 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:22:25.599418 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:22:25.574420 => 20:22:25.599418
[0m20:22:25.635419 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:22:25.636417 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:22:25.637419 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 20:22:25.579418 => 20:22:25.636417
[0m20:22:25.637419 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:22:25.654416 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:22:25.638419 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 20:22:25.593416 => 20:22:25.638419
[0m20:22:25.643418 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:22:25.642420 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:22:25.657418 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:22:25.662419 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:22:25.663417 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:22:25.685418 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:22:25.699418 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:22:25.700420 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:22:25.701417 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:22:25.707418 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:22:25.713416 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join   COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m20:22:25.717416 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:22:27.865683 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:22:27.886693 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 20:22:25.664420 => 20:22:27.886693
[0m20:22:27.887695 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m20:22:27.890771 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:22:27.896779 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:22:27.912421 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:22:27.912421 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND ,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_CAMPAIGN  a
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  b
on a.tag_id = b.id
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m20:22:27.960110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:22:27.960110 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:22:27.960110 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:22:27.960110 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
        );
[0m20:22:27.991775 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:22:27.991775 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:22:28.007415 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:22:28.007415 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)



select *
from final
        );
[0m20:22:28.386894 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '033a3245-0b8b-46d4-afd1-01568ce37832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018012C37B10>]}
[0m20:22:28.387891 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 2.82s]
[0m20:22:28.388891 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:22:28.389896 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:22:28.390894 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m20:22:28.393889 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m20:22:28.394890 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:22:28.399890 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:22:28.400890 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:22:28.394890 => 20:22:28.400890
[0m20:22:28.401890 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:22:28.406890 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:22:28.408894 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:22:28.409894 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m20:22:28.410894 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:22:29.379323 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:22:29.379323 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:22:25.639419 => 20:22:29.379323
[0m20:22:29.379323 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:22:29.379323 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:22:29.379323 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 20:22:25.599418 => 20:22:29.379323
[0m20:22:29.379323 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m20:22:29.864221 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '033a3245-0b8b-46d4-afd1-01568ce37832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018012B989D0>]}
[0m20:22:29.864221 [info ] [Thread-2 (]: 2 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 4.30s]
[0m20:22:29.864221 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:22:29.877543 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m20:22:29.878546 [info ] [Thread-2 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m20:22:29.879545 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_first_dbt_model)
[0m20:22:29.880548 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m20:22:29.885545 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m20:22:29.887545 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 20:22:29.880548 => 20:22:29.887545
[0m20:22:29.888546 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m20:22:29.889546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '033a3245-0b8b-46d4-afd1-01568ce37832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001801236D010>]}
[0m20:22:29.893544 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m20:22:29.897544 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m20:22:29.897544 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:22:29.898545 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:22:29.894545 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.34s]
[0m20:22:29.902545 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:22:30.220249 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:22:30.220249 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:22:28.402891 => 20:22:30.220249
[0m20:22:30.220249 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:22:30.540807 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:22:30.547803 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 20:22:25.658418 => 20:22:30.546802
[0m20:22:30.547803 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m20:22:30.737701 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '033a3245-0b8b-46d4-afd1-01568ce37832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018012B1FED0>]}
[0m20:22:30.737701 [info ] [Thread-4 (]: 5 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.34s]
[0m20:22:30.754223 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:22:31.034443 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '033a3245-0b8b-46d4-afd1-01568ce37832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001801227B750>]}
[0m20:22:31.035440 [info ] [Thread-3 (]: 3 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[32mSUCCESS 1[0m in 5.47s]
[0m20:22:31.037443 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:22:32.525131 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:22:32.525131 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 20:22:29.890544 => 20:22:32.525131
[0m20:22:32.525131 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m20:22:33.046555 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '033a3245-0b8b-46d4-afd1-01568ce37832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018012C37490>]}
[0m20:22:33.046555 [info ] [Thread-2 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 3.17s]
[0m20:22:33.052064 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m20:22:33.053227 [debug] [Thread-1 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m20:22:33.053227 [info ] [Thread-1 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m20:22:33.070226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM, now model.dbt_poc.my_second_dbt_model)
[0m20:22:33.071229 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m20:22:33.075227 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m20:22:33.076228 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 20:22:33.071229 => 20:22:33.076228
[0m20:22:33.077226 [debug] [Thread-1 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m20:22:33.177225 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m20:22:33.179229 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m20:22:33.180228 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m20:22:33.181229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:35.065883 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:22:35.077892 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 20:22:33.077226 => 20:22:35.077892
[0m20:22:35.077892 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m20:22:35.550070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '033a3245-0b8b-46d4-afd1-01568ce37832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018012B1FE50>]}
[0m20:22:35.565707 [info ] [Thread-1 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.48s]
[0m20:22:35.568026 [debug] [Thread-1 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m20:22:35.576025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:22:35.584024 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m20:22:35.587025 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m20:22:35.588027 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m20:22:35.588027 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m20:22:35.589029 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN' was properly closed.
[0m20:22:35.590028 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m20:22:35.591028 [info ] [MainThread]: 
[0m20:22:35.592029 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 15.17 seconds (15.17s).
[0m20:22:35.594028 [debug] [MainThread]: Command end result
[0m20:22:35.601030 [info ] [MainThread]: 
[0m20:22:35.602029 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:22:35.603029 [info ] [MainThread]: 
[0m20:22:35.605027 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m20:22:35.606028 [debug] [MainThread]: Command `dbt run` succeeded at 20:22:35.606028 after 18.03 seconds
[0m20:22:35.607026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180107ACED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001800BD3FE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001800BD3F150>]}
[0m20:22:35.608028 [debug] [MainThread]: Flushing usage events
[0m20:22:36.452429 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:25:06.641862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2F3944E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2F39742D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2F3466B50>]}


============================== 20:25:06.641862 | 9c5a927a-9e75-4412-90a3-93e9972c8bed ==============================
[0m20:25:06.641862 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:25:06.657506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:25:06.952725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c5a927a-9e75-4412-90a3-93e9972c8bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2F3934CD0>]}
[0m20:25:06.968367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c5a927a-9e75-4412-90a3-93e9972c8bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2F4A83910>]}
[0m20:25:06.968367 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:25:07.009564 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:25:07.089566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:25:07.090567 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:25:07.099578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c5a927a-9e75-4412-90a3-93e9972c8bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2F4A8E550>]}
[0m20:25:07.101566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c5a927a-9e75-4412-90a3-93e9972c8bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2F4B7B990>]}
[0m20:25:07.101566 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m20:25:07.104566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c5a927a-9e75-4412-90a3-93e9972c8bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2F3D4B250>]}
[0m20:25:07.106570 [info ] [MainThread]: 
[0m20:25:07.107565 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:25:07.109566 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m20:25:07.135564 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m20:25:07.135564 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m20:25:07.136565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:09.082666 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m20:25:09.098303 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m20:25:09.583101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c5a927a-9e75-4412-90a3-93e9972c8bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2F3D4B250>]}
[0m20:25:09.583101 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:25:09.598737 [info ] [MainThread]: 
[0m20:25:09.617112 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:25:09.621113 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:25:09.624113 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m20:25:09.624113 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:25:09.625114 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:25:09.626114 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m20:25:09.626114 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:25:09.627113 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m20:25:09.628112 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m20:25:09.629113 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:25:09.633112 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:25:09.634112 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:25:09.635115 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:25:09.640116 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:25:09.648112 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:25:09.656115 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:25:09.657115 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 20:25:09.629113 => 20:25:09.657115
[0m20:25:09.659115 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:25:09.636113 => 20:25:09.658115
[0m20:25:09.660113 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 20:25:09.641117 => 20:25:09.659115
[0m20:25:09.660113 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:25:09.661116 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 20:25:09.653112 => 20:25:09.661116
[0m20:25:09.662116 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:25:09.663115 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:25:09.663115 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 20:25:09.663115 => 20:25:09.663115
[0m20:25:09.664117 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:25:09.665117 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:25:09.665117 => 20:25:09.665117
[0m20:25:09.666114 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 20:25:09.666114 => 20:25:09.666114
[0m20:25:09.667113 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:25:09.672115 [debug] [Thread-1 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:25:09.670115 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:25:09.671115 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:25:09.668116 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 20:25:09.668116 => 20:25:09.668116
[0m20:25:09.673116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m20:25:09.674116 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m20:25:09.683114 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:25:09.683114 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:25:09.685117 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_first_dbt_model)
[0m20:25:09.688113 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:25:09.689115 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m20:25:09.692112 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m20:25:09.692112 [debug] [Thread-1 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:25:09.685117 => 20:25:09.692112
[0m20:25:09.693115 [debug] [Thread-1 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:25:09.694112 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 20:25:09.690115 => 20:25:09.694112
[0m20:25:09.695114 [debug] [Thread-1 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:25:09.694112 => 20:25:09.694112
[0m20:25:09.695114 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m20:25:09.697115 [debug] [Thread-1 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:25:09.698115 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 20:25:09.697115 => 20:25:09.697115
[0m20:25:09.699114 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m20:25:09.700118 [debug] [Thread-3 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m20:25:09.701114 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN, now model.dbt_poc.my_second_dbt_model)
[0m20:25:09.702118 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m20:25:09.706119 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m20:25:09.714115 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 20:25:09.702118 => 20:25:09.714115
[0m20:25:09.715116 [debug] [Thread-3 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m20:25:09.716116 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 20:25:09.716116 => 20:25:09.716116
[0m20:25:09.717117 [debug] [Thread-3 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m20:25:09.718114 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:09.719116 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m20:25:09.719116 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m20:25:09.720113 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m20:25:09.720113 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m20:25:09.721113 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM' was properly closed.
[0m20:25:09.723112 [debug] [MainThread]: Command end result
[0m20:25:09.875762 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m20:25:09.875762 [info ] [MainThread]: Building catalog
[0m20:25:09.885072 [debug] [ThreadPool]: Acquiring new snowflake connection 'COMMEX_DB.information_schema'
[0m20:25:09.886073 [debug] [ThreadPool]: Acquiring new snowflake connection 'DEV_COMX_GLOBAL.information_schema'
[0m20:25:09.908071 [debug] [ThreadPool]: Using snowflake connection "COMMEX_DB.information_schema"
[0m20:25:09.908071 [debug] [ThreadPool]: Acquiring new snowflake connection 'PACVUE_KENVUE.information_schema'
[0m20:25:09.911068 [debug] [ThreadPool]: Using snowflake connection "DEV_COMX_GLOBAL.information_schema"
[0m20:25:09.912068 [debug] [ThreadPool]: On COMMEX_DB.information_schema: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "COMMEX_DB.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from COMMEX_DB.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from COMMEX_DB.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('digital_shelf') or upper("table_schema") = upper('digital_shelf_dbt'))
      order by "column_index"
[0m20:25:09.916072 [debug] [ThreadPool]: Using snowflake connection "PACVUE_KENVUE.information_schema"
[0m20:25:09.917071 [debug] [ThreadPool]: On DEV_COMX_GLOBAL.information_schema: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "DEV_COMX_GLOBAL.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from DEV_COMX_GLOBAL.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from DEV_COMX_GLOBAL.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('retmedia_integration'))
      order by "column_index"
[0m20:25:09.917071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:09.918068 [debug] [ThreadPool]: On PACVUE_KENVUE.information_schema: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "PACVUE_KENVUE.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from PACVUE_KENVUE.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from PACVUE_KENVUE.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('kenvue'))
      order by "column_index"
[0m20:25:09.919071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:09.921069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:14.300263 [debug] [ThreadPool]: SQL status: SUCCESS 430 in 4.0 seconds
[0m20:25:14.458596 [debug] [ThreadPool]: SQL status: SUCCESS 685 in 5.0 seconds
[0m20:25:14.594960 [debug] [ThreadPool]: SQL status: SUCCESS 1837 in 5.0 seconds
[0m20:25:16.938108 [debug] [ThreadPool]: On COMMEX_DB.information_schema: Close
[0m20:25:17.183110 [debug] [ThreadPool]: On DEV_COMX_GLOBAL.information_schema: Close
[0m20:25:17.661487 [debug] [ThreadPool]: On PACVUE_KENVUE.information_schema: Close
[0m20:25:18.598424 [info ] [MainThread]: Catalog written to C:\Users\SNando01\DBT_POC\target\catalog.json
[0m20:25:18.611357 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:25:18.610354 after 12.22 seconds
[0m20:25:18.611357 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:25:18.612355 [debug] [MainThread]: Connection 'COMMEX_DB.information_schema' was properly closed.
[0m20:25:18.613353 [debug] [MainThread]: Connection 'DEV_COMX_GLOBAL.information_schema' was properly closed.
[0m20:25:18.613353 [debug] [MainThread]: Connection 'PACVUE_KENVUE.information_schema' was properly closed.
[0m20:25:18.621352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2F3945E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2F4B49090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2EE53F210>]}
[0m20:25:18.622354 [debug] [MainThread]: Flushing usage events
[0m20:25:19.487403 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:54:46.332350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B22D35EA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B22CE5AC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B22CEF3490>]}


============================== 18:54:46.336355 | 48be1b2e-c2b1-4f65-820f-9f0c85362f99 ==============================
[0m18:54:46.336355 [info ] [MainThread]: Running with dbt=1.5.2
[0m18:54:46.338347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:54:48.266746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48be1b2e-c2b1-4f65-820f-9f0c85362f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B22CF0FF90>]}
[0m18:54:48.279742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48be1b2e-c2b1-4f65-820f-9f0c85362f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B22E44CB50>]}
[0m18:54:48.285759 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m18:54:48.321749 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m18:54:48.934761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:54:48.934761 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m18:54:48.935764 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m18:54:48.958753 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m18:54:48.976746 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m18:54:48.979753 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m18:54:48.984753 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m18:54:48.995754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48be1b2e-c2b1-4f65-820f-9f0c85362f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B22E469B50>]}
[0m18:54:49.003755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48be1b2e-c2b1-4f65-820f-9f0c85362f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B22E5D7B90>]}
[0m18:54:49.004760 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:54:49.005754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48be1b2e-c2b1-4f65-820f-9f0c85362f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B229012B50>]}
[0m18:54:49.008748 [info ] [MainThread]: 
[0m18:54:49.013759 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:54:49.034755 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m18:54:49.063750 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m18:54:49.064746 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m18:54:49.065750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:53.568070 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 5.0 seconds
[0m18:54:53.570074 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m18:54:54.048510 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m18:54:54.055506 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m18:54:54.055506 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m18:54:54.056508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:55.651276 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m18:54:55.654280 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m18:54:56.134431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48be1b2e-c2b1-4f65-820f-9f0c85362f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B22EC7B6D0>]}
[0m18:54:56.135434 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:54:56.136435 [info ] [MainThread]: 
[0m18:54:56.166443 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m18:54:56.167439 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m18:54:56.167439 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m18:54:56.168439 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m18:54:56.168439 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m18:54:56.169439 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m18:54:56.171437 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m18:54:56.172437 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m18:54:56.174437 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m18:54:56.175443 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m18:54:56.176447 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m18:54:56.177437 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m18:54:56.178438 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m18:54:56.179451 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m18:54:56.180437 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m18:54:56.180437 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m18:54:56.184435 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m18:54:56.189444 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m18:54:56.341434 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m18:54:56.344430 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m18:54:56.346437 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 18:54:56.181439 => 18:54:56.346437
[0m18:54:56.347447 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 18:54:56.184435 => 18:54:56.347447
[0m18:54:56.348445 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 18:54:56.205435 => 18:54:56.348445
[0m18:54:56.352439 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m18:54:56.349445 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m18:54:56.351441 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m18:54:56.350440 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 18:54:56.190444 => 18:54:56.349445
[0m18:54:56.389448 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m18:54:56.399437 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m18:54:56.401430 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m18:54:56.402430 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m18:54:56.403450 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m18:54:56.404445 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m18:54:56.405439 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m18:54:56.409446 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m18:54:56.410436 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:54:56.411441 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:54:56.411441 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join   COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m18:54:56.412445 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m18:54:56.417443 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:54:56.418435 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:54:58.611198 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:54:58.627202 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m18:54:58.633200 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m18:54:58.634200 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_CAMPAIGN  a
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  b
on a.tag_id = b.id
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m18:54:58.674194 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:54:58.676204 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m18:54:58.678198 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m18:54:58.679199 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)



select *
from final
        );
[0m18:54:58.713198 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:54:58.715203 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m18:54:58.718206 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m18:54:58.719197 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
        );
[0m18:54:58.782384 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:54:58.806388 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 18:54:56.352439 => 18:54:58.806388
[0m18:54:58.807391 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m18:54:59.332798 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48be1b2e-c2b1-4f65-820f-9f0c85362f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B22EE07A50>]}
[0m18:54:59.333797 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 3.16s]
[0m18:54:59.335802 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m18:54:59.336801 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m18:54:59.337800 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m18:54:59.339805 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m18:54:59.339805 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m18:54:59.344804 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m18:54:59.345798 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 18:54:59.340809 => 18:54:59.345798
[0m18:54:59.346808 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m18:54:59.353806 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m18:54:59.357806 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m18:54:59.358808 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m18:54:59.359809 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:55:00.076019 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:55:00.080010 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 18:54:56.389448 => 18:55:00.080010
[0m18:55:00.081020 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m18:55:00.353093 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:55:00.357100 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 18:54:56.399437 => 18:55:00.356091
[0m18:55:00.358102 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m18:55:00.598415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48be1b2e-c2b1-4f65-820f-9f0c85362f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B22EDF4850>]}
[0m18:55:00.599398 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.42s]
[0m18:55:00.601400 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m18:55:00.602400 [debug] [Thread-1 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m18:55:00.603398 [info ] [Thread-1 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m18:55:00.605401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM, now model.dbt_poc.my_first_dbt_model)
[0m18:55:00.605401 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m18:55:00.610394 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m18:55:00.614395 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 18:55:00.606404 => 18:55:00.614395
[0m18:55:00.627405 [debug] [Thread-1 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m18:55:00.634407 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m18:55:00.637399 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m18:55:00.657398 [debug] [Thread-1 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m18:55:00.659400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:00.862398 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48be1b2e-c2b1-4f65-820f-9f0c85362f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B22E5F41D0>]}
[0m18:55:00.864403 [info ] [Thread-2 (]: 2 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 4.69s]
[0m18:55:00.865402 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m18:55:01.244320 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:55:01.248323 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 18:54:59.347805 => 18:55:01.247318
[0m18:55:01.248323 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m18:55:01.458617 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m18:55:01.462621 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 18:54:56.406446 => 18:55:01.462621
[0m18:55:01.463626 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m18:55:01.763657 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48be1b2e-c2b1-4f65-820f-9f0c85362f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B22EFB6A50>]}
[0m18:55:01.764655 [info ] [Thread-4 (]: 5 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.42s]
[0m18:55:01.767150 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m18:55:01.969498 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48be1b2e-c2b1-4f65-820f-9f0c85362f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B22EFB65D0>]}
[0m18:55:01.970494 [info ] [Thread-3 (]: 3 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[32mSUCCESS 1[0m in 5.79s]
[0m18:55:01.972505 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m18:55:02.726996 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:55:02.729994 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 18:55:00.628403 => 18:55:02.729994
[0m18:55:02.730994 [debug] [Thread-1 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m18:55:03.209615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48be1b2e-c2b1-4f65-820f-9f0c85362f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B22EE07250>]}
[0m18:55:03.210614 [info ] [Thread-1 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 2.60s]
[0m18:55:03.212215 [debug] [Thread-1 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m18:55:03.213204 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m18:55:03.214208 [info ] [Thread-2 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m18:55:03.219203 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_second_dbt_model)
[0m18:55:03.228205 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m18:55:03.241213 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m18:55:03.243215 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 18:55:03.237206 => 18:55:03.242213
[0m18:55:03.243215 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m18:55:03.269203 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m18:55:03.272222 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m18:55:03.273207 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m18:55:03.274205 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:55:05.252585 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:55:05.256592 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 18:55:03.244215 => 18:55:05.255580
[0m18:55:05.257615 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m18:55:05.748719 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48be1b2e-c2b1-4f65-820f-9f0c85362f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B22D99FD50>]}
[0m18:55:05.749717 [info ] [Thread-2 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.53s]
[0m18:55:05.751733 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m18:55:05.754723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:05.759722 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m18:55:05.764722 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m18:55:05.772722 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m18:55:05.779725 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m18:55:05.779725 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN' was properly closed.
[0m18:55:05.781724 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m18:55:05.782730 [info ] [MainThread]: 
[0m18:55:05.783732 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 16.77 seconds (16.77s).
[0m18:55:05.786734 [debug] [MainThread]: Command end result
[0m18:55:05.832722 [info ] [MainThread]: 
[0m18:55:05.842721 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:55:05.843723 [info ] [MainThread]: 
[0m18:55:05.845731 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:55:05.847727 [debug] [MainThread]: Command `dbt run` succeeded at 18:55:05.847727 after 19.82 seconds
[0m18:55:05.848730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B22D28C150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B22CEDAB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B227EFA210>]}
[0m18:55:05.849731 [debug] [MainThread]: Flushing usage events
[0m18:55:06.822773 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:18:54.775077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203DE0516D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203DDC06F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203DE0431D0>]}


============================== 18:18:54.793083 | fe0f6672-6afb-480e-8bbc-7531929c4c01 ==============================
[0m18:18:54.793083 [info ] [MainThread]: Running with dbt=1.5.2
[0m18:18:54.795096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:18:54.796092 [info ] [MainThread]: dbt version: 1.5.2
[0m18:18:54.797088 [info ] [MainThread]: python version: 3.11.4
[0m18:18:54.798081 [info ] [MainThread]: python path: C:\Users\SNando01\dbt-venv\Scripts\python.exe
[0m18:18:54.799084 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m18:18:54.800079 [info ] [MainThread]: Using profiles.yml file at C:\Users\SNando01\.dbt\profiles.yml
[0m18:18:54.802077 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SNando01\DBT_POC\dbt_project.yml
[0m18:18:54.804082 [info ] [MainThread]: Configuration:
[0m18:19:02.482107 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:19:02.539105 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:19:02.542102 [info ] [MainThread]: Required dependencies:
[0m18:19:02.543100 [debug] [MainThread]: Executing "git --help"
[0m18:19:03.164104 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:19:03.165108 [debug] [MainThread]: STDERR: "b''"
[0m18:19:03.166111 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:19:03.168105 [info ] [MainThread]: Connection:
[0m18:19:03.169102 [info ] [MainThread]:   account: bk40750.east-us-2.azure
[0m18:19:03.171111 [info ] [MainThread]:   user: MHennes3
[0m18:19:03.172117 [info ] [MainThread]:   database: COMMEX_DB
[0m18:19:03.174100 [info ] [MainThread]:   schema: DIGITAL_SHELF_DBT
[0m18:19:03.176104 [info ] [MainThread]:   warehouse: DEV_COMX_GLOBAL_APP1_WH
[0m18:19:03.177101 [info ] [MainThread]:   role: DEV_COMX_GLOBAL_DEVELOPER_FR
[0m18:19:03.179110 [info ] [MainThread]:   client_session_keep_alive: False
[0m18:19:03.187111 [info ] [MainThread]:   query_tag: None
[0m18:19:03.200103 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m18:19:03.202103 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m18:19:03.204108 [debug] [MainThread]: Using snowflake connection "debug"
[0m18:19:03.204108 [debug] [MainThread]: On debug: select 1 as id
[0m18:19:03.205110 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:19:11.394117 [debug] [MainThread]: SQL status: SUCCESS 1 in 8.0 seconds
[0m18:19:11.395116 [debug] [MainThread]: On debug: Close
[0m18:19:11.901122 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:19:11.903129 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:19:11.905129 [debug] [MainThread]: Command `dbt debug` succeeded at 18:19:11.905129 after 17.63 seconds
[0m18:19:11.906132 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:19:11.906132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203DE0E0450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203DE074150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203E502A610>]}
[0m18:19:11.907129 [debug] [MainThread]: Flushing usage events
[0m18:19:12.831123 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:19:29.545164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9FC499D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9F48DAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9FD130D0>]}


============================== 18:19:29.551162 | 5e27ed55-9b35-4979-bb00-38226080c6f8 ==============================
[0m18:19:29.551162 [info ] [MainThread]: Running with dbt=1.5.2
[0m18:19:29.553178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:19:30.517172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e27ed55-9b35-4979-bb00-38226080c6f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9FC63490>]}
[0m18:19:30.538172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e27ed55-9b35-4979-bb00-38226080c6f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FA8A38990>]}
[0m18:19:30.540180 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m18:19:30.579174 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m18:19:32.862174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m18:19:32.863171 [debug] [MainThread]: Partial parsing: added file: dbt_poc://models\SQL_SCRIPTS\RBAC_DEV_DB.sql
[0m18:19:32.864170 [debug] [MainThread]: Partial parsing: added file: dbt_poc://macros\RBAC.sql
[0m18:19:32.872170 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected char '\\' at 39
    line 1
      {% macro get_sql_script_contents(models\sql_scripts\RBAC_DEV_DB.sql) %}
[0m18:19:32.875183 [debug] [MainThread]: Command `dbt run` failed at 18:19:32.875183 after 3.68 seconds
[0m18:19:32.876186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9FC63A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9A83FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FA8B03650>]}
[0m18:19:32.883177 [debug] [MainThread]: Flushing usage events
[0m18:19:32.960175 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:29:18.129750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022582166590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022582A59CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022582157290>]}


============================== 18:29:18.145748 | d1fdedbc-d580-4537-b62a-e8e3d45f3d1b ==============================
[0m18:29:18.145748 [info ] [MainThread]: Running with dbt=1.5.2
[0m18:29:18.146746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:29:25.564140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1fdedbc-d580-4537-b62a-e8e3d45f3d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225830CA090>]}
[0m18:29:25.584148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1fdedbc-d580-4537-b62a-e8e3d45f3d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002258B445BD0>]}
[0m18:29:25.593143 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m18:29:25.646156 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m18:29:26.562142 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m18:29:26.563143 [debug] [MainThread]: Partial parsing: added file: dbt_poc://macros\RBAC.sql
[0m18:29:26.563143 [debug] [MainThread]: Partial parsing: added file: dbt_poc://models\SQL_SCRIPTS\RBAC_DEV_DB.sql
[0m18:29:26.564151 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected string, got ", 'models\SQL_SCRIPTS\' ~ RBAC_DEV_DB.sql) }}
  {% endmacro %}"
[0m18:29:26.567155 [debug] [MainThread]: Command `dbt run` failed at 18:29:26.567155 after 8.92 seconds
[0m18:29:26.568153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022582628350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022582C74D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022582164150>]}
[0m18:29:26.572144 [debug] [MainThread]: Flushing usage events
[0m18:29:27.429156 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:30:31.442625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230520D96D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023051B556D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023052116510>]}


============================== 18:30:31.448621 | b430c14c-a66a-4a82-b067-dc6fe9570c5c ==============================
[0m18:30:31.448621 [info ] [MainThread]: Running with dbt=1.5.2
[0m18:30:31.485633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:30:32.729625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b430c14c-a66a-4a82-b067-dc6fe9570c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230525F7AD0>]}
[0m18:30:32.751631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b430c14c-a66a-4a82-b067-dc6fe9570c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002305AE5FC50>]}
[0m18:30:32.752638 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m18:30:32.790638 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m18:30:32.928632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m18:30:32.931629 [debug] [MainThread]: Partial parsing: added file: dbt_poc://macros\RBAC.sql
[0m18:30:32.932634 [debug] [MainThread]: Partial parsing: added file: dbt_poc://models\SQL_SCRIPTS\RBAC_DEV_DB.sql
[0m18:30:32.933625 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected string, got ", 'models\SQL_SCRIPTS\'  RBAC_DEV_DB.sql) }}
  {% endmacro %}"
[0m18:30:32.936635 [debug] [MainThread]: Command `dbt run` failed at 18:30:32.936635 after 1.93 seconds
[0m18:30:32.937640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023052074150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023051BF7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002304D07BED0>]}
[0m18:30:32.938635 [debug] [MainThread]: Flushing usage events
[0m18:30:33.100635 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:08:49.888700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146FCD96D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146FC37C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146F801850>]}


============================== 19:08:49.901712 | 9bbc5db3-f81d-43b0-b4f8-2877c746b46c ==============================
[0m19:08:49.901712 [info ] [MainThread]: Running with dbt=1.5.2
[0m19:08:49.903707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:08:56.823058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bbc5db3-f81d-43b0-b4f8-2877c746b46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021470332090>]}
[0m19:08:56.845058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bbc5db3-f81d-43b0-b4f8-2877c746b46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214704FAB10>]}
[0m19:08:56.855055 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m19:08:56.894058 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m19:08:57.646626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m19:08:57.646626 [debug] [MainThread]: Partial parsing: added file: dbt_poc://macros\RBAC.sql
[0m19:08:57.647626 [debug] [MainThread]: Partial parsing: added file: dbt_poc://models\SQL_SCRIPTS\RBAC_DEV_DB.sql
[0m19:08:57.648626 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected string, got ", 'models\SQL_SCRIPTS\'  RBAC_DEV_DB.sql) }}
  --{% endmacro %}"
[0m19:08:57.652638 [debug] [MainThread]: Command `dbt run` failed at 19:08:57.651642 after 8.22 seconds
[0m19:08:57.653630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146F801850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021470296710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146FCD9E10>]}
[0m19:08:57.656640 [debug] [MainThread]: Flushing usage events
[0m19:08:58.546639 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:51:49.151955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025600F4F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025600F36E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256015763D0>]}


============================== 19:51:49.168950 | f123fec1-0690-49d0-9ae8-0089ab454b39 ==============================
[0m19:51:49.168950 [info ] [MainThread]: Running with dbt=1.5.2
[0m19:51:49.169957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:51:56.624095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f123fec1-0690-49d0-9ae8-0089ab454b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025601574490>]}
[0m19:51:56.637096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f123fec1-0690-49d0-9ae8-0089ab454b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025609D2CCD0>]}
[0m19:51:56.646085 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m19:51:56.683085 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m19:51:56.708086 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:51:56.710108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f123fec1-0690-49d0-9ae8-0089ab454b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025609E46350>]}
[0m19:51:57.512222 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected string, got ", 'models\SQL_SCRIPTS\'  RBAC_DEV_DB.sql) }}
  --{% endmacro %}"
[0m19:51:57.516228 [debug] [MainThread]: Command `dbt run` failed at 19:51:57.516228 after 8.82 seconds
[0m19:51:57.517222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025600ADDB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025601575310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025600AF1350>]}
[0m19:51:57.518236 [debug] [MainThread]: Flushing usage events
[0m19:51:58.481785 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:53:36.293527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E8160296D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E8159666D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E81606DB50>]}


============================== 19:53:36.299515 | d19c59e0-ff26-4fbd-9ce8-f236610d490b ==============================
[0m19:53:36.299515 [info ] [MainThread]: Running with dbt=1.5.2
[0m19:53:36.301522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:53:37.311792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd19c59e0-ff26-4fbd-9ce8-f236610d490b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E81EC560D0>]}
[0m19:53:37.323801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd19c59e0-ff26-4fbd-9ce8-f236610d490b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E81EC45BD0>]}
[0m19:53:37.325805 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m19:53:37.354656 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m19:53:37.369655 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:53:37.378664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd19c59e0-ff26-4fbd-9ce8-f236610d490b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E81EBBA0D0>]}
[0m19:53:38.336597 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m19:53:38.358588 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m19:53:38.364597 [debug] [MainThread]: 1699: static parser successfully parsed External_tables\NADL_CORE_IMS_FLU.sql
[0m19:53:38.371595 [debug] [MainThread]: 1699: static parser successfully parsed L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m19:53:38.376593 [debug] [MainThread]: 1699: static parser successfully parsed L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:53:38.387590 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m19:53:38.393590 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m19:53:38.408594 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:53:38.419597 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:53:38.433597 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m19:53:38.444591 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m19:53:38.448590 [debug] [MainThread]: 1699: static parser successfully parsed SQL_SCRIPTS\RBAC_DEV_DB.sql
[0m19:53:38.540603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd19c59e0-ff26-4fbd-9ce8-f236610d490b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E81EC55510>]}
[0m19:53:38.554594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd19c59e0-ff26-4fbd-9ce8-f236610d490b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E81EDB9BD0>]}
[0m19:53:38.555597 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m19:53:38.570601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd19c59e0-ff26-4fbd-9ce8-f236610d490b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E811C12990>]}
[0m19:53:38.573604 [info ] [MainThread]: 
[0m19:53:38.595601 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:53:38.611604 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m19:53:38.638597 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m19:53:38.639602 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m19:53:38.640607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:41.748147 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m19:53:41.751158 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m19:53:42.294146 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m19:53:42.305160 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m19:53:42.306162 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m19:53:42.306162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:44.313272 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m19:53:44.315269 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m19:53:44.812270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd19c59e0-ff26-4fbd-9ce8-f236610d490b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E811C12850>]}
[0m19:53:44.814273 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:53:44.815278 [info ] [MainThread]: 
[0m19:53:44.903269 [debug] [Thread-1 (]: Began running node model.dbt_poc.NADL_CORE_IMS_FLU
[0m19:53:44.904270 [debug] [Thread-2 (]: Began running node model.dbt_poc.RBAC_DEV_DB
[0m19:53:44.905276 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:53:44.905276 [debug] [Thread-4 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:53:44.906272 [info ] [Thread-1 (]: 1 of 9 START sql view model DIGITAL_SHELF_DBT.NADL_CORE_IMS_FLU ................ [RUN]
[0m19:53:44.917279 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.NADL_CORE_IMS_FLU'
[0m19:53:44.918282 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.NADL_CORE_IMS_FLU
[0m19:53:44.921278 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.NADL_CORE_IMS_FLU"
[0m19:53:44.923277 [debug] [Thread-1 (]: Timing info for model.dbt_poc.NADL_CORE_IMS_FLU (compile): 19:53:44.918282 => 19:53:44.923277
[0m19:53:44.924283 [debug] [Thread-1 (]: Began executing node model.dbt_poc.NADL_CORE_IMS_FLU
[0m19:53:44.988270 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.NADL_CORE_IMS_FLU"
[0m19:53:44.993271 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.NADL_CORE_IMS_FLU"
[0m19:53:44.994271 [debug] [Thread-1 (]: On model.dbt_poc.NADL_CORE_IMS_FLU: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.NADL_CORE_IMS_FLU"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.NADL_CORE_IMS_FLU
  
   as (
    create or replace external table DEV_COMX_GLOBAL.DIGSHELF_RAW.NADL_CORE_IMS_FLU
(

recordid integer as (value:c1::int),
week_end date as (value:c2::date),
age_group varchar(50) as (value:c3::varchar),
division varchar(50) as (value:c4::varchar),
market varchar(50) as (value:c5::varchar),
tot_populatn integer as (value:c6::int),
afct_wk integer as (value:c7::int),
afct_wk_prcnt numeric(10,2) as (value:c8::numeric),
afct_wk_vs_lstwk_prcnt numeric(10,2) as (value:c9::numeric),
afct_wk_vs_lstseason_prcnt numeric(10,2) as (value:c10::numeric),
afct_season_vs_lstseason_prcnt numeric(10,2) as (value:c11::numeric),
afct_yr_vs_lstyr_prcnt numeric(10,2) as (value:c12::numeric),
overall_market_status varchar(50) as (value:c13::varchar),
no_of_weeks_on_status integer as (value:c14::int),
symptom varchar(100) as (value:c15::varchar),
month_id varchar(6) as (value:c16::varchar),
currentlyprocessedfilename varchar(255) as (value:c17::varchar),
sor_dtm timestamp as (value:c18::timestamp)

)
with location = @DEV_COMX_GLOBAL.DIGSHELF_RAW.NADL_DATA_LOAD/core_ims_flu.csv*
file_format = DEV_COMX_GLOBAL.DIGSHELF_RAW.COMX_EXT_FILE_FORMAT_REF_TIME_DIM
REFRESH_ON_CREATE=TRUE
AUTO_REFRESH=TRUE
  );
[0m19:53:44.995270 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:53:44.907285 [info ] [Thread-2 (]: 2 of 9 START sql view model DIGITAL_SHELF_DBT.RBAC_DEV_DB ...................... [RUN]
[0m19:53:44.908279 [info ] [Thread-3 (]: 3 of 9 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m19:53:44.912275 [info ] [Thread-4 (]: 4 of 9 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m19:53:45.012275 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m19:53:45.011276 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.RBAC_DEV_DB'
[0m19:53:45.013282 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m19:53:45.016280 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:53:45.014285 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:53:45.015281 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.RBAC_DEV_DB
[0m19:53:45.021272 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:53:45.026273 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m19:53:45.033285 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 19:53:45.022272 => 19:53:45.032286
[0m19:53:45.030276 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.RBAC_DEV_DB"
[0m19:53:45.033285 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:53:45.048272 [debug] [Thread-4 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 19:53:45.017280 => 19:53:45.048272
[0m19:53:45.057284 [debug] [Thread-4 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:53:45.063280 [debug] [Thread-2 (]: Timing info for model.dbt_poc.RBAC_DEV_DB (compile): 19:53:45.027272 => 19:53:45.063280
[0m19:53:45.064283 [debug] [Thread-2 (]: Began executing node model.dbt_poc.RBAC_DEV_DB
[0m19:53:45.070283 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.RBAC_DEV_DB"
[0m19:53:45.138274 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.RBAC_DEV_DB"
[0m19:53:45.139275 [debug] [Thread-2 (]: On model.dbt_poc.RBAC_DEV_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.RBAC_DEV_DB"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.RBAC_DEV_DB
  
   as (
    CREATE ROLE IF NOT EXISTS "SF_COMMEX_DB_D_DIGITAL_SHELF_FULL";
[0m19:53:45.145284 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 19:53:45.035279 => 19:53:45.144285
[0m19:53:45.146279 [debug] [Thread-4 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 19:53:45.058278 => 19:53:45.145284
[0m19:53:45.147284 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:53:45.619273 [debug] [Thread-3 (]: Compilation Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql)
  'dbt.context.providers.RuntimeDatabaseWrapper object' has no attribute 'execute_file'
  
  > in macro run_hooks (macros\materializations\hooks.sql)
  > called by macro materialization_table_snowflake (macros\materializations\table.sql)
  > called by model TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql). This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:53:45.620287 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd19c59e0-ff26-4fbd-9ce8-f236610d490b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E81F64D490>]}
[0m19:53:45.652272 [debug] [Thread-4 (]: Compilation Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql)
  'dbt.context.providers.RuntimeDatabaseWrapper object' has no attribute 'execute_file'
  
  > in macro run_hooks (macros\materializations\hooks.sql)
  > called by macro materialization_table_snowflake (macros\materializations\table.sql)
  > called by model TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql). This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:53:45.653297 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd19c59e0-ff26-4fbd-9ce8-f236610d490b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E81F6804D0>]}
[0m19:53:45.621273 [error] [Thread-3 (]: 3 of 9 ERROR creating sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[31mERROR[0m in 0.61s]
[0m19:53:45.654275 [error] [Thread-4 (]: 4 of 9 ERROR creating sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[31mERROR[0m in 0.64s]
[0m19:53:45.699278 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:53:45.700285 [debug] [Thread-4 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:53:45.701275 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:53:45.702275 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:53:45.704275 [info ] [Thread-3 (]: 5 of 9 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m19:53:45.706283 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM, now model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN)
[0m19:53:45.705280 [info ] [Thread-4 (]: 6 of 9 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m19:53:45.707286 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:53:45.708278 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM)
[0m19:53:45.715280 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m19:53:45.716274 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:53:45.721288 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m19:53:45.722283 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 19:53:45.709285 => 19:53:45.722283
[0m19:53:45.723279 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:53:45.736281 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 19:53:45.728276 => 19:53:45.735280
[0m19:53:45.795277 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 19:53:45.717282 => 19:53:45.794280
[0m19:53:45.796280 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:53:45.804286 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m19:53:45.807283 [debug] [Thread-3 (]: Compilation Error in model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql)
  'dbt.context.providers.RuntimeDatabaseWrapper object' has no attribute 'execute_file'
  
  > in macro run_hooks (macros\materializations\hooks.sql)
  > called by macro materialization_table_snowflake (macros\materializations\table.sql)
  > called by model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql). This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:53:45.809283 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m19:53:45.810275 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd19c59e0-ff26-4fbd-9ce8-f236610d490b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E81FA5F690>]}
[0m19:53:45.810275 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join   COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m19:53:45.813284 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:53:45.812281 [error] [Thread-3 (]: 5 of 9 ERROR creating sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[31mERROR[0m in 0.10s]
[0m19:53:45.819276 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:53:45.988839 [debug] [Thread-3 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:53:45.989831 [info ] [Thread-3 (]: 7 of 9 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m19:53:45.991841 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m19:53:45.992842 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:53:46.097948 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:53:46.099948 [debug] [Thread-3 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 19:53:46.091952 => 19:53:46.099948
[0m19:53:46.100951 [debug] [Thread-3 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:53:46.105948 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:53:46.108945 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:53:46.109945 [debug] [Thread-3 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m19:53:46.110945 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:53:47.929062 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01adc6bf-0c04-c90f-0002-a6560102ec4a
[0m19:53:47.931067 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 4 unexpected 'create'.
syntax error line 7 at position 35 unexpected ','.
[0m19:53:47.932059 [debug] [Thread-1 (]: Timing info for model.dbt_poc.NADL_CORE_IMS_FLU (execute): 19:53:44.925284 => 19:53:47.931067
[0m19:53:47.933059 [debug] [Thread-1 (]: On model.dbt_poc.NADL_CORE_IMS_FLU: Close
[0m19:53:47.938059 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01adc6bf-0c04-c90f-0002-a6560102ec4e
[0m19:53:47.939065 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 4 unexpected 'CREATE'.
[0m19:53:47.941061 [debug] [Thread-2 (]: Timing info for model.dbt_poc.RBAC_DEV_DB (execute): 19:53:45.065280 => 19:53:47.940062
[0m19:53:47.942058 [debug] [Thread-2 (]: On model.dbt_poc.RBAC_DEV_DB: Close
[0m19:53:48.439056 [debug] [Thread-1 (]: Database Error in model NADL_CORE_IMS_FLU (models\External_tables\NADL_CORE_IMS_FLU.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected 'create'.
  syntax error line 7 at position 35 unexpected ','.
  compiled Code at target\run\dbt_poc\models\External_tables\NADL_CORE_IMS_FLU.sql
[0m19:53:48.440054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd19c59e0-ff26-4fbd-9ce8-f236610d490b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E81ED528D0>]}
[0m19:53:48.441055 [error] [Thread-1 (]: 1 of 9 ERROR creating sql view model DIGITAL_SHELF_DBT.NADL_CORE_IMS_FLU ....... [[31mERROR[0m in 3.52s]
[0m19:53:48.442059 [debug] [Thread-1 (]: Finished running node model.dbt_poc.NADL_CORE_IMS_FLU
[0m19:53:48.443066 [debug] [Thread-1 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m19:53:48.444064 [info ] [Thread-1 (]: 8 of 9 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m19:53:48.446064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.NADL_CORE_IMS_FLU, now model.dbt_poc.my_first_dbt_model)
[0m19:53:48.447068 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m19:53:48.452062 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m19:53:48.454068 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 19:53:48.447068 => 19:53:48.454068
[0m19:53:48.455068 [debug] [Thread-1 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m19:53:48.489069 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m19:53:48.493061 [debug] [Thread-2 (]: Database Error in model RBAC_DEV_DB (models\SQL_SCRIPTS\RBAC_DEV_DB.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected 'CREATE'.
  compiled Code at target\run\dbt_poc\models\SQL_SCRIPTS\RBAC_DEV_DB.sql
[0m19:53:48.494062 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m19:53:48.495065 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd19c59e0-ff26-4fbd-9ce8-f236610d490b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E81FA4A410>]}
[0m19:53:48.496061 [debug] [Thread-1 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:53:48.498066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:48.497058 [error] [Thread-2 (]: 2 of 9 ERROR creating sql view model DIGITAL_SHELF_DBT.RBAC_DEV_DB ............. [[31mERROR[0m in 3.48s]
[0m19:53:48.502066 [debug] [Thread-2 (]: Finished running node model.dbt_poc.RBAC_DEV_DB
[0m19:53:48.630064 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:53:48.667069 [debug] [Thread-3 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 19:53:46.100951 => 19:53:48.666064
[0m19:53:48.668067 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:53:48.669065 [debug] [Thread-3 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m19:53:48.673064 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 19:53:45.796280 => 19:53:48.672063
[0m19:53:48.676060 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m19:53:49.168056 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd19c59e0-ff26-4fbd-9ce8-f236610d490b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E81EDC9E90>]}
[0m19:53:49.169056 [info ] [Thread-3 (]: 7 of 9 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 3.18s]
[0m19:53:49.171068 [debug] [Thread-3 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:53:49.187060 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd19c59e0-ff26-4fbd-9ce8-f236610d490b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E81ED535D0>]}
[0m19:53:49.188065 [info ] [Thread-4 (]: 6 of 9 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 3.48s]
[0m19:53:49.190079 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:53:51.263065 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:53:51.268060 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 19:53:48.458061 => 19:53:51.268060
[0m19:53:51.269060 [debug] [Thread-1 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m19:53:51.754063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd19c59e0-ff26-4fbd-9ce8-f236610d490b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E81DA1F350>]}
[0m19:53:51.755062 [info ] [Thread-1 (]: 8 of 9 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 3.31s]
[0m19:53:51.756069 [debug] [Thread-1 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m19:53:51.758069 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m19:53:51.759083 [info ] [Thread-2 (]: 9 of 9 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m19:53:51.772065 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.RBAC_DEV_DB, now model.dbt_poc.my_second_dbt_model)
[0m19:53:51.772065 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m19:53:51.777075 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m19:53:51.779069 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 19:53:51.773064 => 19:53:51.779069
[0m19:53:51.780076 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m19:53:51.800062 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m19:53:51.802062 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m19:53:51.803063 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m19:53:51.804069 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:53:53.939189 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:53:53.944189 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 19:53:51.781071 => 19:53:53.943184
[0m19:53:53.944189 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m19:53:54.447178 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd19c59e0-ff26-4fbd-9ce8-f236610d490b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E81FA498D0>]}
[0m19:53:54.448176 [info ] [Thread-2 (]: 9 of 9 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.68s]
[0m19:53:54.450190 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m19:53:54.455178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:54.457182 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m19:53:54.461181 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m19:53:54.462191 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m19:53:54.463188 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m19:53:54.463188 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m19:53:54.464191 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM' was properly closed.
[0m19:53:54.465190 [info ] [MainThread]: 
[0m19:53:54.466180 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 15.87 seconds (15.87s).
[0m19:53:54.469189 [debug] [MainThread]: Command end result
[0m19:53:54.487186 [info ] [MainThread]: 
[0m19:53:54.488188 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m19:53:54.489187 [info ] [MainThread]: 
[0m19:53:54.490188 [error] [MainThread]: [33mCompilation Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql)[0m
[0m19:53:54.492179 [error] [MainThread]:   'dbt.context.providers.RuntimeDatabaseWrapper object' has no attribute 'execute_file'
[0m19:53:54.493188 [error] [MainThread]:   
[0m19:53:54.494189 [error] [MainThread]:   > in macro run_hooks (macros\materializations\hooks.sql)
[0m19:53:54.495179 [error] [MainThread]:   > called by macro materialization_table_snowflake (macros\materializations\table.sql)
[0m19:53:54.497185 [error] [MainThread]:   > called by model TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql). This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:53:54.498184 [info ] [MainThread]: 
[0m19:53:54.518186 [error] [MainThread]: [33mCompilation Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql)[0m
[0m19:53:54.540176 [error] [MainThread]:   'dbt.context.providers.RuntimeDatabaseWrapper object' has no attribute 'execute_file'
[0m19:53:54.559186 [error] [MainThread]:   
[0m19:53:54.560185 [error] [MainThread]:   > in macro run_hooks (macros\materializations\hooks.sql)
[0m19:53:54.564197 [error] [MainThread]:   > called by macro materialization_table_snowflake (macros\materializations\table.sql)
[0m19:53:54.583191 [error] [MainThread]:   > called by model TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql). This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:53:54.611188 [info ] [MainThread]: 
[0m19:53:54.613187 [error] [MainThread]: [33mCompilation Error in model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql)[0m
[0m19:53:54.614184 [error] [MainThread]:   'dbt.context.providers.RuntimeDatabaseWrapper object' has no attribute 'execute_file'
[0m19:53:54.615191 [error] [MainThread]:   
[0m19:53:54.616191 [error] [MainThread]:   > in macro run_hooks (macros\materializations\hooks.sql)
[0m19:53:54.618187 [error] [MainThread]:   > called by macro materialization_table_snowflake (macros\materializations\table.sql)
[0m19:53:54.619190 [error] [MainThread]:   > called by model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql). This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:53:54.621186 [info ] [MainThread]: 
[0m19:53:54.622182 [error] [MainThread]: [33mDatabase Error in model NADL_CORE_IMS_FLU (models\External_tables\NADL_CORE_IMS_FLU.sql)[0m
[0m19:53:54.623183 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m19:53:54.624181 [error] [MainThread]:   syntax error line 4 at position 4 unexpected 'create'.
[0m19:53:54.626182 [error] [MainThread]:   syntax error line 7 at position 35 unexpected ','.
[0m19:53:54.630184 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\External_tables\NADL_CORE_IMS_FLU.sql
[0m19:53:54.649190 [info ] [MainThread]: 
[0m19:53:54.651189 [error] [MainThread]: [33mDatabase Error in model RBAC_DEV_DB (models\SQL_SCRIPTS\RBAC_DEV_DB.sql)[0m
[0m19:53:54.681185 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m19:53:54.682184 [error] [MainThread]:   syntax error line 4 at position 4 unexpected 'CREATE'.
[0m19:53:54.683181 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\SQL_SCRIPTS\RBAC_DEV_DB.sql
[0m19:53:54.685189 [info ] [MainThread]: 
[0m19:53:54.686186 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=5 SKIP=0 TOTAL=9
[0m19:53:54.688181 [debug] [MainThread]: Command `dbt run` failed at 19:53:54.688181 after 18.80 seconds
[0m19:53:54.689185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E8164A7D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E815956BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E816029550>]}
[0m19:53:54.691186 [debug] [MainThread]: Flushing usage events
[0m19:53:55.822191 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:58:25.604508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A13777750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A12C56DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A12CF6E90>]}


============================== 19:58:25.620500 | fe6d2481-bdd7-4e1d-bd19-abb91f196de1 ==============================
[0m19:58:25.620500 [info ] [MainThread]: Running with dbt=1.5.2
[0m19:58:25.622507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:58:32.170067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe6d2481-bdd7-4e1d-bd19-abb91f196de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1BF54150>]}
[0m19:58:32.189075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe6d2481-bdd7-4e1d-bd19-abb91f196de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1BF45BD0>]}
[0m19:58:32.197066 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m19:58:32.237076 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m19:58:32.264070 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:58:32.266071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fe6d2481-bdd7-4e1d-bd19-abb91f196de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1A423A10>]}
[0m19:58:33.838079 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m19:58:33.881082 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m19:58:33.901071 [debug] [MainThread]: 1699: static parser successfully parsed External_tables\NADL_CORE_IMS_FLU.sql
[0m19:58:33.929079 [debug] [MainThread]: 1699: static parser successfully parsed L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m19:58:33.946072 [debug] [MainThread]: 1699: static parser successfully parsed L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:58:33.972071 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m19:58:33.988078 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m19:58:34.002079 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:58:34.017073 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m19:58:34.025071 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m19:58:34.041081 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m19:58:34.056077 [debug] [MainThread]: 1699: static parser successfully parsed SQL_SCRIPTS\RBAC_DEV_DB.sql
[0m19:58:34.138071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe6d2481-bdd7-4e1d-bd19-abb91f196de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1BFFA7D0>]}
[0m19:58:34.151082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe6d2481-bdd7-4e1d-bd19-abb91f196de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1BFA9990>]}
[0m19:58:34.151082 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m19:58:34.179080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe6d2481-bdd7-4e1d-bd19-abb91f196de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1BFE0A10>]}
[0m19:58:34.183085 [info ] [MainThread]: 
[0m19:58:34.185084 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:58:34.188082 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m19:58:34.210083 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m19:58:34.211085 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m19:58:34.212087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:58:37.423596 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m19:58:37.426602 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m19:58:37.915595 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m19:58:37.926610 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m19:58:37.927612 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m19:58:37.927612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:58:39.732605 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m19:58:39.735600 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m19:58:40.224606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe6d2481-bdd7-4e1d-bd19-abb91f196de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1AEFAAD0>]}
[0m19:58:40.225604 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:58:40.226602 [info ] [MainThread]: 
[0m19:58:40.248607 [debug] [Thread-1 (]: Began running node model.dbt_poc.NADL_CORE_IMS_FLU
[0m19:58:40.249606 [debug] [Thread-2 (]: Began running node model.dbt_poc.RBAC_DEV_DB
[0m19:58:40.250607 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:58:40.250607 [debug] [Thread-4 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:58:40.251616 [info ] [Thread-1 (]: 1 of 9 START sql view model DIGITAL_SHELF_DBT.NADL_CORE_IMS_FLU ................ [RUN]
[0m19:58:40.270612 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.NADL_CORE_IMS_FLU'
[0m19:58:40.271610 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.NADL_CORE_IMS_FLU
[0m19:58:40.275609 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.NADL_CORE_IMS_FLU"
[0m19:58:40.277605 [debug] [Thread-1 (]: Timing info for model.dbt_poc.NADL_CORE_IMS_FLU (compile): 19:58:40.272611 => 19:58:40.276609
[0m19:58:40.278603 [debug] [Thread-1 (]: Began executing node model.dbt_poc.NADL_CORE_IMS_FLU
[0m19:58:40.252605 [info ] [Thread-2 (]: 2 of 9 START sql view model DIGITAL_SHELF_DBT.RBAC_DEV_DB ...................... [RUN]
[0m19:58:40.424603 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.NADL_CORE_IMS_FLU"
[0m19:58:40.425604 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.RBAC_DEV_DB'
[0m19:58:40.253616 [info ] [Thread-3 (]: 3 of 9 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m19:58:40.427605 [debug] [Thread-1 (]: On model.dbt_poc.NADL_CORE_IMS_FLU: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.NADL_CORE_IMS_FLU"} */
{
[0m19:58:40.267605 [info ] [Thread-4 (]: 4 of 9 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m19:58:40.428611 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.RBAC_DEV_DB
[0m19:58:40.429605 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m19:58:40.432604 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:58:40.433606 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m19:58:40.436606 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.RBAC_DEV_DB"
[0m19:58:40.437602 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:58:40.440613 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:58:40.458617 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m19:58:40.463616 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:58:40.464616 [debug] [Thread-2 (]: Timing info for model.dbt_poc.RBAC_DEV_DB (compile): 19:58:40.434611 => 19:58:40.464616
[0m19:58:40.467612 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 19:58:40.442613 => 19:58:40.466616
[0m19:58:40.467612 [debug] [Thread-4 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 19:58:40.459611 => 19:58:40.467612
[0m19:58:40.468618 [debug] [Thread-2 (]: Began executing node model.dbt_poc.RBAC_DEV_DB
[0m19:58:40.469618 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:58:40.470615 [debug] [Thread-4 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:58:40.481605 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.RBAC_DEV_DB"
[0m19:58:40.515607 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m19:58:40.558613 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:58:40.559609 [debug] [Thread-2 (]: On model.dbt_poc.RBAC_DEV_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.RBAC_DEV_DB"} */
{
[0m19:58:40.560608 [debug] [Thread-3 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
{
[0m19:58:40.561609 [debug] [Thread-4 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
{
[0m19:58:40.562608 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:58:40.563611 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:58:40.564614 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:58:43.200654 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01adc6c4-0c04-c90f-0002-a6560102ec8a
[0m19:58:43.200654 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:43.202655 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 19:58:40.486606 => 19:58:43.201654
[0m19:58:43.202655 [debug] [Thread-3 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m19:58:43.262663 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01adc6c4-0c04-c99f-0002-a6560102deda
[0m19:58:43.263664 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:43.264667 [debug] [Thread-2 (]: Timing info for model.dbt_poc.RBAC_DEV_DB (execute): 19:58:40.471616 => 19:58:43.264667
[0m19:58:43.265664 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01adc6c4-0c04-c90f-0002-a6560102ec92
[0m19:58:43.266659 [debug] [Thread-2 (]: On model.dbt_poc.RBAC_DEV_DB: Close
[0m19:58:43.266659 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:43.271665 [debug] [Thread-4 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 19:58:40.554607 => 19:58:43.270662
[0m19:58:43.272659 [debug] [Thread-4 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m19:58:43.277661 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01adc6c4-0c04-c90f-0002-a6560102ec8e
[0m19:58:43.282663 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:43.292655 [debug] [Thread-1 (]: Timing info for model.dbt_poc.NADL_CORE_IMS_FLU (execute): 19:58:40.278603 => 19:58:43.291654
[0m19:58:43.293655 [debug] [Thread-1 (]: On model.dbt_poc.NADL_CORE_IMS_FLU: Close
[0m19:58:43.694657 [debug] [Thread-3 (]: Database Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:43.695658 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6d2481-bdd7-4e1d-bd19-abb91f196de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1C81A990>]}
[0m19:58:43.696657 [error] [Thread-3 (]: 3 of 9 ERROR creating sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[31mERROR[0m in 3.27s]
[0m19:58:43.698671 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:58:43.699664 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:58:43.700668 [info ] [Thread-3 (]: 5 of 9 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m19:58:43.703655 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM, now model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN)
[0m19:58:43.704667 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:58:43.711666 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m19:58:43.713663 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 19:58:43.704667 => 19:58:43.713663
[0m19:58:43.714667 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:58:43.720661 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m19:58:43.721670 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
{
[0m19:58:43.721670 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:58:43.771663 [debug] [Thread-4 (]: Database Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:43.775669 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6d2481-bdd7-4e1d-bd19-abb91f196de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1C086D90>]}
[0m19:58:43.776672 [error] [Thread-4 (]: 4 of 9 ERROR creating sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[31mERROR[0m in 3.34s]
[0m19:58:43.783664 [debug] [Thread-2 (]: Database Error in model RBAC_DEV_DB (models\SQL_SCRIPTS\RBAC_DEV_DB.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:43.784666 [debug] [Thread-4 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:58:43.785662 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6d2481-bdd7-4e1d-bd19-abb91f196de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1C9ACAD0>]}
[0m19:58:43.786666 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:58:43.792657 [debug] [Thread-1 (]: Database Error in model NADL_CORE_IMS_FLU (models\External_tables\NADL_CORE_IMS_FLU.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:43.788660 [error] [Thread-2 (]: 2 of 9 ERROR creating sql view model DIGITAL_SHELF_DBT.RBAC_DEV_DB ............. [[31mERROR[0m in 3.36s]
[0m19:58:43.794665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6d2481-bdd7-4e1d-bd19-abb91f196de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1C81DA10>]}
[0m19:58:43.793659 [info ] [Thread-4 (]: 6 of 9 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m19:58:43.795666 [debug] [Thread-2 (]: Finished running node model.dbt_poc.RBAC_DEV_DB
[0m19:58:43.798667 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM)
[0m19:58:43.796661 [error] [Thread-1 (]: 1 of 9 ERROR creating sql view model DIGITAL_SHELF_DBT.NADL_CORE_IMS_FLU ....... [[31mERROR[0m in 3.53s]
[0m19:58:43.799670 [debug] [Thread-2 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:58:43.800665 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:58:43.801669 [debug] [Thread-1 (]: Finished running node model.dbt_poc.NADL_CORE_IMS_FLU
[0m19:58:43.807663 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m19:58:43.802661 [info ] [Thread-2 (]: 7 of 9 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m19:58:43.808661 [debug] [Thread-1 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m19:58:43.810658 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.RBAC_DEV_DB, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m19:58:43.811664 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 19:58:43.802661 => 19:58:43.811664
[0m19:58:43.813660 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:58:43.812669 [info ] [Thread-1 (]: 8 of 9 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m19:58:43.817669 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:58:43.827659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.NADL_CORE_IMS_FLU, now model.dbt_poc.my_first_dbt_model)
[0m19:58:43.832663 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m19:58:43.833667 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m19:58:43.834664 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
{
[0m19:58:43.838665 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m19:58:43.839666 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:58:43.845678 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:58:43.849667 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 19:58:43.835665 => 19:58:43.848680
[0m19:58:43.850658 [debug] [Thread-1 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m19:58:43.851659 [debug] [Thread-2 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 19:58:43.818661 => 19:58:43.851659
[0m19:58:43.855657 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m19:58:43.856661 [debug] [Thread-2 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:58:43.857664 [debug] [Thread-1 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
{
[0m19:58:43.957669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:58:43.958669 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:58:43.961664 [debug] [Thread-2 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
{
[0m19:58:43.962669 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:58:46.286457 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01adc6c4-0c04-c90f-0002-a6560102ec96
[0m19:58:46.287466 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:46.289462 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 19:58:43.851659 => 19:58:46.288465
[0m19:58:46.290465 [debug] [Thread-1 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m19:58:46.292463 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01adc6c4-0c04-c99f-0002-a6560102dede
[0m19:58:46.295466 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:46.297462 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 19:58:43.828664 => 19:58:46.296466
[0m19:58:46.298462 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m19:58:46.300458 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01adc6c4-0c04-c90f-0002-a6560102ec9a
[0m19:58:46.301457 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:46.303468 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 19:58:43.715663 => 19:58:46.302459
[0m19:58:46.304462 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m19:58:46.322473 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01adc6c4-0c04-c90f-0002-a6560102ec9e
[0m19:58:46.323472 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:46.324468 [debug] [Thread-2 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 19:58:43.858661 => 19:58:46.324468
[0m19:58:46.325467 [debug] [Thread-2 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m19:58:46.830467 [debug] [Thread-4 (]: Database Error in model VW_CRITEO_AD__DAYREPORT_LINE_ITEM (models\L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:46.835466 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6d2481-bdd7-4e1d-bd19-abb91f196de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1C9AC410>]}
[0m19:58:46.836466 [error] [Thread-4 (]: 6 of 9 ERROR creating sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[31mERROR[0m in 3.04s]
[0m19:58:46.839487 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:58:46.843459 [debug] [Thread-2 (]: Database Error in model VW_CRITEO_AD__DAYREPORT_PRODUCT (models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:46.846470 [debug] [Thread-3 (]: Database Error in model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:46.848467 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6d2481-bdd7-4e1d-bd19-abb91f196de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1C583C50>]}
[0m19:58:46.849469 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6d2481-bdd7-4e1d-bd19-abb91f196de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1A026CD0>]}
[0m19:58:46.850467 [error] [Thread-2 (]: 7 of 9 ERROR creating sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[31mERROR[0m in 3.04s]
[0m19:58:46.852471 [debug] [Thread-2 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:58:46.851470 [error] [Thread-3 (]: 5 of 9 ERROR creating sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[31mERROR[0m in 3.15s]
[0m19:58:46.853469 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:58:46.921464 [debug] [Thread-1 (]: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:46.922471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6d2481-bdd7-4e1d-bd19-abb91f196de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1C81D590>]}
[0m19:58:46.923469 [error] [Thread-1 (]: 8 of 9 ERROR creating sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ..... [[31mERROR[0m in 3.09s]
[0m19:58:46.925465 [debug] [Thread-1 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m19:58:46.927497 [debug] [Thread-4 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m19:58:46.928474 [info ] [Thread-4 (]: 9 of 9 SKIP relation DIGITAL_SHELF_DBT.my_second_dbt_model ..................... [[33mSKIP[0m]
[0m19:58:46.930467 [debug] [Thread-4 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m19:58:46.933464 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:58:46.937460 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m19:58:46.942463 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m19:58:46.951461 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m19:58:46.955471 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m19:58:46.955471 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN' was properly closed.
[0m19:58:46.956476 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM' was properly closed.
[0m19:58:46.957469 [info ] [MainThread]: 
[0m19:58:46.959469 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 12.77 seconds (12.77s).
[0m19:58:46.983466 [debug] [MainThread]: Command end result
[0m19:58:47.017461 [info ] [MainThread]: 
[0m19:58:47.018467 [info ] [MainThread]: [31mCompleted with 8 errors and 0 warnings:[0m
[0m19:58:47.019467 [info ] [MainThread]: 
[0m19:58:47.116465 [error] [MainThread]: [33mDatabase Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql)[0m
[0m19:58:47.213468 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m19:58:47.302464 [error] [MainThread]:   syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:47.341472 [info ] [MainThread]: 
[0m19:58:47.388469 [error] [MainThread]: [33mDatabase Error in model TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (models\RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql)[0m
[0m19:58:47.389465 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m19:58:47.391478 [error] [MainThread]:   syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:47.392470 [info ] [MainThread]: 
[0m19:58:47.393469 [error] [MainThread]: [33mDatabase Error in model RBAC_DEV_DB (models\SQL_SCRIPTS\RBAC_DEV_DB.sql)[0m
[0m19:58:47.394471 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m19:58:47.396469 [error] [MainThread]:   syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:47.397465 [info ] [MainThread]: 
[0m19:58:47.401478 [error] [MainThread]: [33mDatabase Error in model NADL_CORE_IMS_FLU (models\External_tables\NADL_CORE_IMS_FLU.sql)[0m
[0m19:58:47.493033 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m19:58:47.505032 [error] [MainThread]:   syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:47.528031 [info ] [MainThread]: 
[0m19:58:47.537603 [error] [MainThread]: [33mDatabase Error in model VW_CRITEO_AD__DAYREPORT_LINE_ITEM (models\L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql)[0m
[0m19:58:47.614169 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m19:58:47.646155 [error] [MainThread]:   syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:47.654154 [info ] [MainThread]: 
[0m19:58:47.676734 [error] [MainThread]: [33mDatabase Error in model VW_CRITEO_AD__DAYREPORT_PRODUCT (models\L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql)[0m
[0m19:58:47.678741 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m19:58:47.680745 [error] [MainThread]:   syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:47.682745 [info ] [MainThread]: 
[0m19:58:47.684746 [error] [MainThread]: [33mDatabase Error in model TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (models\RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql)[0m
[0m19:58:47.686741 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m19:58:47.697735 [error] [MainThread]:   syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:47.711733 [info ] [MainThread]: 
[0m19:58:47.744730 [error] [MainThread]: [33mDatabase Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)[0m
[0m19:58:47.745739 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m19:58:47.747734 [error] [MainThread]:   syntax error line 1 at position 1 unexpected '<EOF>'.
[0m19:58:47.748737 [info ] [MainThread]: 
[0m19:58:47.749736 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=8 SKIP=1 TOTAL=9
[0m19:58:47.752315 [debug] [MainThread]: Command `dbt run` failed at 19:58:47.752315 after 22.58 seconds
[0m19:58:47.753315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A12CD73D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A13798F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A13174DD0>]}
[0m19:58:47.754315 [debug] [MainThread]: Flushing usage events
[0m19:58:48.621990 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:10:43.135431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E525DC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E4D54CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E52CF0D0>]}


============================== 20:10:43.150432 | e9ddf5df-b4e4-4ba4-ba01-71012b228543 ==============================
[0m20:10:43.150432 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:10:43.152445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:10:50.280458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9ddf5df-b4e4-4ba4-ba01-71012b228543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E518D190>]}
[0m20:10:50.302455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9ddf5df-b4e4-4ba4-ba01-71012b228543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259EDF61F10>]}
[0m20:10:50.313448 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:10:50.395457 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:10:50.433459 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:10:50.437458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e9ddf5df-b4e4-4ba4-ba01-71012b228543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259EE089E10>]}
[0m20:10:52.441456 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m20:10:52.465459 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m20:10:52.475464 [debug] [MainThread]: 1699: static parser successfully parsed L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m20:10:52.482476 [debug] [MainThread]: 1699: static parser successfully parsed L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:10:52.489460 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m20:10:52.503464 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m20:10:52.507460 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:10:52.514453 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m20:10:52.517454 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:10:52.525459 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m20:10:52.629458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9ddf5df-b4e4-4ba4-ba01-71012b228543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259EDFBB450>]}
[0m20:10:52.642458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9ddf5df-b4e4-4ba4-ba01-71012b228543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259EE01BF90>]}
[0m20:10:52.643462 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 323 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m20:10:52.656464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9ddf5df-b4e4-4ba4-ba01-71012b228543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E0F12850>]}
[0m20:10:52.660469 [info ] [MainThread]: 
[0m20:10:52.665465 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:10:52.681462 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m20:10:52.712459 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m20:10:52.713460 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m20:10:52.713460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:56.000462 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m20:10:56.002462 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m20:10:56.519476 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m20:10:56.531476 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m20:10:56.532478 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m20:10:56.533478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:01.388475 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 5.0 seconds
[0m20:11:01.391475 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m20:11:01.974476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9ddf5df-b4e4-4ba4-ba01-71012b228543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259EE0B3990>]}
[0m20:11:01.975480 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:11:01.977480 [info ] [MainThread]: 
[0m20:11:02.029476 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:11:02.030476 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:11:02.030476 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:11:02.031479 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:11:02.032477 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m20:11:02.050491 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m20:11:02.051487 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:11:02.056483 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:11:02.058477 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 20:11:02.051487 => 20:11:02.058477
[0m20:11:02.059488 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:11:02.033489 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m20:11:02.082484 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m20:11:02.035488 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m20:11:02.147490 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:11:02.148481 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:11:02.036487 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m20:11:02.149500 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m20:11:02.150490 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:11:02.156489 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:11:02.157480 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m20:11:02.158477 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:11:02.159486 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:11:02.160482 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:11:02.166477 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:11:02.167478 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:11:02.151482 => 20:11:02.167478
[0m20:11:02.175501 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:11:02.177487 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:11:02.178488 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 20:11:02.161483 => 20:11:02.178488
[0m20:11:02.194487 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:11:02.197491 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:11:02.198516 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:11:02.195486 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:11:02.196492 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 20:11:02.170490 => 20:11:02.196492
[0m20:11:02.223492 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:11:02.222488 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:11:02.270480 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:11:02.272493 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:11:02.340487 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:11:02.344485 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:11:02.345483 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join   COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m20:11:02.347489 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:11:04.880498 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:11:04.903496 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:11:04.905495 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:11:04.935484 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 20:11:02.224487 => 20:11:04.935484
[0m20:11:04.937494 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:11:04.938490 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:11:04.939483 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m20:11:04.942497 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:11:04.942497 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
        );
[0m20:11:05.047485 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:11:05.056485 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:11:05.059485 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:11:05.060484 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)



select *
from final
        );
[0m20:11:05.053486 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:11:05.065488 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_CAMPAIGN  a
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  b
on a.tag_id = b.id
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m20:11:05.550492 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9ddf5df-b4e4-4ba4-ba01-71012b228543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259EE8BFE50>]}
[0m20:11:05.551498 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 3.39s]
[0m20:11:05.553492 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:11:05.554496 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:11:05.555492 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m20:11:05.557497 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m20:11:05.559486 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:11:05.565500 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:11:05.567494 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:11:05.560498 => 20:11:05.567494
[0m20:11:05.568494 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:11:05.573496 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:11:05.575493 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:11:05.576493 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m20:11:05.577499 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:11:06.801496 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:11:06.805487 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:11:02.179487 => 20:11:06.805487
[0m20:11:06.806486 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:11:07.835491 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9ddf5df-b4e4-4ba4-ba01-71012b228543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259EDFB6450>]}
[0m20:11:07.836490 [info ] [Thread-2 (]: 2 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 5.75s]
[0m20:11:07.837503 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:11:07.838501 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m20:11:07.839504 [info ] [Thread-2 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m20:11:07.843500 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_first_dbt_model)
[0m20:11:07.844501 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m20:11:07.848499 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m20:11:07.850497 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 20:11:07.844501 => 20:11:07.850497
[0m20:11:07.851504 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m20:11:07.856496 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m20:11:07.858498 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m20:11:07.859500 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:11:07.860500 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:11:14.626086 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 7.0 seconds
[0m20:11:14.629083 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 20:11:07.852502 => 20:11:14.629083
[0m20:11:14.630081 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m20:11:15.178083 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9ddf5df-b4e4-4ba4-ba01-71012b228543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259EE0B0790>]}
[0m20:11:15.179082 [info ] [Thread-2 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 7.34s]
[0m20:11:15.181088 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m20:11:15.182087 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m20:11:15.183103 [info ] [Thread-2 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m20:11:15.186086 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.my_first_dbt_model, now model.dbt_poc.my_second_dbt_model)
[0m20:11:15.187091 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m20:11:15.191090 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m20:11:15.208089 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 20:11:15.187091 => 20:11:15.208089
[0m20:11:15.209092 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m20:11:15.279093 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m20:11:15.282097 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m20:11:15.283092 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m20:11:15.313082 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:11:20.173925 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 15.0 seconds
[0m20:11:20.177918 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:11:05.568494 => 20:11:20.177918
[0m20:11:20.178919 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:11:21.128930 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9ddf5df-b4e4-4ba4-ba01-71012b228543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259EE020C10>]}
[0m20:11:21.130930 [info ] [Thread-4 (]: 5 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 15.57s]
[0m20:11:21.131929 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:11:21.559931 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 6.0 seconds
[0m20:11:21.563922 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 20:11:15.258095 => 20:11:21.563922
[0m20:11:21.564922 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m20:11:23.237984 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9ddf5df-b4e4-4ba4-ba01-71012b228543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259EE075190>]}
[0m20:11:23.238987 [info ] [Thread-2 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 8.05s]
[0m20:11:23.240998 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m20:11:25.933652 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 21.0 seconds
[0m20:11:25.937645 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 20:11:02.060479 => 20:11:25.937645
[0m20:11:25.938648 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m20:11:26.023657 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 21.0 seconds
[0m20:11:26.028648 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 20:11:02.217485 => 20:11:26.027648
[0m20:11:26.028648 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m20:11:26.426651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9ddf5df-b4e4-4ba4-ba01-71012b228543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259EE081B10>]}
[0m20:11:26.426651 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 24.38s]
[0m20:11:26.428658 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:11:26.535657 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9ddf5df-b4e4-4ba4-ba01-71012b228543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259EE1090D0>]}
[0m20:11:26.536653 [info ] [Thread-3 (]: 3 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[32mSUCCESS 1[0m in 24.39s]
[0m20:11:26.538656 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:11:26.541659 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:11:26.542665 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m20:11:26.543666 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m20:11:26.543666 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM' was properly closed.
[0m20:11:26.544658 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m20:11:26.545655 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN' was properly closed.
[0m20:11:26.545655 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m20:11:26.546660 [info ] [MainThread]: 
[0m20:11:26.548657 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 33.88 seconds (33.88s).
[0m20:11:26.551651 [debug] [MainThread]: Command end result
[0m20:11:26.563659 [info ] [MainThread]: 
[0m20:11:26.564653 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:11:26.566660 [info ] [MainThread]: 
[0m20:11:26.567654 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m20:11:26.568655 [debug] [MainThread]: Command `dbt run` succeeded at 20:11:26.568655 after 44.03 seconds
[0m20:11:26.569666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E5898C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259DFDFB2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259DFE3F310>]}
[0m20:11:26.570664 [debug] [MainThread]: Flushing usage events
[0m20:11:27.605663 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m17:51:30.944057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186802296D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018680315710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018680743110>]}


============================== 17:51:30.961047 | 8fb3c8dd-c669-40a8-bc66-a3e0d60f47ac ==============================
[0m17:51:30.961047 [info ] [MainThread]: Running with dbt=1.5.2
[0m17:51:30.963054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:51:40.118624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fb3c8dd-c669-40a8-bc66-a3e0d60f47ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018680D84FD0>]}
[0m17:51:40.140621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fb3c8dd-c669-40a8-bc66-a3e0d60f47ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018689516DD0>]}
[0m17:51:40.150615 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m17:51:40.240620 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m17:51:41.081629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:51:41.082634 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:51:41.093618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fb3c8dd-c669-40a8-bc66-a3e0d60f47ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018687AFC990>]}
[0m17:51:41.104618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fb3c8dd-c669-40a8-bc66-a3e0d60f47ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001868958A950>]}
[0m17:51:41.105620 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 323 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m17:51:41.108631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fb3c8dd-c669-40a8-bc66-a3e0d60f47ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186FC512810>]}
[0m17:51:41.115617 [info ] [MainThread]: 
[0m17:51:41.122632 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:51:41.126621 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m17:51:41.159630 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m17:51:41.161632 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m17:51:41.173624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:45.778633 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 5.0 seconds
[0m17:51:45.781634 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m17:51:46.283635 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m17:51:46.294634 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m17:51:46.295633 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m17:51:46.296634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:48.462639 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m17:51:48.465637 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m17:51:48.945652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fb3c8dd-c669-40a8-bc66-a3e0d60f47ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186895B8290>]}
[0m17:51:48.947656 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:51:48.948645 [info ] [MainThread]: 
[0m17:51:48.972653 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m17:51:48.973654 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m17:51:48.973654 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m17:51:48.974654 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m17:51:48.975645 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m17:51:48.984646 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m17:51:48.986649 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m17:51:48.988650 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m17:51:48.990654 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m17:51:48.991645 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m17:51:48.992651 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m17:51:48.993647 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m17:51:48.994645 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m17:51:48.995645 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m17:51:48.996644 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m17:51:48.997651 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m17:51:49.003651 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m17:51:49.010641 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m17:51:49.024655 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m17:51:49.031655 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m17:51:49.033652 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 17:51:48.998654 => 17:51:49.033652
[0m17:51:49.039644 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m17:51:49.035648 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 17:51:49.004651 => 17:51:49.034657
[0m17:51:49.036658 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 17:51:49.013648 => 17:51:49.036658
[0m17:51:49.058647 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 17:51:49.025656 => 17:51:49.058647
[0m17:51:49.110653 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m17:51:49.111654 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m17:51:49.112648 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m17:51:49.113646 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m17:51:49.117651 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m17:51:49.118649 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m17:51:49.122645 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m17:51:49.156641 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m17:51:49.159642 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m17:51:49.160646 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:51:49.161644 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m17:51:49.162648 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:51:49.165653 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:51:49.167650 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m17:51:49.173648 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join   COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m17:51:49.174653 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:51:51.677649 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:51:51.695649 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m17:51:51.700649 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m17:51:51.701649 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_CAMPAIGN  a
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  b
on a.tag_id = b.id
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m17:51:51.781654 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:51:51.814663 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 17:51:49.123657 => 17:51:51.813662
[0m17:51:51.815659 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m17:51:51.831664 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:51:51.833661 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m17:51:51.835658 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:51:51.837664 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m17:51:51.839656 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m17:51:51.840659 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)



select *
from final
        );
[0m17:51:51.842659 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m17:51:51.844657 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
        );
[0m17:51:52.306652 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fb3c8dd-c669-40a8-bc66-a3e0d60f47ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018687526D10>]}
[0m17:51:52.307652 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 3.31s]
[0m17:51:52.308661 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m17:51:52.309667 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m17:51:52.310664 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m17:51:52.312658 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m17:51:52.313667 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m17:51:52.318673 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m17:51:52.320660 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 17:51:52.313667 => 17:51:52.320660
[0m17:51:52.321665 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m17:51:52.328660 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m17:51:52.330661 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m17:51:52.331661 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m17:51:52.332663 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:51:53.775661 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:51:53.779660 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 17:51:49.114652 => 17:51:53.779660
[0m17:51:53.780653 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m17:51:53.804670 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:51:53.808669 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 17:51:49.043647 => 17:51:53.807664
[0m17:51:53.808669 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m17:51:54.274658 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fb3c8dd-c669-40a8-bc66-a3e0d60f47ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001868A174910>]}
[0m17:51:54.275659 [info ] [Thread-2 (]: 2 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 5.28s]
[0m17:51:54.277670 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m17:51:54.278670 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m17:51:54.279671 [info ] [Thread-2 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m17:51:54.282657 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_first_dbt_model)
[0m17:51:54.283668 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m17:51:54.288662 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m17:51:54.290663 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 17:51:54.284668 => 17:51:54.290663
[0m17:51:54.291663 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m17:51:54.298665 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m17:51:54.300665 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m17:51:54.301677 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m17:51:54.302674 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:51:54.340664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fb3c8dd-c669-40a8-bc66-a3e0d60f47ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018689645C10>]}
[0m17:51:54.342673 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 5.35s]
[0m17:51:54.345665 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m17:51:54.527667 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:51:54.531661 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 17:51:52.322661 => 17:51:54.531661
[0m17:51:54.532661 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m17:51:55.001660 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:51:55.004662 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 17:51:49.119653 => 17:51:55.004662
[0m17:51:55.005660 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m17:51:55.021660 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fb3c8dd-c669-40a8-bc66-a3e0d60f47ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001868A18BED0>]}
[0m17:51:55.022659 [info ] [Thread-4 (]: 5 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.71s]
[0m17:51:55.024672 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m17:51:55.482665 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fb3c8dd-c669-40a8-bc66-a3e0d60f47ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018689FBF5D0>]}
[0m17:51:55.484675 [info ] [Thread-3 (]: 3 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[32mSUCCESS 1[0m in 6.49s]
[0m17:51:55.486672 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m17:51:56.577665 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:51:56.581665 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 17:51:54.292665 => 17:51:56.581665
[0m17:51:56.582667 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m17:51:57.076666 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fb3c8dd-c669-40a8-bc66-a3e0d60f47ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186895BF810>]}
[0m17:51:57.077666 [info ] [Thread-2 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 2.79s]
[0m17:51:57.079675 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m17:51:57.080671 [debug] [Thread-1 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m17:51:57.081671 [info ] [Thread-1 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m17:51:57.082677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM, now model.dbt_poc.my_second_dbt_model)
[0m17:51:57.083681 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m17:51:57.104669 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m17:51:57.106672 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 17:51:57.084673 => 17:51:57.105680
[0m17:51:57.107674 [debug] [Thread-1 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m17:51:57.151677 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m17:51:57.154681 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m17:51:57.155669 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m17:51:57.156668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:59.146676 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:51:59.150669 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 17:51:57.125668 => 17:51:59.150669
[0m17:51:59.151673 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m17:51:59.651679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fb3c8dd-c669-40a8-bc66-a3e0d60f47ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001868A1A20D0>]}
[0m17:51:59.652686 [info ] [Thread-1 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.57s]
[0m17:51:59.655689 [debug] [Thread-1 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m17:51:59.658687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:59.659687 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m17:51:59.659687 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m17:51:59.660679 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m17:51:59.661685 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m17:51:59.661685 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN' was properly closed.
[0m17:51:59.664675 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m17:51:59.671675 [info ] [MainThread]: 
[0m17:51:59.788233 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 18.55 seconds (18.55s).
[0m17:51:59.792238 [debug] [MainThread]: Command end result
[0m17:51:59.804249 [info ] [MainThread]: 
[0m17:51:59.805229 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:51:59.807240 [info ] [MainThread]: 
[0m17:51:59.808248 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m17:51:59.810241 [debug] [MainThread]: Command `dbt run` succeeded at 17:51:59.810241 after 29.36 seconds
[0m17:51:59.811243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018680A285D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186FB3FA490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186FB43F310>]}
[0m17:51:59.812242 [debug] [MainThread]: Flushing usage events
[0m17:52:01.265247 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m17:53:17.803884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D105D16D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D10056CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D10B76B90>]}


============================== 17:53:17.809881 | e2d61c26-25bf-4ae7-b6ec-c0e39f745a78 ==============================
[0m17:53:17.809881 [info ] [MainThread]: Running with dbt=1.5.2
[0m17:53:17.812898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:53:18.908890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2d61c26-25bf-4ae7-b6ec-c0e39f745a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D10B6FE10>]}
[0m17:53:18.929881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2d61c26-25bf-4ae7-b6ec-c0e39f745a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D1926B1D0>]}
[0m17:53:18.931881 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m17:53:18.998895 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m17:53:19.113883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:53:19.114883 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:53:19.125893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2d61c26-25bf-4ae7-b6ec-c0e39f745a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D19364350>]}
[0m17:53:19.137891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2d61c26-25bf-4ae7-b6ec-c0e39f745a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D192A9C90>]}
[0m17:53:19.138894 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 323 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m17:53:19.140887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2d61c26-25bf-4ae7-b6ec-c0e39f745a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D0C207210>]}
[0m17:53:19.142893 [debug] [MainThread]: Acquiring new snowflake connection 'macro_RBAC'
[0m17:53:19.161888 [debug] [MainThread]: Command `dbt run-operation` succeeded at 17:53:19.161888 after 1.83 seconds
[0m17:53:19.163888 [debug] [MainThread]: Connection 'macro_RBAC' was properly closed.
[0m17:53:19.164888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D10064150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D192AB010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D0C206FD0>]}
[0m17:53:19.165896 [debug] [MainThread]: Flushing usage events
[0m17:53:20.316891 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:03:10.088750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BFE616D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BFEEF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BFE71650>]}


============================== 19:03:10.106756 | 9e081b6e-b7e3-435e-93a0-e2678b1a5bad ==============================
[0m19:03:10.106756 [info ] [MainThread]: Running with dbt=1.5.2
[0m19:03:10.108759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:03:19.403816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e081b6e-b7e3-435e-93a0-e2678b1a5bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240C0374B90>]}
[0m19:03:19.421819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e081b6e-b7e3-435e-93a0-e2678b1a5bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240C903CCD0>]}
[0m19:03:19.431809 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m19:03:19.504827 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m19:03:20.486811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:03:20.487811 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:03:20.497818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e081b6e-b7e3-435e-93a0-e2678b1a5bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240C6FCEFD0>]}
[0m19:03:20.509834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e081b6e-b7e3-435e-93a0-e2678b1a5bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240C909AC10>]}
[0m19:03:20.510813 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 323 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m19:03:20.512825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e081b6e-b7e3-435e-93a0-e2678b1a5bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BC012810>]}
[0m19:03:20.515833 [info ] [MainThread]: 
[0m19:03:20.516823 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:03:20.518825 [debug] [MainThread]: Command end result
[0m19:03:20.566821 [info ] [MainThread]: 
[0m19:03:20.569826 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:03:20.570827 [info ] [MainThread]: 
[0m19:03:20.574821 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m19:03:20.576821 [debug] [MainThread]: Command `dbt seed` succeeded at 19:03:20.576821 after 11.16 seconds
[0m19:03:20.577826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BFF18790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BAF3F310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BAF3FFD0>]}
[0m19:03:20.579820 [debug] [MainThread]: Flushing usage events
[0m19:03:21.653944 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:03:43.194956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221114D96D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002210F0C2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022110F3F7D0>]}


============================== 19:03:43.200960 | f691a241-7aee-4068-aeb9-2b0db353f831 ==============================
[0m19:03:43.200960 [info ] [MainThread]: Running with dbt=1.5.2
[0m19:03:43.201953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:03:44.264952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f691a241-7aee-4068-aeb9-2b0db353f831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002211A154150>]}
[0m19:03:44.289958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f691a241-7aee-4068-aeb9-2b0db353f831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002211A118990>]}
[0m19:03:44.291955 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m19:03:44.351963 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m19:03:44.497956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:03:44.498957 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:03:44.510962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f691a241-7aee-4068-aeb9-2b0db353f831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002211824ADD0>]}
[0m19:03:44.530961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f691a241-7aee-4068-aeb9-2b0db353f831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002211A17D410>]}
[0m19:03:44.531965 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 323 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m19:03:44.572119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f691a241-7aee-4068-aeb9-2b0db353f831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002210D112990>]}
[0m19:03:44.603722 [info ] [MainThread]: 
[0m19:03:44.605725 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:03:44.668283 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m19:03:44.709850 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m19:03:44.710854 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m19:03:44.711850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:48.337381 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 4.0 seconds
[0m19:03:48.339379 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m19:03:48.854497 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m19:03:48.867490 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m19:03:48.868488 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m19:03:48.868488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:50.947499 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m19:03:50.950494 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m19:03:51.470494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f691a241-7aee-4068-aeb9-2b0db353f831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022110630D50>]}
[0m19:03:51.471496 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:03:51.472497 [info ] [MainThread]: 
[0m19:03:51.511497 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:03:51.512498 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:03:51.513501 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:03:51.513501 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:03:51.514507 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m19:03:51.515499 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m19:03:51.517499 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m19:03:51.521504 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m19:03:51.534513 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:03:51.533503 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m19:03:51.525498 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m19:03:51.540511 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m19:03:51.519508 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m19:03:51.541498 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:03:51.541498 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:03:51.543500 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m19:03:51.568511 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:03:51.550510 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m19:03:51.566504 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:03:51.550510 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 19:03:51.535510 => 19:03:51.550510
[0m19:03:51.572509 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m19:03:51.574509 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:03:51.576507 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 19:03:51.544503 => 19:03:51.575510
[0m19:03:51.576507 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 19:03:51.551511 => 19:03:51.576507
[0m19:03:51.599503 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 19:03:51.568511 => 19:03:51.599503
[0m19:03:51.641501 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m19:03:51.642500 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:03:51.643507 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:03:51.644503 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:03:51.645506 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:03:51.649504 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m19:03:51.653504 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:03:51.695502 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:03:51.699503 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m19:03:51.700506 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:03:51.701496 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:03:51.706502 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:03:51.708508 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m19:03:51.708508 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:03:51.711505 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join   COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m19:03:51.715505 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:03:54.430504 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:03:54.461511 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 19:03:51.654503 => 19:03:54.460508
[0m19:03:54.462528 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:03:54.463522 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:03:54.464512 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m19:03:54.483512 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m19:03:54.486501 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:03:54.495512 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m19:03:54.496517 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_CAMPAIGN  a
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  b
on a.tag_id = b.id
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m19:03:54.498507 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:03:54.500510 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)



select *
from final
        );
[0m19:03:54.522514 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:03:54.525510 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m19:03:54.528507 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m19:03:54.529506 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
        );
[0m19:03:54.985516 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f691a241-7aee-4068-aeb9-2b0db353f831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002211A1BCF50>]}
[0m19:03:54.987520 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 3.44s]
[0m19:03:54.989510 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:03:54.989510 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:03:54.990508 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m19:03:54.993505 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m19:03:54.994512 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:03:55.000510 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:03:55.003518 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 19:03:54.995517 => 19:03:55.002511
[0m19:03:55.003518 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:03:55.008514 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:03:55.011513 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:03:55.012519 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m19:03:55.013520 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:56.477730 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:03:56.481729 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 19:03:51.650500 => 19:03:56.481729
[0m19:03:56.482735 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m19:03:56.941922 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:03:56.948924 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 19:03:51.577507 => 19:03:56.947923
[0m19:03:56.949923 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m19:03:57.002925 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f691a241-7aee-4068-aeb9-2b0db353f831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002211AA7FD50>]}
[0m19:03:57.004923 [info ] [Thread-2 (]: 2 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 5.48s]
[0m19:03:57.006927 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:03:57.007928 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m19:03:57.008933 [info ] [Thread-2 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m19:03:57.011933 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_first_dbt_model)
[0m19:03:57.012929 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m19:03:57.016931 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m19:03:57.018931 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 19:03:57.012929 => 19:03:57.018931
[0m19:03:57.019933 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m19:03:57.024925 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m19:03:57.026924 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m19:03:57.027926 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:03:57.028930 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:03:57.371044 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:03:57.375038 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 19:03:55.004514 => 19:03:57.375038
[0m19:03:57.376039 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m19:03:57.445046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f691a241-7aee-4068-aeb9-2b0db353f831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002211A1CEC10>]}
[0m19:03:57.447051 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 5.92s]
[0m19:03:57.448048 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:03:57.903048 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f691a241-7aee-4068-aeb9-2b0db353f831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002211A1D9990>]}
[0m19:03:57.904052 [info ] [Thread-4 (]: 5 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.91s]
[0m19:03:57.906054 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:03:58.048043 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m19:03:58.052053 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 19:03:51.645506 => 19:03:58.052053
[0m19:03:58.053055 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m19:03:58.541044 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f691a241-7aee-4068-aeb9-2b0db353f831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002211AE07F50>]}
[0m19:03:58.542040 [info ] [Thread-3 (]: 3 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[32mSUCCESS 1[0m in 7.01s]
[0m19:03:58.544050 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:03:59.970349 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:03:59.974358 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 19:03:57.020931 => 19:03:59.974358
[0m19:03:59.975362 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m19:04:00.489358 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f691a241-7aee-4068-aeb9-2b0db353f831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002211A1B53D0>]}
[0m19:04:00.490364 [info ] [Thread-2 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 3.48s]
[0m19:04:00.492361 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m19:04:00.494360 [debug] [Thread-1 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m19:04:00.494360 [info ] [Thread-1 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m19:04:00.496358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM, now model.dbt_poc.my_second_dbt_model)
[0m19:04:00.497364 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m19:04:00.520359 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m19:04:00.522359 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 19:04:00.497364 => 19:04:00.522359
[0m19:04:00.523361 [debug] [Thread-1 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m19:04:00.546360 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m19:04:00.549357 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m19:04:00.550364 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m19:04:00.551365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:03.184923 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:04:03.188922 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 19:04:00.529354 => 19:04:03.188922
[0m19:04:03.189927 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m19:04:03.705917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f691a241-7aee-4068-aeb9-2b0db353f831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002211AA7F310>]}
[0m19:04:03.706917 [info ] [Thread-1 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 3.21s]
[0m19:04:03.708926 [debug] [Thread-1 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m19:04:03.711915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:03.712921 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m19:04:03.712921 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m19:04:03.713921 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m19:04:03.714920 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m19:04:03.714920 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN' was properly closed.
[0m19:04:03.715919 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m19:04:03.716927 [info ] [MainThread]: 
[0m19:04:03.717920 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 19.11 seconds (19.11s).
[0m19:04:03.720915 [debug] [MainThread]: Command end result
[0m19:04:03.730918 [info ] [MainThread]: 
[0m19:04:03.732941 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:04:03.733925 [info ] [MainThread]: 
[0m19:04:03.734924 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:04:03.736929 [debug] [MainThread]: Command `dbt run` succeeded at 19:04:03.736929 after 20.94 seconds
[0m19:04:03.737929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002211144A4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022110FE0E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002210BFFA550>]}
[0m19:04:03.738930 [debug] [MainThread]: Flushing usage events
[0m19:04:03.886927 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:52:36.087382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002365C356590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002365CE97210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002365C830790>]}


============================== 19:52:36.104386 | 3e6c2b57-19aa-4085-a51d-6af408d3de94 ==============================
[0m19:52:36.104386 [info ] [MainThread]: Running with dbt=1.5.2
[0m19:52:36.105385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:52:43.202406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e6c2b57-19aa-4085-a51d-6af408d3de94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002365CE75050>]}
[0m19:52:43.224407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e6c2b57-19aa-4085-a51d-6af408d3de94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002366557E510>]}
[0m19:52:43.234403 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m19:52:43.315410 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m19:52:44.249414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:52:44.250417 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:52:44.357416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e6c2b57-19aa-4085-a51d-6af408d3de94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023665665B10>]}
[0m19:52:44.401414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e6c2b57-19aa-4085-a51d-6af408d3de94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236655AEA90>]}
[0m19:52:44.403410 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 323 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m19:52:44.512411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e6c2b57-19aa-4085-a51d-6af408d3de94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002366491E910>]}
[0m19:52:44.515407 [info ] [MainThread]: 
[0m19:52:44.517416 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:52:44.608415 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m19:52:44.630417 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m19:52:44.630417 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m19:52:44.631418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:48.048049 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m19:52:48.050046 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m19:52:48.589061 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m19:52:48.600061 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m19:52:48.601062 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m19:52:48.602063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:50.593060 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m19:52:50.597051 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m19:52:51.091066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e6c2b57-19aa-4085-a51d-6af408d3de94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023665588310>]}
[0m19:52:51.093069 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:52:51.094063 [info ] [MainThread]: 
[0m19:52:51.120069 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:52:51.121063 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:52:51.121063 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:52:51.122070 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:52:51.123060 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m19:52:51.136071 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m19:52:51.137061 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:52:51.142066 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m19:52:51.126057 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m19:52:51.144064 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m19:52:51.133062 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m19:52:51.145071 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:52:51.134063 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m19:52:51.147064 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 19:52:51.137061 => 19:52:51.146061
[0m19:52:51.148069 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m19:52:51.176068 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:52:51.177063 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m19:52:51.178058 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:52:51.179061 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:52:51.180068 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:52:51.196059 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 19:52:51.171076 => 19:52:51.196059
[0m19:52:51.236060 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m19:52:51.240064 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m19:52:51.245068 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m19:52:51.245068 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:52:51.246066 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:52:51.251065 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:52:51.252065 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 19:52:51.212056 => 19:52:51.252065
[0m19:52:51.253061 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 19:52:51.241061 => 19:52:51.253061
[0m19:52:51.254059 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:52:51.254059 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:52:51.255063 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:52:51.256061 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:52:51.259068 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:52:51.264057 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m19:52:51.316056 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m19:52:51.317056 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:52:51.319068 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:52:51.321060 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m19:52:51.324060 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join   COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m19:52:51.326063 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:52:53.853077 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:52:53.891076 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 19:52:51.264057 => 19:52:53.890074
[0m19:52:53.892069 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:52:53.893078 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:52:53.894068 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:52:53.895077 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m19:52:53.916067 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:52:53.918079 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m19:52:53.920067 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m19:52:53.926075 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:52:53.927074 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)



select *
from final
        );
[0m19:52:53.928076 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m19:52:53.935072 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m19:52:53.936073 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
        );
[0m19:52:53.937072 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_CAMPAIGN  a
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  b
on a.tag_id = b.id
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m19:52:54.460619 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e6c2b57-19aa-4085-a51d-6af408d3de94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023665E80910>]}
[0m19:52:54.461618 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 3.28s]
[0m19:52:54.463623 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m19:52:54.464628 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:52:54.465632 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m19:52:54.467632 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m19:52:54.467632 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:52:54.475628 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:52:54.477626 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 19:52:54.468632 => 19:52:54.476629
[0m19:52:54.478626 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:52:54.483629 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:52:54.485626 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m19:52:54.486631 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m19:52:54.487633 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:52:55.767728 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:52:55.772734 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 19:52:51.248076 => 19:52:55.771734
[0m19:52:55.773727 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m19:52:56.073737 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:52:56.077733 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 19:52:51.181060 => 19:52:56.077733
[0m19:52:56.078735 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m19:52:56.262731 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e6c2b57-19aa-4085-a51d-6af408d3de94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023666224410>]}
[0m19:52:56.264738 [info ] [Thread-2 (]: 2 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 5.12s]
[0m19:52:56.266733 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:52:56.267733 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m19:52:56.268736 [info ] [Thread-2 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m19:52:56.269736 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_first_dbt_model)
[0m19:52:56.272726 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m19:52:56.277732 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m19:52:56.280734 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 19:52:56.273732 => 19:52:56.279731
[0m19:52:56.281733 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m19:52:56.285732 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m19:52:56.288730 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m19:52:56.289734 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:52:56.290735 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:52:56.560732 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:52:56.564726 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 19:52:54.478626 => 19:52:56.564726
[0m19:52:56.565728 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m19:52:56.578724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e6c2b57-19aa-4085-a51d-6af408d3de94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023665E81250>]}
[0m19:52:56.580730 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 5.44s]
[0m19:52:56.581729 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m19:52:57.053738 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e6c2b57-19aa-4085-a51d-6af408d3de94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002365C360750>]}
[0m19:52:57.054736 [info ] [Thread-4 (]: 5 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.59s]
[0m19:52:57.057731 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m19:52:57.215726 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:52:57.218725 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 19:52:51.260061 => 19:52:57.218725
[0m19:52:57.219726 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m19:52:57.691734 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e6c2b57-19aa-4085-a51d-6af408d3de94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023665FEF150>]}
[0m19:52:57.692742 [info ] [Thread-3 (]: 3 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[32mSUCCESS 1[0m in 6.54s]
[0m19:52:57.694742 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m19:52:58.843738 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:52:58.847731 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 19:52:56.281733 => 19:52:58.847731
[0m19:52:58.848732 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m19:52:59.325302 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e6c2b57-19aa-4085-a51d-6af408d3de94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023665FEF150>]}
[0m19:52:59.327304 [info ] [Thread-2 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 3.06s]
[0m19:52:59.328302 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m19:52:59.330317 [debug] [Thread-1 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m19:52:59.331306 [info ] [Thread-1 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m19:52:59.339300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM, now model.dbt_poc.my_second_dbt_model)
[0m19:52:59.345298 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m19:52:59.355309 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m19:52:59.357301 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 19:52:59.348299 => 19:52:59.356308
[0m19:52:59.358300 [debug] [Thread-1 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m19:52:59.381307 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m19:52:59.394299 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m19:52:59.402298 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m19:52:59.403308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:01.514874 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:53:01.518874 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 19:52:59.360296 => 19:53:01.517871
[0m19:53:01.518874 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m19:53:02.006863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e6c2b57-19aa-4085-a51d-6af408d3de94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023665EBD110>]}
[0m19:53:02.007862 [info ] [Thread-1 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.67s]
[0m19:53:02.009873 [debug] [Thread-1 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m19:53:02.012873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:02.017866 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m19:53:02.021867 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m19:53:02.025867 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m19:53:02.029870 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m19:53:02.033875 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN' was properly closed.
[0m19:53:02.034869 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m19:53:02.035873 [info ] [MainThread]: 
[0m19:53:02.036874 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 17.52 seconds (17.52s).
[0m19:53:02.040867 [debug] [MainThread]: Command end result
[0m19:53:02.112875 [info ] [MainThread]: 
[0m19:53:02.173874 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:53:02.213873 [info ] [MainThread]: 
[0m19:53:02.218868 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:53:02.276878 [debug] [MainThread]: Command `dbt run` succeeded at 19:53:02.274869 after 26.67 seconds
[0m19:53:02.277877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002365C384150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002365743F350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002365743F310>]}
[0m19:53:02.300876 [debug] [MainThread]: Flushing usage events
[0m19:53:03.224871 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:00:28.507706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A50CE5EF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A50C970C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A50CED9CD0>]}


============================== 20:00:28.512705 | 0174f1b5-3882-4fc1-8924-59271b6dbb30 ==============================
[0m20:00:28.512705 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:00:28.513716 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:00:29.568719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0174f1b5-3882-4fc1-8924-59271b6dbb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A50D5986D0>]}
[0m20:00:29.590714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0174f1b5-3882-4fc1-8924-59271b6dbb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A515C38DD0>]}
[0m20:00:29.592712 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:00:29.653709 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:00:29.809714 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m20:00:29.810717 [debug] [MainThread]: Partial parsing: added file: dbt_poc://models\SQL_SCRIPTS\RBAC.sql
[0m20:00:29.811714 [debug] [MainThread]: Partial parsing: deleted file: dbt_poc://macros\RBAC.sql
[0m20:00:29.845717 [debug] [MainThread]: 1603: static parser failed on SQL_SCRIPTS\RBAC.sql
[0m20:00:29.872721 [debug] [MainThread]: 1602: parser fallback to jinja rendering on SQL_SCRIPTS\RBAC.sql
[0m20:00:29.889722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0174f1b5-3882-4fc1-8924-59271b6dbb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A515DE0050>]}
[0m20:00:29.900715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0174f1b5-3882-4fc1-8924-59271b6dbb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A515D44D90>]}
[0m20:00:29.901713 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m20:00:29.903720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0174f1b5-3882-4fc1-8924-59271b6dbb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A515C41A10>]}
[0m20:00:29.907721 [info ] [MainThread]: 
[0m20:00:29.908718 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:00:29.953721 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m20:00:29.986722 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m20:00:29.987722 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m20:00:29.988719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:32.594913 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m20:00:32.597912 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m20:00:33.152918 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m20:00:33.159916 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m20:00:33.160915 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m20:00:33.161915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:35.064076 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m20:00:35.067073 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m20:00:35.562064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0174f1b5-3882-4fc1-8924-59271b6dbb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A515C41BD0>]}
[0m20:00:35.563064 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:00:35.564064 [info ] [MainThread]: 
[0m20:00:35.611063 [debug] [Thread-1 (]: Began running node model.dbt_poc.RBAC
[0m20:00:35.612064 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:00:35.613069 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:00:35.613069 [debug] [Thread-4 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:00:35.614064 [info ] [Thread-1 (]: 1 of 8 START sql view model DIGITAL_SHELF_DBT.RBAC ............................. [RUN]
[0m20:00:35.615068 [info ] [Thread-2 (]: 2 of 8 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m20:00:35.617077 [info ] [Thread-3 (]: 3 of 8 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m20:00:35.618069 [info ] [Thread-4 (]: 4 of 8 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m20:00:35.619087 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.RBAC'
[0m20:00:35.621076 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m20:00:35.622076 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m20:00:35.627063 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m20:00:35.635069 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.RBAC
[0m20:00:35.637070 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:00:35.638081 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:00:35.639085 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:00:35.647064 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.RBAC"
[0m20:00:35.653075 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:00:35.661067 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:00:35.673076 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:00:35.674071 [debug] [Thread-1 (]: Timing info for model.dbt_poc.RBAC (compile): 20:00:35.640075 => 20:00:35.674071
[0m20:00:35.676074 [debug] [Thread-1 (]: Began executing node model.dbt_poc.RBAC
[0m20:00:35.697070 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:00:35.653075 => 20:00:35.697070
[0m20:00:35.698070 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 20:00:35.648064 => 20:00:35.698070
[0m20:00:35.758645 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.RBAC"
[0m20:00:35.759638 [debug] [Thread-4 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 20:00:35.664067 => 20:00:35.758645
[0m20:00:35.759638 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:00:35.760640 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:00:35.762636 [debug] [Thread-4 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:00:35.779633 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:00:35.783634 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:00:35.784633 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.RBAC"
[0m20:00:35.788639 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:00:35.789641 [debug] [Thread-3 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:00:35.790636 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:00:35.791640 [debug] [Thread-1 (]: On model.dbt_poc.RBAC: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.RBAC"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.RBAC
  
   as (
    
  );
[0m20:00:35.792641 [debug] [Thread-4 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:00:35.792641 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:00:35.793638 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:00:35.794632 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:00:35.795637 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:00:38.301218 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:00:38.321206 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:00:38.322213 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:00:38.325210 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:00:38.327214 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01add7a6-0d04-ccb4-0002-a6560104ec4a
[0m20:00:38.328213 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:00:38.329207 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 2 unexpected ')'.
[0m20:00:38.330216 [debug] [Thread-3 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)



select *
from final
        );
[0m20:00:38.332215 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:00:38.334213 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:00:38.335218 [debug] [Thread-1 (]: Timing info for model.dbt_poc.RBAC (execute): 20:00:35.677076 => 20:00:38.334213
[0m20:00:38.337218 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
        );
[0m20:00:38.340210 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:00:38.341213 [debug] [Thread-1 (]: On model.dbt_poc.RBAC: Close
[0m20:00:38.350208 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:00:38.352216 [debug] [Thread-4 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_CAMPAIGN  a
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  b
on a.tag_id = b.id
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m20:00:38.877209 [debug] [Thread-1 (]: Database Error in model RBAC (models\SQL_SCRIPTS\RBAC.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 2 unexpected ')'.
  compiled Code at target\run\dbt_poc\models\SQL_SCRIPTS\RBAC.sql
[0m20:00:38.878208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0174f1b5-3882-4fc1-8924-59271b6dbb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A515DBDF50>]}
[0m20:00:38.879208 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model DIGITAL_SHELF_DBT.RBAC .................... [[31mERROR[0m in 3.26s]
[0m20:00:38.881216 [debug] [Thread-1 (]: Finished running node model.dbt_poc.RBAC
[0m20:00:38.882223 [debug] [Thread-1 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:00:38.883222 [info ] [Thread-1 (]: 5 of 8 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m20:00:38.886213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.RBAC, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM)
[0m20:00:38.887221 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:00:38.895220 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:00:38.897220 [debug] [Thread-1 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 20:00:38.887221 => 20:00:38.896217
[0m20:00:38.897220 [debug] [Thread-1 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:00:38.903224 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:00:38.906222 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:00:38.907218 [debug] [Thread-1 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join   COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m20:00:38.907218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:39.581225 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:00:39.617213 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:00:35.762636 => 20:00:39.617213
[0m20:00:39.618211 [debug] [Thread-3 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:00:39.768225 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:00:39.773221 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 20:00:35.779633 => 20:00:39.773221
[0m20:00:39.774226 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m20:00:40.140216 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0174f1b5-3882-4fc1-8924-59271b6dbb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A51621F490>]}
[0m20:00:40.141216 [info ] [Thread-3 (]: 3 of 8 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 4.52s]
[0m20:00:40.143225 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:00:40.144225 [debug] [Thread-3 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:00:40.145225 [info ] [Thread-3 (]: 6 of 8 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m20:00:40.148223 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m20:00:40.149224 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:00:40.155222 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:00:40.157220 [debug] [Thread-3 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:00:40.150228 => 20:00:40.157220
[0m20:00:40.158221 [debug] [Thread-3 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:00:40.164218 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:00:40.166221 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:00:40.167224 [debug] [Thread-3 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m20:00:40.168228 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:40.274219 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0174f1b5-3882-4fc1-8924-59271b6dbb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A516751950>]}
[0m20:00:40.276215 [info ] [Thread-2 (]: 2 of 8 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.65s]
[0m20:00:40.280216 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:00:40.281218 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m20:00:40.282222 [info ] [Thread-2 (]: 7 of 8 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m20:00:40.284219 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM, now model.dbt_poc.my_first_dbt_model)
[0m20:00:40.285223 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m20:00:40.289222 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m20:00:40.291221 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 20:00:40.285223 => 20:00:40.291221
[0m20:00:40.293220 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m20:00:40.297221 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m20:00:40.402221 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m20:00:40.403217 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:00:40.403217 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:40.917218 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:00:40.922215 [debug] [Thread-1 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 20:00:38.898221 => 20:00:40.921216
[0m20:00:40.922215 [debug] [Thread-1 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m20:00:40.991217 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:00:40.995220 [debug] [Thread-4 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 20:00:35.784633 => 20:00:40.995220
[0m20:00:40.996218 [debug] [Thread-4 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m20:00:41.429215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0174f1b5-3882-4fc1-8924-59271b6dbb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A516774950>]}
[0m20:00:41.430215 [info ] [Thread-1 (]: 5 of 8 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 2.54s]
[0m20:00:41.432229 [debug] [Thread-1 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:00:41.516223 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0174f1b5-3882-4fc1-8924-59271b6dbb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A516610F90>]}
[0m20:00:41.518229 [info ] [Thread-4 (]: 4 of 8 OK created sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[32mSUCCESS 1[0m in 5.89s]
[0m20:00:41.524237 [debug] [Thread-4 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:00:42.608346 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:00:42.613338 [debug] [Thread-3 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:00:40.159222 => 20:00:42.613338
[0m20:00:42.614338 [debug] [Thread-3 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:00:43.103344 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0174f1b5-3882-4fc1-8924-59271b6dbb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A516C1A0D0>]}
[0m20:00:43.104343 [info ] [Thread-3 (]: 6 of 8 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.96s]
[0m20:00:43.106356 [debug] [Thread-3 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:00:43.120354 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:00:43.125353 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 20:00:40.293220 => 20:00:43.124350
[0m20:00:43.126357 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m20:00:43.724344 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0174f1b5-3882-4fc1-8924-59271b6dbb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A51672F4D0>]}
[0m20:00:43.725344 [info ] [Thread-2 (]: 7 of 8 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 3.44s]
[0m20:00:43.726350 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m20:00:43.728350 [debug] [Thread-1 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m20:00:43.729352 [info ] [Thread-1 (]: 8 of 8 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m20:00:43.731356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.my_second_dbt_model)
[0m20:00:43.731356 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m20:00:43.750352 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m20:00:43.756356 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 20:00:43.732358 => 20:00:43.755350
[0m20:00:43.756356 [debug] [Thread-1 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m20:00:43.780350 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m20:00:43.782355 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m20:00:43.783358 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m20:00:43.784360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:46.246355 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:00:46.249351 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 20:00:43.757358 => 20:00:46.249351
[0m20:00:46.249351 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m20:00:46.761353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0174f1b5-3882-4fc1-8924-59271b6dbb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A516024690>]}
[0m20:00:46.761353 [info ] [Thread-1 (]: 8 of 8 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 3.03s]
[0m20:00:46.763365 [debug] [Thread-1 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m20:00:46.766356 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:46.772357 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m20:00:46.781359 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m20:00:46.784356 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m20:00:46.788355 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m20:00:46.789364 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m20:00:46.790366 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN' was properly closed.
[0m20:00:46.790366 [info ] [MainThread]: 
[0m20:00:46.792367 [info ] [MainThread]: Finished running 4 view models, 4 table models in 0 hours 0 minutes and 16.88 seconds (16.88s).
[0m20:00:46.795365 [debug] [MainThread]: Command end result
[0m20:00:46.846367 [info ] [MainThread]: 
[0m20:00:46.847359 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:00:46.912354 [info ] [MainThread]: 
[0m20:00:46.962358 [error] [MainThread]: [33mDatabase Error in model RBAC (models\SQL_SCRIPTS\RBAC.sql)[0m
[0m20:00:46.992359 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m20:00:47.001361 [error] [MainThread]:   syntax error line 5 at position 2 unexpected ')'.
[0m20:00:47.002360 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\SQL_SCRIPTS\RBAC.sql
[0m20:00:47.003361 [info ] [MainThread]: 
[0m20:00:47.005362 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m20:00:47.008355 [debug] [MainThread]: Command `dbt run` failed at 20:00:47.006363 after 18.90 seconds
[0m20:00:47.013366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A507B3FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A507CC9450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A507CCBED0>]}
[0m20:00:47.020356 [debug] [MainThread]: Flushing usage events
[0m20:00:47.852361 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:01:29.347926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002321B071890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002321B084850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002321B03E790>]}


============================== 20:01:29.352926 | b622bb80-5ad3-45d1-a677-4ebe23f0c9ab ==============================
[0m20:01:29.352926 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:01:29.354939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:01:30.463942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b622bb80-5ad3-45d1-a677-4ebe23f0c9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002321BB75D90>]}
[0m20:01:30.475929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b622bb80-5ad3-45d1-a677-4ebe23f0c9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023224307290>]}
[0m20:01:30.477929 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:01:30.520929 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:01:30.665940 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m20:01:30.666943 [debug] [MainThread]: Partial parsing: added file: dbt_poc://macros\RBAC.sql
[0m20:01:30.667943 [debug] [MainThread]: Partial parsing: deleted file: dbt_poc://models\SQL_SCRIPTS\RBAC.sql
[0m20:01:30.695930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b622bb80-5ad3-45d1-a677-4ebe23f0c9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232228038D0>]}
[0m20:01:30.708937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b622bb80-5ad3-45d1-a677-4ebe23f0c9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232243F0210>]}
[0m20:01:30.709941 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 323 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m20:01:30.735941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b622bb80-5ad3-45d1-a677-4ebe23f0c9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023217262950>]}
[0m20:01:30.738942 [info ] [MainThread]: 
[0m20:01:30.742931 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:01:30.745934 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m20:01:30.778943 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m20:01:30.779940 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m20:01:30.781944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:32.998945 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m20:01:33.001933 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m20:01:33.519946 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m20:01:33.529950 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m20:01:33.530952 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m20:01:33.531953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:35.360559 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m20:01:35.363552 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m20:01:35.864556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b622bb80-5ad3-45d1-a677-4ebe23f0c9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002322437F210>]}
[0m20:01:35.865555 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:01:35.867567 [info ] [MainThread]: 
[0m20:01:35.922560 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:01:35.923565 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:01:35.923565 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:01:35.924562 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:01:35.925568 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m20:01:35.926569 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m20:01:35.927566 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m20:01:35.935138 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m20:01:35.935138 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:01:35.929570 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m20:01:35.931569 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m20:01:35.933130 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m20:01:35.954132 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m20:01:35.958139 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:01:35.959129 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:01:35.960132 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:01:35.961129 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:01:35.968133 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:01:35.985130 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:01:35.988139 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:01:35.988139 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 20:01:35.936139 => 20:01:35.988139
[0m20:01:35.991130 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 20:01:35.962130 => 20:01:35.990139
[0m20:01:35.992135 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:01:35.992135 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 20:01:35.981145 => 20:01:35.992135
[0m20:01:35.993137 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:01:35.994130 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:01:35.968133 => 20:01:35.994130
[0m20:01:36.037127 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:01:36.038127 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:01:36.044127 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:01:36.045127 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:01:36.046138 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:01:36.090137 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:01:36.091131 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:01:36.095136 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:01:36.096133 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:01:36.097130 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:01:36.098129 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:01:36.099137 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:01:36.106138 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:01:36.107134 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join   COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m20:01:36.111134 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:01:38.743307 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:01:38.757302 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:01:38.760302 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:01:38.761309 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)



select *
from final
        );
[0m20:01:38.780308 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:01:38.782309 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:01:38.785305 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:01:38.786308 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
        );
[0m20:01:38.833301 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:01:38.835293 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:01:38.841296 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:01:38.841296 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_CAMPAIGN  a
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  b
on a.tag_id = b.id
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m20:01:38.854304 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:01:38.887309 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 20:01:36.047138 => 20:01:38.886310
[0m20:01:38.887309 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m20:01:39.374307 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b622bb80-5ad3-45d1-a677-4ebe23f0c9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023224345190>]}
[0m20:01:39.375310 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 3.43s]
[0m20:01:39.377305 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:01:39.378321 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:01:39.379309 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m20:01:39.381307 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m20:01:39.382305 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:01:39.389306 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:01:39.391303 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:01:39.382305 => 20:01:39.391303
[0m20:01:39.392310 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:01:39.397306 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:01:39.400304 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:01:39.401306 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m20:01:39.402303 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:01:40.134314 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:01:40.138304 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 20:01:36.039129 => 20:01:40.138304
[0m20:01:40.139300 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:01:40.140305 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m20:01:40.144303 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:01:36.091131 => 20:01:40.143307
[0m20:01:40.147307 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:01:40.622311 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b622bb80-5ad3-45d1-a677-4ebe23f0c9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023224C05190>]}
[0m20:01:40.623318 [info ] [Thread-2 (]: 2 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 4.69s]
[0m20:01:40.625309 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:01:40.626312 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m20:01:40.627314 [info ] [Thread-2 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m20:01:40.630305 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_first_dbt_model)
[0m20:01:40.631313 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m20:01:40.636307 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m20:01:40.638308 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 20:01:40.632314 => 20:01:40.637314
[0m20:01:40.639316 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m20:01:40.643308 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m20:01:40.646308 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m20:01:40.647314 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:01:40.648315 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:01:40.662308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b622bb80-5ad3-45d1-a677-4ebe23f0c9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023224C51C50>]}
[0m20:01:40.664310 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.73s]
[0m20:01:40.671310 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:01:41.174311 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:01:41.178302 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 20:01:35.994130 => 20:01:41.178302
[0m20:01:41.179302 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m20:01:41.349318 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:01:41.354315 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:01:39.393306 => 20:01:41.353314
[0m20:01:41.355314 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:01:41.676314 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b622bb80-5ad3-45d1-a677-4ebe23f0c9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023224CDB950>]}
[0m20:01:41.677318 [info ] [Thread-3 (]: 3 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[32mSUCCESS 1[0m in 5.74s]
[0m20:01:41.724308 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:01:41.839307 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b622bb80-5ad3-45d1-a677-4ebe23f0c9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023224D17D10>]}
[0m20:01:41.841316 [info ] [Thread-4 (]: 5 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.46s]
[0m20:01:41.848319 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:01:42.916309 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:01:42.920304 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 20:01:40.639316 => 20:01:42.920304
[0m20:01:42.921313 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m20:01:43.400309 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b622bb80-5ad3-45d1-a677-4ebe23f0c9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023224338490>]}
[0m20:01:43.401309 [info ] [Thread-2 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 2.77s]
[0m20:01:43.403319 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m20:01:43.405321 [debug] [Thread-1 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m20:01:43.406320 [info ] [Thread-1 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m20:01:43.417313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM, now model.dbt_poc.my_second_dbt_model)
[0m20:01:43.423311 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m20:01:43.434321 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m20:01:43.436314 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 20:01:43.426314 => 20:01:43.435321
[0m20:01:43.436314 [debug] [Thread-1 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m20:01:43.457319 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m20:01:43.459315 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m20:01:43.460321 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m20:01:43.461323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:01:45.455454 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:01:45.459444 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 20:01:43.440320 => 20:01:45.459444
[0m20:01:45.460444 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m20:01:45.963449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b622bb80-5ad3-45d1-a677-4ebe23f0c9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023224349F10>]}
[0m20:01:45.964459 [info ] [Thread-1 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.55s]
[0m20:01:45.966458 [debug] [Thread-1 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m20:01:45.969456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:01:45.970461 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m20:01:45.971451 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m20:01:45.971451 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m20:01:45.972448 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m20:01:46.021449 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN' was properly closed.
[0m20:01:46.022447 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m20:01:46.023447 [info ] [MainThread]: 
[0m20:01:46.024453 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 15.28 seconds (15.28s).
[0m20:01:46.027453 [debug] [MainThread]: Command end result
[0m20:01:46.081448 [info ] [MainThread]: 
[0m20:01:46.084454 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:01:46.085449 [info ] [MainThread]: 
[0m20:01:46.086451 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m20:01:46.089451 [debug] [MainThread]: Command `dbt run` succeeded at 20:01:46.088457 after 17.10 seconds
[0m20:01:46.090460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002321BB99090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002321B574150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002321B03F110>]}
[0m20:01:46.091461 [debug] [MainThread]: Flushing usage events
[0m20:01:46.971453 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:03:09.222280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018995E51890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018995E41950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018995E41CD0>]}


============================== 20:03:09.227273 | 163f1523-a1f1-4580-baa8-78c6671514b0 ==============================
[0m20:03:09.227273 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:03:09.229288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:03:10.282289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '163f1523-a1f1-4580-baa8-78c6671514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018995E41950>]}
[0m20:03:10.301282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '163f1523-a1f1-4580-baa8-78c6671514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001899EC07510>]}
[0m20:03:10.303290 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:03:10.367277 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:03:10.498291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:03:10.498291 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:03:10.510290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '163f1523-a1f1-4580-baa8-78c6671514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001899ED34150>]}
[0m20:03:10.522277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '163f1523-a1f1-4580-baa8-78c6671514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001899ED9AA90>]}
[0m20:03:10.523276 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 323 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m20:03:10.525301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '163f1523-a1f1-4580-baa8-78c6671514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018991C12990>]}
[0m20:03:10.528286 [info ] [MainThread]: 
[0m20:03:10.530283 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:03:10.588278 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m20:03:10.635282 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m20:03:10.636285 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m20:03:10.638282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:12.988284 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m20:03:12.990284 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m20:03:13.480286 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m20:03:13.491298 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m20:03:13.492301 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m20:03:13.493299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:15.403051 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m20:03:15.406050 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m20:03:15.892064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '163f1523-a1f1-4580-baa8-78c6671514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001899CFA8B90>]}
[0m20:03:15.894052 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:03:15.915058 [info ] [MainThread]: 
[0m20:03:15.962052 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:03:15.967063 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:03:15.963051 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:03:15.964057 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:03:15.966063 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m20:03:15.984066 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m20:03:15.985066 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:03:15.968065 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m20:03:15.990052 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:03:15.969064 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m20:03:15.992058 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m20:03:15.970057 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m20:03:15.993060 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m20:03:15.994063 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:03:15.995058 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 20:03:15.986062 => 20:03:15.995058
[0m20:03:15.997057 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m20:03:15.998063 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:03:16.007054 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:03:16.012055 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:03:16.015056 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:03:16.020055 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:03:16.079059 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:03:16.086052 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:03:16.090062 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 20:03:16.080052 => 20:03:16.090062
[0m20:03:16.088059 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:03:16.094055 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:03:16.087059 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 20:03:15.998063 => 20:03:16.087059
[0m20:03:16.091065 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:03:16.104059 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:03:16.015056 => 20:03:16.103055
[0m20:03:16.104059 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:03:16.110059 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:03:16.111058 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:03:16.139052 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:03:16.149065 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:03:16.156065 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:03:16.157067 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:03:16.158066 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:03:16.163063 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:03:16.161060 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:03:16.167057 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join   COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m20:03:16.168066 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:03:18.745067 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:03:18.766060 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:03:18.768069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:03:18.771072 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:03:18.775060 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:03:18.776060 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_CAMPAIGN  a
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  b
on a.tag_id = b.id
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m20:03:18.778071 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:03:18.781061 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
        );
[0m20:03:18.824074 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:03:18.827073 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:03:18.829071 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:03:18.830067 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)



select *
from final
        );
[0m20:03:18.947066 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:03:18.983075 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 20:03:16.112063 => 20:03:18.982071
[0m20:03:18.984075 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m20:03:19.503071 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '163f1523-a1f1-4580-baa8-78c6671514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001899F49F950>]}
[0m20:03:19.504076 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 3.51s]
[0m20:03:19.506068 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:03:19.507067 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:03:19.508072 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m20:03:19.510071 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m20:03:19.510071 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:03:19.518070 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:03:19.520071 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:03:19.511076 => 20:03:19.519071
[0m20:03:19.527067 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:03:19.547063 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:03:19.549067 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:03:19.550067 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m20:03:19.578073 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:03:19.810065 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:03:19.814064 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:03:16.150059 => 20:03:19.813065
[0m20:03:19.815071 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:03:20.194071 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:03:20.198064 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 20:03:16.021059 => 20:03:20.197064
[0m20:03:20.199064 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m20:03:20.346070 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '163f1523-a1f1-4580-baa8-78c6671514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001899F5C4C10>]}
[0m20:03:20.348076 [info ] [Thread-2 (]: 2 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 4.35s]
[0m20:03:20.349074 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:03:20.350074 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m20:03:20.351079 [info ] [Thread-2 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m20:03:20.353077 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_first_dbt_model)
[0m20:03:20.354075 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m20:03:20.360070 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m20:03:20.362068 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 20:03:20.354075 => 20:03:20.362068
[0m20:03:20.363074 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m20:03:20.367071 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m20:03:20.370069 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m20:03:20.371077 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:03:20.372075 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:03:20.684076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '163f1523-a1f1-4580-baa8-78c6671514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001899F457410>]}
[0m20:03:20.685080 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.70s]
[0m20:03:20.687081 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:03:21.485076 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:03:21.487068 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 20:03:16.106058 => 20:03:21.487068
[0m20:03:21.488067 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m20:03:21.566082 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:03:21.569068 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:03:19.529076 => 20:03:21.569068
[0m20:03:21.570068 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:03:21.982069 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '163f1523-a1f1-4580-baa8-78c6671514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001899F0CFE10>]}
[0m20:03:21.983069 [info ] [Thread-3 (]: 3 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[32mSUCCESS 1[0m in 5.99s]
[0m20:03:21.984075 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:03:22.083082 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '163f1523-a1f1-4580-baa8-78c6671514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001899ED4CBD0>]}
[0m20:03:22.084081 [info ] [Thread-4 (]: 5 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.57s]
[0m20:03:22.086081 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:03:22.820648 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:03:22.824641 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 20:03:20.364074 => 20:03:22.824641
[0m20:03:22.825641 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m20:03:23.304651 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '163f1523-a1f1-4580-baa8-78c6671514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001899F683550>]}
[0m20:03:23.305646 [info ] [Thread-2 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 2.95s]
[0m20:03:23.307656 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m20:03:23.309655 [debug] [Thread-1 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m20:03:23.310654 [info ] [Thread-1 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m20:03:23.323650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM, now model.dbt_poc.my_second_dbt_model)
[0m20:03:23.328654 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m20:03:23.333660 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m20:03:23.335652 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 20:03:23.329651 => 20:03:23.335652
[0m20:03:23.336653 [debug] [Thread-1 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m20:03:23.341656 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m20:03:23.343658 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m20:03:23.346647 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m20:03:23.350650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:25.555220 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:03:25.559213 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 20:03:23.336653 => 20:03:25.559213
[0m20:03:25.560213 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m20:03:26.058217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '163f1523-a1f1-4580-baa8-78c6671514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001899ECDB950>]}
[0m20:03:26.060214 [info ] [Thread-1 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.74s]
[0m20:03:26.062229 [debug] [Thread-1 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m20:03:26.065228 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:03:26.065228 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m20:03:26.071218 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m20:03:26.078218 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m20:03:26.083216 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m20:03:26.086217 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m20:03:26.087222 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN' was properly closed.
[0m20:03:26.088222 [info ] [MainThread]: 
[0m20:03:26.089221 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 15.56 seconds (15.56s).
[0m20:03:26.093226 [debug] [MainThread]: Command end result
[0m20:03:26.126221 [info ] [MainThread]: 
[0m20:03:26.136219 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:03:26.201220 [info ] [MainThread]: 
[0m20:03:26.302236 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m20:03:26.337215 [debug] [MainThread]: Command `dbt run` succeeded at 20:03:26.336217 after 17.48 seconds
[0m20:03:26.338215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001899593F250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018995F32850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018990E7BFD0>]}
[0m20:03:26.338215 [debug] [MainThread]: Flushing usage events
[0m20:03:27.227218 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:10:33.459692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F8D76590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F8D5F810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F8862D10>]}


============================== 20:10:33.473691 | 6d3ee6ad-6382-4bc2-a169-2bb1f9854a1f ==============================
[0m20:10:33.473691 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:10:33.475703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:10:39.977857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d3ee6ad-6382-4bc2-a169-2bb1f9854a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A681B54150>]}
[0m20:10:39.998850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d3ee6ad-6382-4bc2-a169-2bb1f9854a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A681B38B90>]}
[0m20:10:40.007862 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:10:40.081849 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:10:40.868851 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m20:10:40.869851 [debug] [MainThread]: Partial parsing: added file: dbt_poc://macros\SQL_SCRIPTS\RBAC.sql
[0m20:10:40.870853 [debug] [MainThread]: Partial parsing: added file: dbt_poc://macros\External_tables\NADL_CORE_IMS_FLU.sql
[0m20:10:40.871853 [debug] [MainThread]: Partial parsing: deleted file: dbt_poc://macros\RBAC.sql
[0m20:10:40.893865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d3ee6ad-6382-4bc2-a169-2bb1f9854a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6800A7BD0>]}
[0m20:10:40.904863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d3ee6ad-6382-4bc2-a169-2bb1f9854a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A681B41290>]}
[0m20:10:40.905862 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m20:10:40.907861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d3ee6ad-6382-4bc2-a169-2bb1f9854a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F4A12850>]}
[0m20:10:40.909859 [info ] [MainThread]: 
[0m20:10:40.911863 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:10:40.962872 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m20:10:41.012867 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m20:10:41.013866 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m20:10:41.014863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:43.837873 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m20:10:43.840868 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m20:10:44.332870 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m20:10:44.342863 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m20:10:44.343862 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m20:10:44.343862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:46.217877 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m20:10:46.220867 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m20:10:46.722869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d3ee6ad-6382-4bc2-a169-2bb1f9854a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F8D5DA90>]}
[0m20:10:46.723867 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:10:46.725878 [info ] [MainThread]: 
[0m20:10:46.763869 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:10:46.763869 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:10:46.764875 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:10:46.765873 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:10:46.765873 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m20:10:46.767874 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m20:10:46.768876 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m20:10:46.769879 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m20:10:46.771882 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m20:10:46.772874 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m20:10:46.774872 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m20:10:46.775879 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m20:10:46.776882 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:10:46.777879 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:10:46.778877 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:10:46.779882 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:10:46.794872 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:10:46.799883 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:10:46.806869 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:10:46.811885 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:10:46.813877 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 20:10:46.779882 => 20:10:46.813877
[0m20:10:46.820874 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 20:10:46.800882 => 20:10:46.817871
[0m20:10:46.826884 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:10:46.826884 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:10:46.827879 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 20:10:46.806869 => 20:10:46.827879
[0m20:10:46.905874 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:10:46.906871 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:10:46.795873 => 20:10:46.906871
[0m20:10:46.907875 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:10:46.912881 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:10:46.946869 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:10:46.946869 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:10:46.947869 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:10:46.948872 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:10:46.952870 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:10:46.953882 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:10:46.954875 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:10:46.955870 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:10:46.956875 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:10:46.959879 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join   COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m20:10:46.963876 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:10:46.965872 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:10:49.415182 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:10:49.438187 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:10:49.440188 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:10:49.442192 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:10:49.445191 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:10:49.446193 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
        );
[0m20:10:49.447187 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:10:49.452182 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:10:49.456190 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:10:49.457189 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_CAMPAIGN  a
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  b
on a.tag_id = b.id
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m20:10:49.461185 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:10:49.462184 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)



select *
from final
        );
[0m20:10:49.489187 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:10:49.522179 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 20:10:46.913884 => 20:10:49.522179
[0m20:10:49.523182 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m20:10:50.009183 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d3ee6ad-6382-4bc2-a169-2bb1f9854a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6823EEDD0>]}
[0m20:10:50.010184 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 3.23s]
[0m20:10:50.012192 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:10:50.013194 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:10:50.014192 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m20:10:50.016201 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m20:10:50.016201 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:10:50.050185 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:10:50.052190 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:10:50.017196 => 20:10:50.052190
[0m20:10:50.053194 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:10:50.059183 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:10:50.061188 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:10:50.062195 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m20:10:50.063195 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:10:50.717196 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:10:50.721192 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:10:46.949881 => 20:10:50.721192
[0m20:10:50.722196 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:10:50.740190 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:10:50.744181 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 20:10:46.828884 => 20:10:50.744181
[0m20:10:50.745181 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m20:10:51.201187 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d3ee6ad-6382-4bc2-a169-2bb1f9854a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A681C46990>]}
[0m20:10:51.202184 [info ] [Thread-2 (]: 2 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 4.43s]
[0m20:10:51.204195 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:10:51.205195 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m20:10:51.206194 [info ] [Thread-2 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m20:10:51.209185 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_first_dbt_model)
[0m20:10:51.210193 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m20:10:51.215192 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m20:10:51.217189 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 20:10:51.211192 => 20:10:51.217189
[0m20:10:51.218192 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m20:10:51.222194 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m20:10:51.226188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d3ee6ad-6382-4bc2-a169-2bb1f9854a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A681CA4790>]}
[0m20:10:51.236192 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.46s]
[0m20:10:51.243194 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:10:51.251198 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m20:10:51.252199 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:10:51.253200 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:10:51.754190 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:10:51.758185 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 20:10:46.864869 => 20:10:51.758185
[0m20:10:51.759186 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m20:10:52.024191 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:10:52.030186 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:10:50.054186 => 20:10:52.030186
[0m20:10:52.031187 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:10:52.260187 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d3ee6ad-6382-4bc2-a169-2bb1f9854a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6824D1F10>]}
[0m20:10:52.261187 [info ] [Thread-3 (]: 3 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[32mSUCCESS 1[0m in 5.49s]
[0m20:10:52.262200 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:10:52.521188 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d3ee6ad-6382-4bc2-a169-2bb1f9854a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A681C9B590>]}
[0m20:10:52.523186 [info ] [Thread-4 (]: 5 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.51s]
[0m20:10:52.525202 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:10:53.675195 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:10:53.679191 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 20:10:51.218192 => 20:10:53.678191
[0m20:10:53.680192 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m20:10:54.176204 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d3ee6ad-6382-4bc2-a169-2bb1f9854a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A681B56410>]}
[0m20:10:54.178194 [info ] [Thread-2 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 2.97s]
[0m20:10:54.179205 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m20:10:54.181198 [debug] [Thread-1 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m20:10:54.182204 [info ] [Thread-1 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m20:10:54.193199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM, now model.dbt_poc.my_second_dbt_model)
[0m20:10:54.202199 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m20:10:54.206201 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m20:10:54.208195 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 20:10:54.202199 => 20:10:54.207197
[0m20:10:54.215197 [debug] [Thread-1 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m20:10:54.235195 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m20:10:54.252196 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m20:10:54.253207 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m20:10:54.253207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:56.139712 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:10:56.143710 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 20:10:54.223196 => 20:10:56.142710
[0m20:10:56.144722 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m20:10:56.627714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d3ee6ad-6382-4bc2-a169-2bb1f9854a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A681B416D0>]}
[0m20:10:56.628714 [info ] [Thread-1 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.44s]
[0m20:10:56.630724 [debug] [Thread-1 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m20:10:56.634714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:56.639721 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m20:10:56.642720 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m20:10:56.648717 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m20:10:56.653720 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m20:10:56.654726 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN' was properly closed.
[0m20:10:56.655728 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m20:10:56.656726 [info ] [MainThread]: 
[0m20:10:56.657727 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 15.74 seconds (15.74s).
[0m20:10:56.684717 [debug] [MainThread]: Command end result
[0m20:10:56.743727 [info ] [MainThread]: 
[0m20:10:56.745724 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:10:56.804728 [info ] [MainThread]: 
[0m20:10:56.832720 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m20:10:56.838726 [debug] [MainThread]: Command `dbt run` succeeded at 20:10:56.838726 after 23.82 seconds
[0m20:10:56.840719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F8D74150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F89F0810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F8829290>]}
[0m20:10:56.864717 [debug] [MainThread]: Flushing usage events
[0m20:10:57.878728 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:51:08.237245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021567676C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021566B723D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021566B3E350>]}


============================== 20:51:08.253249 | d4d501f6-7913-46ba-ac08-ceb34ee52542 ==============================
[0m20:51:08.253249 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:51:08.257246 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:51:08.258254 [info ] [MainThread]: dbt version: 1.5.2
[0m20:51:08.278249 [info ] [MainThread]: python version: 3.11.4
[0m20:51:08.279245 [info ] [MainThread]: python path: C:\Users\SNando01\dbt-venv\Scripts\python.exe
[0m20:51:08.280246 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m20:51:08.281242 [info ] [MainThread]: Using profiles.yml file at C:\Users\SNando01\.dbt\profiles.yml
[0m20:51:08.282253 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SNando01\DBT_POC\dbt_project.yml
[0m20:51:08.284251 [info ] [MainThread]: Configuration:
[0m20:51:15.109705 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:51:15.189703 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:51:15.211706 [info ] [MainThread]: Required dependencies:
[0m20:51:15.212709 [debug] [MainThread]: Executing "git --help"
[0m20:51:15.925820 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:51:15.926827 [debug] [MainThread]: STDERR: "b''"
[0m20:51:15.927824 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:51:15.929831 [info ] [MainThread]: Connection:
[0m20:51:15.930826 [info ] [MainThread]:   account: bk40750.east-us-2.azure
[0m20:51:15.931822 [info ] [MainThread]:   user: MHennes3
[0m20:51:15.932822 [info ] [MainThread]:   database: COMMEX_DB
[0m20:51:15.933824 [info ] [MainThread]:   schema: DIGITAL_SHELF_DBT
[0m20:51:15.934824 [info ] [MainThread]:   warehouse: DEV_COMX_GLOBAL_APP1_WH
[0m20:51:15.960829 [info ] [MainThread]:   role: DEV_COMX_GLOBAL_DEVELOPER_FR
[0m20:51:15.961824 [info ] [MainThread]:   client_session_keep_alive: False
[0m20:51:15.962831 [info ] [MainThread]:   query_tag: None
[0m20:51:15.974830 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:51:15.976824 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m20:51:15.977826 [debug] [MainThread]: Using snowflake connection "debug"
[0m20:51:15.986823 [debug] [MainThread]: On debug: select 1 as id
[0m20:51:15.987835 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:51:18.859934 [debug] [MainThread]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:51:18.861930 [debug] [MainThread]: On debug: Close
[0m20:51:19.355934 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:51:19.357948 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:51:19.359936 [debug] [MainThread]: Command `dbt debug` succeeded at 20:51:19.359936 after 11.66 seconds
[0m20:51:19.360941 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:51:19.361941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002156753AD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021566BEA890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002156FE01A10>]}
[0m20:51:19.364940 [debug] [MainThread]: Flushing usage events
[0m20:51:20.284935 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:52:58.678672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E21829B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E21DDA190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E1E8C0390>]}


============================== 20:52:58.694668 | 8952005c-6bf2-4b9a-a8cb-d11b1a7c0ccd ==============================
[0m20:52:58.694668 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:52:58.696670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:53:05.582046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8952005c-6bf2-4b9a-a8cb-d11b1a7c0ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E22394F50>]}
[0m20:53:05.603046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8952005c-6bf2-4b9a-a8cb-d11b1a7c0ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E2AA30450>]}
[0m20:53:05.611046 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:53:05.679046 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:53:06.431048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:53:06.432049 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://macros\External_tables\NADL_CORE_IMS_FLU.sql
[0m20:53:06.453054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8952005c-6bf2-4b9a-a8cb-d11b1a7c0ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E2AB44150>]}
[0m20:53:06.469059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8952005c-6bf2-4b9a-a8cb-d11b1a7c0ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E2AAE1390>]}
[0m20:53:06.471063 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m20:53:06.489053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8952005c-6bf2-4b9a-a8cb-d11b1a7c0ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E1DA12950>]}
[0m20:53:06.494058 [info ] [MainThread]: 
[0m20:53:06.496062 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:53:06.502049 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m20:53:06.551062 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m20:53:06.552058 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m20:53:06.553064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:09.690271 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 3.0 seconds
[0m20:53:09.694272 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m20:53:10.194911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8952005c-6bf2-4b9a-a8cb-d11b1a7c0ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E2AAF0B50>]}
[0m20:53:10.196906 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:53:10.202911 [info ] [MainThread]: 
[0m20:53:10.244904 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:53:10.245904 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:53:10.245904 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:53:10.246910 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:53:10.247904 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m20:53:10.249905 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m20:53:10.250908 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m20:53:10.251904 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m20:53:10.252905 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:53:10.253906 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:53:10.254911 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:53:10.255916 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:53:10.267920 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:53:10.272904 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:53:10.278917 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:53:10.283917 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:53:10.286912 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:53:10.267920 => 20:53:10.286912
[0m20:53:10.297906 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:53:10.288916 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 20:53:10.273915 => 20:53:10.287919
[0m20:53:10.287919 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 20:53:10.255916 => 20:53:10.286912
[0m20:53:10.298915 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:53:10.298915 => 20:53:10.298915
[0m20:53:10.299925 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 20:53:10.279917 => 20:53:10.299925
[0m20:53:10.300918 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:53:10.301925 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:53:10.303906 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:53:10.303906 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:53:10.304914 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 20:53:10.304914 => 20:53:10.304914
[0m20:53:10.305906 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 20:53:10.305906 => 20:53:10.305906
[0m20:53:10.306915 [debug] [Thread-2 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:53:10.307907 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 20:53:10.307907 => 20:53:10.307907
[0m20:53:10.309908 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:53:10.310910 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:53:10.311909 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m20:53:10.313907 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:53:10.314912 [debug] [Thread-3 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m20:53:10.315912 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:53:10.317912 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN, now model.dbt_poc.my_first_dbt_model)
[0m20:53:10.330914 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:53:10.331909 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m20:53:10.336912 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m20:53:10.337910 [debug] [Thread-2 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:53:10.318908 => 20:53:10.337910
[0m20:53:10.338908 [debug] [Thread-2 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:53:10.339912 [debug] [Thread-2 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:53:10.338908 => 20:53:10.338908
[0m20:53:10.339912 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 20:53:10.332913 => 20:53:10.339912
[0m20:53:10.341908 [debug] [Thread-2 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:53:10.342920 [debug] [Thread-3 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m20:53:10.343916 [debug] [Thread-3 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 20:53:10.343916 => 20:53:10.343916
[0m20:53:10.345920 [debug] [Thread-3 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m20:53:10.346913 [debug] [Thread-1 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m20:53:10.348916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM, now model.dbt_poc.my_second_dbt_model)
[0m20:53:10.348916 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m20:53:10.353917 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m20:53:10.355918 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 20:53:10.349920 => 20:53:10.354915
[0m20:53:10.355918 [debug] [Thread-1 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m20:53:10.356920 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 20:53:10.356920 => 20:53:10.356920
[0m20:53:10.358917 [debug] [Thread-1 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m20:53:10.360916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:53:10.361916 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m20:53:10.362917 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m20:53:10.362917 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m20:53:10.363919 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m20:53:10.364912 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM' was properly closed.
[0m20:53:10.367913 [debug] [MainThread]: Command end result
[0m20:53:10.381919 [debug] [MainThread]: Command `dbt compile` succeeded at 20:53:10.380917 after 12.17 seconds
[0m20:53:10.382917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E22396E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E21D74150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E200A4D90>]}
[0m20:53:10.383914 [debug] [MainThread]: Flushing usage events
[0m20:53:11.325515 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:53:29.874942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017987196F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017986656D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017986B42C50>]}


============================== 20:53:29.879953 | 84beddbf-fa7f-44ec-b178-5b465ef6e771 ==============================
[0m20:53:29.879953 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:53:29.881953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:53:30.844938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84beddbf-fa7f-44ec-b178-5b465ef6e771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179842ACED0>]}
[0m20:53:30.862949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84beddbf-fa7f-44ec-b178-5b465ef6e771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001798F945BD0>]}
[0m20:53:30.864957 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m20:53:30.904955 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:53:31.018955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:53:31.018955 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:53:31.029954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84beddbf-fa7f-44ec-b178-5b465ef6e771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001798FA44090>]}
[0m20:53:31.045949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84beddbf-fa7f-44ec-b178-5b465ef6e771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001798F98A550>]}
[0m20:53:31.046950 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m20:53:31.048957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84beddbf-fa7f-44ec-b178-5b465ef6e771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017982812950>]}
[0m20:53:31.051956 [info ] [MainThread]: 
[0m20:53:31.052946 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:53:31.115943 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m20:53:31.150954 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m20:53:31.150954 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m20:53:31.151957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:33.334948 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m20:53:33.336948 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m20:53:33.832951 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m20:53:33.840950 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m20:53:33.841950 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m20:53:33.842950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:35.669957 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m20:53:35.671952 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m20:53:36.189956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84beddbf-fa7f-44ec-b178-5b465ef6e771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017986BE0DD0>]}
[0m20:53:36.191971 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:53:36.192961 [info ] [MainThread]: 
[0m20:53:36.213969 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:53:36.214957 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:53:36.215959 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:53:36.215959 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:53:36.216961 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m20:53:36.217959 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m20:53:36.218970 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m20:53:36.220965 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m20:53:36.222971 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m20:53:36.223966 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m20:53:36.235959 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:53:36.224967 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m20:53:36.226968 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:53:36.225971 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m20:53:36.243967 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:53:36.244960 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:53:36.249962 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:53:36.257970 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:53:36.238969 => 20:53:36.257970
[0m20:53:36.273959 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:53:36.250967 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:53:36.256970 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:53:36.274965 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 20:53:36.245961 => 20:53:36.274965
[0m20:53:36.303968 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:53:36.352960 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:53:36.353962 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:53:36.355969 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 20:53:36.251972 => 20:53:36.354963
[0m20:53:36.355969 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:53:36.357966 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 20:53:36.298959 => 20:53:36.356960
[0m20:53:36.361970 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:53:36.361970 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:53:36.362965 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:53:36.363963 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:53:36.364969 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:53:36.368967 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:53:36.403962 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:53:36.407957 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:53:36.408966 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:53:36.413967 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:53:36.416963 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m20:53:36.418961 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join   COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m20:53:36.420961 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:53:38.985978 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:53:39.009964 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:53:39.010969 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:53:39.014976 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:53:39.015975 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:53:39.017968 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:53:39.051963 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 20:53:36.371964 => 20:53:39.050964
[0m20:53:39.052971 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)



select *
from final
        );
[0m20:53:39.053970 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:53:39.058964 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m20:53:39.058964 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m20:53:39.062976 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:53:39.064969 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_CAMPAIGN  a
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  b
on a.tag_id = b.id
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m20:53:39.072977 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m20:53:39.073974 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
        );
[0m20:53:39.563966 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84beddbf-fa7f-44ec-b178-5b465ef6e771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001798F9E6CD0>]}
[0m20:53:39.564965 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 3.34s]
[0m20:53:39.566975 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m20:53:39.567975 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:53:39.568979 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m20:53:39.569996 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m20:53:39.571972 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:53:39.577976 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:53:39.579967 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 20:53:39.572975 => 20:53:39.579967
[0m20:53:39.580970 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:53:39.585977 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:53:39.587980 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m20:53:39.588979 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m20:53:39.589981 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:53:40.535979 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:53:40.539979 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 20:53:36.357966 => 20:53:40.539979
[0m20:53:40.540977 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m20:53:41.031971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84beddbf-fa7f-44ec-b178-5b465ef6e771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179901BC1D0>]}
[0m20:53:41.032969 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.81s]
[0m20:53:41.035981 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m20:53:41.036982 [debug] [Thread-1 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m20:53:41.037976 [info ] [Thread-1 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m20:53:41.038980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM, now model.dbt_poc.my_first_dbt_model)
[0m20:53:41.039983 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m20:53:41.045979 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m20:53:41.047978 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 20:53:41.040981 => 20:53:41.047978
[0m20:53:41.048982 [debug] [Thread-1 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m20:53:41.053981 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m20:53:41.055979 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m20:53:41.056984 [debug] [Thread-1 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:53:41.057985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:41.097981 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:53:41.102974 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:53:36.275969 => 20:53:41.101979
[0m20:53:41.104969 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:53:41.479526 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:53:41.483524 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 20:53:39.581977 => 20:53:41.482525
[0m20:53:41.484525 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m20:53:41.604525 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84beddbf-fa7f-44ec-b178-5b465ef6e771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001798F97A490>]}
[0m20:53:41.606530 [info ] [Thread-2 (]: 2 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 5.38s]
[0m20:53:41.607531 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:53:42.016526 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84beddbf-fa7f-44ec-b178-5b465ef6e771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001798F9BED10>]}
[0m20:53:42.017526 [info ] [Thread-4 (]: 5 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.45s]
[0m20:53:42.019535 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m20:53:42.775539 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m20:53:42.779540 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 20:53:36.365959 => 20:53:42.779540
[0m20:53:42.780541 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m20:53:43.267530 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84beddbf-fa7f-44ec-b178-5b465ef6e771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001798E98CBD0>]}
[0m20:53:43.268529 [info ] [Thread-3 (]: 3 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[32mSUCCESS 1[0m in 7.04s]
[0m20:53:43.270537 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m20:53:43.552530 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:53:43.555527 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 20:53:41.048982 => 20:53:43.555527
[0m20:53:43.556528 [debug] [Thread-1 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m20:53:44.036530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84beddbf-fa7f-44ec-b178-5b465ef6e771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179902AF0D0>]}
[0m20:53:44.037529 [info ] [Thread-1 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 3.00s]
[0m20:53:44.039542 [debug] [Thread-1 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m20:53:44.040545 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m20:53:44.041535 [info ] [Thread-2 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m20:53:44.059535 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_second_dbt_model)
[0m20:53:44.061546 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m20:53:44.065545 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m20:53:44.068547 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 20:53:44.061546 => 20:53:44.067535
[0m20:53:44.068547 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m20:53:44.091542 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m20:53:44.094539 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m20:53:44.095543 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m20:53:44.096547 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:53:46.025540 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:53:46.029537 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 20:53:44.069546 => 20:53:46.028537
[0m20:53:46.030537 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m20:53:46.519539 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84beddbf-fa7f-44ec-b178-5b465ef6e771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001799017CDD0>]}
[0m20:53:46.521538 [info ] [Thread-2 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.47s]
[0m20:53:46.522544 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m20:53:46.525546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:53:46.526553 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m20:53:46.527552 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m20:53:46.527552 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m20:53:46.528542 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m20:53:46.531541 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN' was properly closed.
[0m20:53:46.534543 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m20:53:46.540542 [info ] [MainThread]: 
[0m20:53:46.549544 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 15.49 seconds (15.49s).
[0m20:53:46.553547 [debug] [MainThread]: Command end result
[0m20:53:46.604553 [info ] [MainThread]: 
[0m20:53:46.750553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:53:46.835542 [info ] [MainThread]: 
[0m20:53:46.843553 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m20:53:46.846545 [debug] [MainThread]: Command `dbt run` succeeded at 20:53:46.846545 after 17.39 seconds
[0m20:53:46.848545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001798719E790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017986BCFD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001798174FF10>]}
[0m20:53:46.849547 [debug] [MainThread]: Flushing usage events
[0m20:53:47.051543 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m22:14:00.961896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198A9B296D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198AA06DDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198A9B57C90>]}


============================== 22:14:00.977897 | 28483642-74bf-48cb-a38d-7e5f389182e2 ==============================
[0m22:14:00.977897 [info ] [MainThread]: Running with dbt=1.5.2
[0m22:14:00.979897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:14:07.601948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28483642-74bf-48cb-a38d-7e5f389182e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198B2E54150>]}
[0m22:14:07.614948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28483642-74bf-48cb-a38d-7e5f389182e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198B2E2CE10>]}
[0m22:14:07.623948 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m22:14:07.699948 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m22:14:08.471959 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m22:14:08.472965 [debug] [MainThread]: Partial parsing: added file: dbt_poc://models\External_tables\NADL_CORE_IMS_FLU.sql
[0m22:14:08.473962 [debug] [MainThread]: Partial parsing: deleted file: dbt_poc://macros\External_tables\NADL_CORE_IMS_FLU.sql
[0m22:14:08.499959 [debug] [MainThread]: 1699: static parser successfully parsed External_tables\NADL_CORE_IMS_FLU.sql
[0m22:14:08.530962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28483642-74bf-48cb-a38d-7e5f389182e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198B2EDB110>]}
[0m22:14:08.541962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28483642-74bf-48cb-a38d-7e5f389182e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198B2F2D690>]}
[0m22:14:08.542965 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 323 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m22:14:08.553961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28483642-74bf-48cb-a38d-7e5f389182e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198A5E12810>]}
[0m22:14:08.576960 [info ] [MainThread]: 
[0m22:14:08.604955 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:14:08.608956 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m22:14:08.662964 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m22:14:08.663964 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m22:14:08.664966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:11.613318 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m22:14:11.615318 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m22:14:12.099323 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m22:14:12.105319 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m22:14:12.106318 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m22:14:12.107319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:14.050337 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m22:14:14.053335 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m22:14:14.528325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28483642-74bf-48cb-a38d-7e5f389182e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198B2F0C3D0>]}
[0m22:14:14.529328 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:14:14.530325 [info ] [MainThread]: 
[0m22:14:14.570327 [debug] [Thread-1 (]: Began running node model.dbt_poc.NADL_CORE_IMS_FLU
[0m22:14:14.570327 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:14:14.571337 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:14:14.572330 [debug] [Thread-4 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:14:14.572330 [info ] [Thread-1 (]: 1 of 8 START sql table model DIGITAL_SHELF_DBT.NADL_CORE_IMS_FLU ............... [RUN]
[0m22:14:14.574333 [info ] [Thread-2 (]: 2 of 8 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m22:14:14.580332 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m22:14:14.581334 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:14:14.578332 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.NADL_CORE_IMS_FLU'
[0m22:14:14.575332 [info ] [Thread-3 (]: 3 of 8 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m22:14:14.596330 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m22:14:14.597339 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.NADL_CORE_IMS_FLU
[0m22:14:14.598333 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m22:14:14.605325 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.NADL_CORE_IMS_FLU"
[0m22:14:14.576332 [info ] [Thread-4 (]: 4 of 8 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m22:14:14.606333 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:14:14.607329 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 22:14:14.582339 => 22:14:14.606333
[0m22:14:14.608330 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m22:14:14.614336 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:14:14.615331 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:14:14.616329 [debug] [Thread-1 (]: Timing info for model.dbt_poc.NADL_CORE_IMS_FLU (compile): 22:14:14.600338 => 22:14:14.615331
[0m22:14:14.638332 [debug] [Thread-1 (]: Began executing node model.dbt_poc.NADL_CORE_IMS_FLU
[0m22:14:14.617329 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:14:14.657330 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 22:14:14.609328 => 22:14:14.655329
[0m22:14:14.717337 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m22:14:14.738325 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.NADL_CORE_IMS_FLU"
[0m22:14:14.744331 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m22:14:14.745329 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:14:14.746334 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:14:14.751330 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:14:14.752324 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:14:14.755335 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.NADL_CORE_IMS_FLU"
[0m22:14:14.756350 [debug] [Thread-4 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 22:14:14.739325 => 22:14:14.755335
[0m22:14:14.756350 [debug] [Thread-3 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:14:14.760337 [debug] [Thread-1 (]: On model.dbt_poc.NADL_CORE_IMS_FLU: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.NADL_CORE_IMS_FLU"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.NADL_CORE_IMS_FLU
         as
        (

 create or replace external table NADL_CORE_IMS_FLU
(

recordid integer as (value:c1::int),

week_end date as (value:c2::date),

age_group varchar(50) as (value:c3::varchar),

division varchar(50) as (value:c4::varchar),

market varchar(50) as (value:c5::varchar),

tot_populatn integer as (value:c6::int),

afct_wk integer as (value:c7::int),

afct_wk_prcnt numeric(10,2) as (value:c8::numeric),

afct_wk_vs_lstwk_prcnt numeric(10,2) as (value:c9::numeric),

afct_wk_vs_lstseason_prcnt numeric(10,2) as (value:c10::numeric),

afct_season_vs_lstseason_prcnt numeric(10,2) as (value:c11::numeric),

afct_yr_vs_lstyr_prcnt numeric(10,2) as (value:c12::numeric),

overall_market_status varchar(50) as (value:c13::varchar),

no_of_weeks_on_status integer as (value:c14::int),

symptom varchar(100) as (value:c15::varchar),

month_id varchar(6) as (value:c16::varchar),

currentlyprocessedfilename varchar(255) as (value:c17::varchar),

sor_dtm timestamp as (value:c18::timestamp)

)

with location = @DEV_COMX_GLOBAL.DIGSHELF_RAW.NADL_DATA_LOAD/core_ims_flu.csv*

file_format = DEV_COMX_GLOBAL.DIGSHELF_RAW.COMX_EXT_FILE_FORMAT_REF_TIME_DIM

REFRESH_ON_CREATE=TRUE

AUTO_REFRESH=TRUE
        );
[0m22:14:14.761340 [debug] [Thread-4 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:14:14.762339 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:14:14.762339 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:14:14.767338 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m22:14:14.773332 [debug] [Thread-4 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:14:14.774332 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:14:17.287335 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01add82c-0d04-ccb4-0002-a656010505d2
[0m22:14:17.288333 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 1 unexpected 'create'.
syntax error line 8 at position 35 unexpected ','.
[0m22:14:17.289338 [debug] [Thread-1 (]: Timing info for model.dbt_poc.NADL_CORE_IMS_FLU (execute): 22:14:14.639340 => 22:14:17.288333
[0m22:14:17.290336 [debug] [Thread-1 (]: On model.dbt_poc.NADL_CORE_IMS_FLU: Close
[0m22:14:17.291343 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:14:17.296330 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m22:14:17.300336 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m22:14:17.301338 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
        );
[0m22:14:17.362340 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:14:17.365333 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m22:14:17.371332 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m22:14:17.372347 [debug] [Thread-4 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_CAMPAIGN  a
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  b
on a.tag_id = b.id
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m22:14:17.531342 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:14:17.534337 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:14:17.537341 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:14:17.538342 [debug] [Thread-3 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)



select *
from final
        );
[0m22:14:17.793342 [debug] [Thread-1 (]: Database Error in model NADL_CORE_IMS_FLU (models\External_tables\NADL_CORE_IMS_FLU.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 1 unexpected 'create'.
  syntax error line 8 at position 35 unexpected ','.
  compiled Code at target\run\dbt_poc\models\External_tables\NADL_CORE_IMS_FLU.sql
[0m22:14:17.794346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28483642-74bf-48cb-a38d-7e5f389182e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198B2E45E90>]}
[0m22:14:17.795348 [error] [Thread-1 (]: 1 of 8 ERROR creating sql table model DIGITAL_SHELF_DBT.NADL_CORE_IMS_FLU ...... [[31mERROR[0m in 3.22s]
[0m22:14:17.796340 [debug] [Thread-1 (]: Finished running node model.dbt_poc.NADL_CORE_IMS_FLU
[0m22:14:17.797336 [debug] [Thread-1 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m22:14:17.799346 [info ] [Thread-1 (]: 5 of 8 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m22:14:17.800341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.NADL_CORE_IMS_FLU, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM)
[0m22:14:17.801336 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m22:14:17.806333 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m22:14:17.808336 [debug] [Thread-1 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 22:14:17.801336 => 22:14:17.808336
[0m22:14:17.809339 [debug] [Thread-1 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m22:14:17.852339 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m22:14:17.855338 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m22:14:17.856338 [debug] [Thread-1 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join   COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m22:14:17.857345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:19.078348 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:14:19.079347 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:14:19.109336 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 22:14:14.622333 => 22:14:19.109336
[0m22:14:19.112338 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 22:14:14.748332 => 22:14:19.111341
[0m22:14:19.112338 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m22:14:19.113344 [debug] [Thread-3 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m22:14:19.694338 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28483642-74bf-48cb-a38d-7e5f389182e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198B388EA10>]}
[0m22:14:19.695340 [info ] [Thread-3 (]: 3 of 8 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 5.10s]
[0m22:14:19.703343 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:14:19.703343 [debug] [Thread-3 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:14:19.706351 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28483642-74bf-48cb-a38d-7e5f389182e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198B2F44510>]}
[0m22:14:19.705355 [info ] [Thread-3 (]: 6 of 8 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m22:14:19.709345 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m22:14:19.707343 [info ] [Thread-2 (]: 2 of 8 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 5.13s]
[0m22:14:19.721345 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:14:19.723343 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:14:19.728340 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:14:19.729337 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m22:14:19.731343 [info ] [Thread-2 (]: 7 of 8 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m22:14:19.732349 [debug] [Thread-3 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 22:14:19.724344 => 22:14:19.731343
[0m22:14:19.733342 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM, now model.dbt_poc.my_first_dbt_model)
[0m22:14:19.734340 [debug] [Thread-3 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:14:19.734340 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m22:14:19.766354 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m22:14:19.769342 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 22:14:19.762339 => 22:14:19.768353
[0m22:14:19.769342 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m22:14:19.786341 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:14:19.795346 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m22:14:19.799343 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:14:19.800352 [debug] [Thread-3 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m22:14:19.801352 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:14:19.822351 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m22:14:19.822351 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m22:14:19.823352 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:14:20.256349 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:14:20.260340 [debug] [Thread-1 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 22:14:17.809339 => 22:14:20.260340
[0m22:14:20.261341 [debug] [Thread-1 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m22:14:20.728345 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:14:20.731340 [debug] [Thread-4 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 22:14:14.763338 => 22:14:20.731340
[0m22:14:20.732345 [debug] [Thread-4 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m22:14:20.754342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28483642-74bf-48cb-a38d-7e5f389182e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198B3778A10>]}
[0m22:14:20.755341 [info ] [Thread-1 (]: 5 of 8 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 2.95s]
[0m22:14:20.757352 [debug] [Thread-1 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m22:14:21.223342 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28483642-74bf-48cb-a38d-7e5f389182e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198B375FDD0>]}
[0m22:14:21.224341 [info ] [Thread-4 (]: 4 of 8 OK created sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[32mSUCCESS 1[0m in 6.62s]
[0m22:14:21.226355 [debug] [Thread-4 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:14:22.175350 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:14:22.178344 [debug] [Thread-3 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 22:14:19.761345 => 22:14:22.178344
[0m22:14:22.179345 [debug] [Thread-3 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m22:14:22.284355 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:14:22.287354 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 22:14:19.792350 => 22:14:22.287354
[0m22:14:22.288357 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m22:14:22.661351 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28483642-74bf-48cb-a38d-7e5f389182e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198B3728790>]}
[0m22:14:22.662359 [info ] [Thread-3 (]: 6 of 8 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.95s]
[0m22:14:22.664358 [debug] [Thread-3 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:14:22.786345 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28483642-74bf-48cb-a38d-7e5f389182e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198B2F4C750>]}
[0m22:14:22.788348 [info ] [Thread-2 (]: 7 of 8 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 3.05s]
[0m22:14:22.790356 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m22:14:22.791352 [debug] [Thread-1 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m22:14:22.792352 [info ] [Thread-1 (]: 8 of 8 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m22:14:22.794358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.my_second_dbt_model)
[0m22:14:22.794358 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m22:14:22.799360 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m22:14:22.801357 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 22:14:22.795355 => 22:14:22.801357
[0m22:14:22.802361 [debug] [Thread-1 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m22:14:22.824350 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m22:14:22.827359 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m22:14:22.828351 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m22:14:22.829349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:24.836355 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:14:24.840347 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 22:14:22.802361 => 22:14:24.840347
[0m22:14:24.841353 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m22:14:25.321352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28483642-74bf-48cb-a38d-7e5f389182e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198B3815F10>]}
[0m22:14:25.322351 [info ] [Thread-1 (]: 8 of 8 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.53s]
[0m22:14:25.324361 [debug] [Thread-1 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m22:14:25.326359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:14:25.327363 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m22:14:25.328358 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m22:14:25.329360 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m22:14:25.331354 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m22:14:25.335366 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m22:14:25.340356 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN' was properly closed.
[0m22:14:25.349357 [info ] [MainThread]: 
[0m22:14:25.352368 [info ] [MainThread]: Finished running 5 table models, 3 view models in 0 hours 0 minutes and 16.74 seconds (16.74s).
[0m22:14:25.364357 [debug] [MainThread]: Command end result
[0m22:14:25.410356 [info ] [MainThread]: 
[0m22:14:25.422356 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:14:25.520357 [info ] [MainThread]: 
[0m22:14:25.545356 [error] [MainThread]: [33mDatabase Error in model NADL_CORE_IMS_FLU (models\External_tables\NADL_CORE_IMS_FLU.sql)[0m
[0m22:14:25.573360 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m22:14:25.575356 [error] [MainThread]:   syntax error line 5 at position 1 unexpected 'create'.
[0m22:14:25.577363 [error] [MainThread]:   syntax error line 8 at position 35 unexpected ','.
[0m22:14:25.583357 [error] [MainThread]:   compiled Code at target\run\dbt_poc\models\External_tables\NADL_CORE_IMS_FLU.sql
[0m22:14:25.585360 [info ] [MainThread]: 
[0m22:14:25.587362 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m22:14:25.589361 [debug] [MainThread]: Command `dbt run` failed at 22:14:25.588358 after 25.11 seconds
[0m22:14:25.589361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198AA028390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198A507BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198AA042C90>]}
[0m22:14:25.600373 [debug] [MainThread]: Flushing usage events
[0m22:14:26.527359 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m22:38:43.988921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A764097AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A76353FA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A763A4AC90>]}


============================== 22:38:44.004926 | 81fc3d3f-8b1f-4292-ba62-0a4d1c96da17 ==============================
[0m22:38:44.004926 [info ] [MainThread]: Running with dbt=1.5.2
[0m22:38:44.006926 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:38:51.159284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81fc3d3f-8b1f-4292-ba62-0a4d1c96da17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7634920D0>]}
[0m22:38:51.171283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81fc3d3f-8b1f-4292-ba62-0a4d1c96da17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A76C839150>]}
[0m22:38:51.180283 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m22:38:51.232292 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m22:38:51.266287 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:38:51.269291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '81fc3d3f-8b1f-4292-ba62-0a4d1c96da17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A76C947410>]}
[0m22:38:52.811296 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m22:38:52.826287 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m22:38:52.833298 [debug] [MainThread]: 1699: static parser successfully parsed L1\VW_CRITEO_AD__DAYREPORT_LINE_ITEM.sql
[0m22:38:52.842295 [debug] [MainThread]: 1699: static parser successfully parsed L1\VW_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m22:38:52.847287 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m22:38:52.854287 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM.sql
[0m22:38:52.858287 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m22:38:52.865292 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT.sql
[0m22:38:52.870286 [debug] [MainThread]: 1603: static parser failed on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m22:38:52.875287 [debug] [MainThread]: 1602: parser fallback to jinja rendering on RAW\TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN.sql
[0m22:38:52.951299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81fc3d3f-8b1f-4292-ba62-0a4d1c96da17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A76C90C690>]}
[0m22:38:52.962296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81fc3d3f-8b1f-4292-ba62-0a4d1c96da17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A76C9A78D0>]}
[0m22:38:52.963303 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m22:38:52.987297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81fc3d3f-8b1f-4292-ba62-0a4d1c96da17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A763A5C390>]}
[0m22:38:52.990299 [info ] [MainThread]: 
[0m22:38:52.992292 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:38:53.014299 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m22:38:53.046300 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m22:38:53.048301 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m22:38:53.048301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:55.937294 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m22:38:55.940291 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m22:38:56.436295 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m22:38:56.447304 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m22:38:56.448296 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m22:38:56.449303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:58.389314 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m22:38:58.392309 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m22:38:58.904300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81fc3d3f-8b1f-4292-ba62-0a4d1c96da17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A76C8AEA50>]}
[0m22:38:58.906298 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:38:58.907305 [info ] [MainThread]: 
[0m22:38:58.927307 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:38:58.928306 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:38:58.929315 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:38:58.929315 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m22:38:58.930310 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m22:38:58.943307 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m22:38:58.944309 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:38:58.951310 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m22:38:58.934304 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m22:38:58.939304 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m22:38:58.954314 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m22:38:58.941312 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m22:38:58.955304 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m22:38:58.956304 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 22:38:58.945306 => 22:38:58.955304
[0m22:38:58.957311 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:38:58.958330 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m22:38:58.959308 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:38:58.960314 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:38:58.976308 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:38:58.977309 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m22:38:58.983314 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m22:38:59.022311 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m22:38:59.038310 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m22:38:59.039312 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 22:38:58.960314 => 22:38:59.039312
[0m22:38:59.040306 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:38:59.041307 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 22:38:58.977309 => 22:38:59.041307
[0m22:38:59.042314 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:38:59.043308 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 22:38:59.023312 => 22:38:59.043308
[0m22:38:59.050313 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m22:38:59.045305 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:38:59.049315 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:38:59.044327 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:38:59.107309 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m22:38:59.112302 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m22:38:59.112302 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:38:59.117306 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:38:59.119307 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m22:38:59.119307 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:38:59.120302 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:38:59.121304 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join   COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m22:38:59.127306 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:39:01.511695 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:39:01.528686 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:39:01.529687 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:39:01.532699 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m22:39:01.534691 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:39:01.535689 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)



select *
from final
        );
[0m22:39:01.537689 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m22:39:01.539693 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
        );
[0m22:39:01.565693 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:39:01.600686 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 22:38:59.050313 => 22:39:01.599686
[0m22:39:01.601689 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m22:39:01.724700 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:39:01.726686 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m22:39:01.731687 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m22:39:01.732690 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_CAMPAIGN  a
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  b
on a.tag_id = b.id
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m22:39:02.100696 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81fc3d3f-8b1f-4292-ba62-0a4d1c96da17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A76C9D9C90>]}
[0m22:39:02.101703 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 3.14s]
[0m22:39:02.103704 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m22:39:02.104703 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:39:02.105699 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m22:39:02.106701 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m22:39:02.107703 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:39:02.116696 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:39:02.118697 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 22:39:02.108704 => 22:39:02.118697
[0m22:39:02.119692 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:39:02.310699 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:39:02.313693 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:39:02.314689 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m22:39:02.314689 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:39:02.991703 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:39:02.995700 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 22:38:59.045305 => 22:39:02.995700
[0m22:39:02.996704 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m22:39:03.478692 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81fc3d3f-8b1f-4292-ba62-0a4d1c96da17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A76D181790>]}
[0m22:39:03.479691 [info ] [Thread-2 (]: 2 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 4.52s]
[0m22:39:03.481700 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:39:03.481700 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m22:39:03.482703 [info ] [Thread-2 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m22:39:03.484698 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_first_dbt_model)
[0m22:39:03.485706 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m22:39:03.489702 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m22:39:03.491697 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 22:39:03.485706 => 22:39:03.491697
[0m22:39:03.492708 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m22:39:03.498699 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m22:39:03.500700 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m22:39:03.501701 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m22:39:03.502705 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:39:03.553705 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:39:03.558698 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 22:38:58.983314 => 22:39:03.558698
[0m22:39:03.559707 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m22:39:04.055699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81fc3d3f-8b1f-4292-ba62-0a4d1c96da17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A76CDED4D0>]}
[0m22:39:04.056698 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 5.11s]
[0m22:39:04.058700 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:39:04.305697 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:39:04.309693 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 22:39:02.120698 => 22:39:04.308693
[0m22:39:04.310701 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m22:39:04.823694 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81fc3d3f-8b1f-4292-ba62-0a4d1c96da17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A76C7DBD50>]}
[0m22:39:04.824694 [info ] [Thread-4 (]: 5 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.72s]
[0m22:39:04.825703 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:39:05.712696 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m22:39:05.716709 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 22:38:59.107309 => 22:39:05.715705
[0m22:39:05.716709 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m22:39:05.912707 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:39:05.916696 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 22:39:03.492708 => 22:39:05.916696
[0m22:39:05.917700 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m22:39:06.869704 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81fc3d3f-8b1f-4292-ba62-0a4d1c96da17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A76D2B4C10>]}
[0m22:39:06.870699 [info ] [Thread-3 (]: 3 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[32mSUCCESS 1[0m in 7.92s]
[0m22:39:06.871703 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:39:07.017699 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81fc3d3f-8b1f-4292-ba62-0a4d1c96da17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A76C9D85D0>]}
[0m22:39:07.018708 [info ] [Thread-2 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 3.53s]
[0m22:39:07.020718 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m22:39:07.021711 [debug] [Thread-1 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m22:39:07.022705 [info ] [Thread-1 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m22:39:07.024706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM, now model.dbt_poc.my_second_dbt_model)
[0m22:39:07.025714 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m22:39:07.046713 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m22:39:07.047707 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 22:39:07.025714 => 22:39:07.047707
[0m22:39:07.048714 [debug] [Thread-1 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m22:39:07.053712 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m22:39:07.055702 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m22:39:07.060703 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m22:39:07.064703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:09.241707 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:39:09.245700 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 22:39:07.049710 => 22:39:09.245700
[0m22:39:09.246700 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m22:39:09.736707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81fc3d3f-8b1f-4292-ba62-0a4d1c96da17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A76C9977D0>]}
[0m22:39:09.738717 [info ] [Thread-1 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.71s]
[0m22:39:09.740725 [debug] [Thread-1 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m22:39:09.766717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:39:09.767712 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m22:39:09.767712 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m22:39:09.768708 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m22:39:09.769708 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m22:39:09.770712 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN' was properly closed.
[0m22:39:09.771718 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m22:39:09.772711 [info ] [MainThread]: 
[0m22:39:09.773714 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 16.78 seconds (16.78s).
[0m22:39:09.827713 [debug] [MainThread]: Command end result
[0m22:39:09.862725 [info ] [MainThread]: 
[0m22:39:09.864723 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:39:09.921709 [info ] [MainThread]: 
[0m22:39:09.955708 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m22:39:09.958709 [debug] [MainThread]: Command `dbt run` succeeded at 22:39:09.957719 after 26.50 seconds
[0m22:39:09.959716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A763561550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A75E64F350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A75E64F310>]}
[0m22:39:09.959716 [debug] [MainThread]: Flushing usage events
[0m22:39:10.932717 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m22:40:13.876717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D2E075A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D2DA257D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D2D43E110>]}


============================== 22:40:13.882723 | 32c8a5e2-17e7-417b-9312-8e9158a978cc ==============================
[0m22:40:13.882723 [info ] [MainThread]: Running with dbt=1.5.2
[0m22:40:13.883717 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:40:14.945723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32c8a5e2-17e7-417b-9312-8e9158a978cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D2D9CDC90>]}
[0m22:40:14.964717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32c8a5e2-17e7-417b-9312-8e9158a978cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D36703450>]}
[0m22:40:14.965723 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m22:40:15.018719 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m22:40:15.161724 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:40:15.162725 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:40:15.174725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32c8a5e2-17e7-417b-9312-8e9158a978cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D3680D690>]}
[0m22:40:15.201720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32c8a5e2-17e7-417b-9312-8e9158a978cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D3689AD50>]}
[0m22:40:15.202727 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m22:40:15.250720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32c8a5e2-17e7-417b-9312-8e9158a978cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D29712990>]}
[0m22:40:15.269712 [info ] [MainThread]: 
[0m22:40:15.288723 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:40:15.293724 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m22:40:15.326725 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m22:40:15.328720 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m22:40:15.329728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:17.645729 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m22:40:17.648726 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m22:40:18.185719 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m22:40:18.196719 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m22:40:18.197718 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m22:40:18.197718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:20.165737 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m22:40:20.168732 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m22:40:20.653727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32c8a5e2-17e7-417b-9312-8e9158a978cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D2C930ED0>]}
[0m22:40:20.655728 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:40:20.673738 [info ] [MainThread]: 
[0m22:40:20.706733 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:40:20.707733 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:40:20.708736 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:40:20.709736 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m22:40:20.710737 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m22:40:20.711733 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m22:40:20.722732 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m22:40:20.724736 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m22:40:20.725731 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:40:20.725731 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:40:20.731734 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m22:40:20.712732 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m22:40:20.737738 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:40:20.739730 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m22:40:20.721728 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m22:40:20.740730 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 22:40:20.726735 => 22:40:20.740730
[0m22:40:20.741730 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:40:20.742731 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m22:40:20.743732 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 22:40:20.732727 => 22:40:20.743732
[0m22:40:20.744734 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:40:20.750737 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m22:40:20.751732 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m22:40:20.752729 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:40:20.819730 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m22:40:20.825729 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m22:40:20.829735 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:40:20.830737 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 22:40:20.744734 => 22:40:20.830737
[0m22:40:20.831734 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:40:20.832728 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:40:20.833745 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:40:20.834744 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 22:40:20.820731 => 22:40:20.834744
[0m22:40:20.835728 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:40:20.836732 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:40:20.840735 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m22:40:20.847738 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:40:20.848741 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:40:20.841729 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m22:40:20.945739 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m22:40:20.962730 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m22:40:20.963737 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join   COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m22:40:20.964737 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:40:23.378737 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:40:23.401730 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m22:40:23.407757 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m22:40:23.409737 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:40:23.410739 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:40:23.411744 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_CAMPAIGN  a
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  b
on a.tag_id = b.id
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m22:40:23.413737 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m22:40:23.415733 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:40:23.421739 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m22:40:23.422738 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
        );
[0m22:40:23.423733 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:40:23.426743 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)



select *
from final
        );
[0m22:40:23.453736 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:40:23.489744 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 22:40:20.863730 => 22:40:23.489744
[0m22:40:23.490743 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m22:40:23.991743 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32c8a5e2-17e7-417b-9312-8e9158a978cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D371D3B10>]}
[0m22:40:23.992746 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 3.25s]
[0m22:40:23.994738 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m22:40:23.995745 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:40:23.996741 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m22:40:23.998742 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m22:40:24.001739 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:40:24.007742 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:40:24.009741 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 22:40:24.001739 => 22:40:24.008740
[0m22:40:24.010741 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:40:24.015741 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:40:24.018740 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:40:24.018740 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m22:40:24.019743 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:40:24.389745 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:40:24.393746 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 22:40:20.826725 => 22:40:24.392741
[0m22:40:24.394746 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m22:40:24.867745 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:40:24.871744 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 22:40:20.753728 => 22:40:24.871744
[0m22:40:24.872746 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m22:40:24.914734 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32c8a5e2-17e7-417b-9312-8e9158a978cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D37052D10>]}
[0m22:40:24.916741 [info ] [Thread-2 (]: 2 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 4.19s]
[0m22:40:24.918752 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:40:24.919749 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m22:40:24.920738 [info ] [Thread-2 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m22:40:24.922747 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_first_dbt_model)
[0m22:40:24.923750 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m22:40:24.928748 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m22:40:24.930739 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 22:40:24.923750 => 22:40:24.930739
[0m22:40:24.931747 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m22:40:24.938741 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m22:40:24.940743 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m22:40:24.941742 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m22:40:24.942741 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:40:25.367735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32c8a5e2-17e7-417b-9312-8e9158a978cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D371CEC10>]}
[0m22:40:25.368740 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.65s]
[0m22:40:25.370740 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:40:26.093744 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:40:26.097737 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 22:40:24.010741 => 22:40:26.097737
[0m22:40:26.098736 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m22:40:26.431738 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:40:26.434735 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 22:40:20.836732 => 22:40:26.434735
[0m22:40:26.435735 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m22:40:26.660737 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32c8a5e2-17e7-417b-9312-8e9158a978cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D370F3510>]}
[0m22:40:26.661736 [info ] [Thread-4 (]: 5 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.66s]
[0m22:40:26.663751 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:40:26.912738 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32c8a5e2-17e7-417b-9312-8e9158a978cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D37105710>]}
[0m22:40:26.913738 [info ] [Thread-3 (]: 3 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[32mSUCCESS 1[0m in 6.17s]
[0m22:40:26.915749 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:40:27.361743 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:40:27.366735 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 22:40:24.934736 => 22:40:27.365736
[0m22:40:27.366735 [debug] [Thread-2 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m22:40:27.856740 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32c8a5e2-17e7-417b-9312-8e9158a978cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D37410410>]}
[0m22:40:27.857739 [info ] [Thread-2 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 2.94s]
[0m22:40:27.858745 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m22:40:27.860743 [debug] [Thread-1 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m22:40:27.861743 [info ] [Thread-1 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m22:40:27.862749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM, now model.dbt_poc.my_second_dbt_model)
[0m22:40:27.863752 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m22:40:27.883745 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m22:40:27.885744 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 22:40:27.864749 => 22:40:27.885744
[0m22:40:27.886751 [debug] [Thread-1 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m22:40:27.907752 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m22:40:27.915744 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m22:40:27.923744 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m22:40:27.930741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:29.941365 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:40:29.945358 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 22:40:27.889749 => 22:40:29.945358
[0m22:40:29.946357 [debug] [Thread-1 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m22:40:30.455372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32c8a5e2-17e7-417b-9312-8e9158a978cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D37410950>]}
[0m22:40:30.456375 [info ] [Thread-1 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.59s]
[0m22:40:30.458367 [debug] [Thread-1 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m22:40:30.461362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:40:30.462382 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m22:40:30.462382 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m22:40:30.463363 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m22:40:30.464364 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m22:40:30.464364 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN' was properly closed.
[0m22:40:30.472367 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m22:40:30.477365 [info ] [MainThread]: 
[0m22:40:30.484364 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 15.19 seconds (15.19s).
[0m22:40:30.488371 [debug] [MainThread]: Command end result
[0m22:40:30.519371 [info ] [MainThread]: 
[0m22:40:30.611372 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:40:30.643368 [info ] [MainThread]: 
[0m22:40:30.644368 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m22:40:30.673364 [debug] [MainThread]: Command `dbt run` succeeded at 22:40:30.672361 after 17.19 seconds
[0m22:40:30.673364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D2D43E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D285FA550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D2863F310>]}
[0m22:40:30.674360 [debug] [MainThread]: Flushing usage events
[0m22:40:30.906367 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m22:52:22.191648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024672C291D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246731D5F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246727ADD90>]}


============================== 22:52:22.197653 | f378a508-6f49-43f7-8031-ba5176fe32d9 ==============================
[0m22:52:22.197653 [info ] [MainThread]: Running with dbt=1.5.2
[0m22:52:22.199647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:52:23.437652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f378a508-6f49-43f7-8031-ba5176fe32d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024673798150>]}
[0m22:52:23.463658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f378a508-6f49-43f7-8031-ba5176fe32d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002467BF07A50>]}
[0m22:52:23.466648 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m22:52:23.517643 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m22:52:23.655648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:52:23.656651 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:52:23.668657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f378a508-6f49-43f7-8031-ba5176fe32d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002467C0345D0>]}
[0m22:52:23.680652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f378a508-6f49-43f7-8031-ba5176fe32d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002467BF7F510>]}
[0m22:52:23.681657 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m22:52:23.683652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f378a508-6f49-43f7-8031-ba5176fe32d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466EE42810>]}
[0m22:52:23.686646 [info ] [MainThread]: 
[0m22:52:23.688652 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:52:23.760648 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m22:52:23.792656 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m22:52:23.793650 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m22:52:23.794657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:26.056661 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m22:52:26.059661 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m22:52:26.562657 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m22:52:26.570649 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m22:52:26.571649 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m22:52:26.571649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:28.383661 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m22:52:28.385662 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m22:52:29.024667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f378a508-6f49-43f7-8031-ba5176fe32d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246731D68D0>]}
[0m22:52:29.026669 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:52:29.027666 [info ] [MainThread]: 
[0m22:52:29.045656 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:52:29.046655 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:52:29.046655 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:52:29.047658 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m22:52:29.048654 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m22:52:29.049666 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m22:52:29.050665 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m22:52:29.051669 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m22:52:29.053660 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m22:52:29.055657 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m22:52:29.056661 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m22:52:29.057661 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m22:52:29.062662 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:52:29.065658 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:52:29.066665 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:52:29.067669 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m22:52:29.072659 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m22:52:29.078668 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:52:29.084653 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m22:52:29.089668 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m22:52:29.097659 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 22:52:29.068658 => 22:52:29.097659
[0m22:52:29.099670 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 22:52:29.078668 => 22:52:29.099670
[0m22:52:29.100660 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 22:52:29.073654 => 22:52:29.100660
[0m22:52:29.101666 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:52:29.102666 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 22:52:29.085662 => 22:52:29.101666
[0m22:52:29.124660 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m22:52:29.102666 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:52:29.103658 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:52:29.188659 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m22:52:29.192659 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m22:52:29.198653 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:52:29.219668 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m22:52:29.220659 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:52:29.220659 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:52:29.221660 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:52:29.223660 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:52:29.224658 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:52:29.225662 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m22:52:29.226667 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:52:29.232660 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join   COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m22:52:29.235667 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:52:31.634664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:52:31.653659 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m22:52:31.656665 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m22:52:31.657662 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
        );
[0m22:52:31.668669 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:52:31.671670 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:52:31.673665 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:52:31.674672 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)



select *
from final
        );
[0m22:52:31.865670 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:52:31.867658 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m22:52:31.872660 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m22:52:31.873659 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_CAMPAIGN  a
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  b
on a.tag_id = b.id
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m22:52:31.958666 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:52:31.993660 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 22:52:29.127663 => 22:52:31.992660
[0m22:52:31.994671 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m22:52:32.485661 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f378a508-6f49-43f7-8031-ba5176fe32d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002467C8FC150>]}
[0m22:52:32.486661 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 3.43s]
[0m22:52:32.488676 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m22:52:32.489671 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:52:32.490665 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m22:52:32.491675 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m22:52:32.492677 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:52:32.500671 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:52:32.502672 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 22:52:32.493674 => 22:52:32.501670
[0m22:52:32.502672 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:52:32.507669 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:52:32.510669 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:52:32.511674 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m22:52:32.512672 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:52:33.318667 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:52:33.322673 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 22:52:29.104657 => 22:52:33.322673
[0m22:52:33.323676 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m22:52:33.705670 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:52:33.710676 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 22:52:29.193664 => 22:52:33.709661
[0m22:52:33.711678 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m22:52:33.815664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f378a508-6f49-43f7-8031-ba5176fe32d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002467BF41A50>]}
[0m22:52:33.816663 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.76s]
[0m22:52:33.818677 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:52:33.819671 [debug] [Thread-1 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m22:52:33.820672 [info ] [Thread-1 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m22:52:33.823675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM, now model.dbt_poc.my_first_dbt_model)
[0m22:52:33.824680 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m22:52:33.829669 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m22:52:33.831674 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 22:52:33.825676 => 22:52:33.830676
[0m22:52:33.831674 [debug] [Thread-1 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m22:52:33.836672 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m22:52:33.838673 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m22:52:33.839676 [debug] [Thread-1 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m22:52:33.840675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:52:34.213680 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f378a508-6f49-43f7-8031-ba5176fe32d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002467C79CD10>]}
[0m22:52:34.214677 [info ] [Thread-2 (]: 2 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 5.16s]
[0m22:52:34.216673 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:52:34.749673 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:52:34.753666 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 22:52:32.503674 => 22:52:34.753666
[0m22:52:34.754668 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m22:52:35.114667 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:52:35.117670 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 22:52:29.188659 => 22:52:35.117670
[0m22:52:35.118681 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m22:52:35.252668 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f378a508-6f49-43f7-8031-ba5176fe32d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002467C8D3850>]}
[0m22:52:35.253667 [info ] [Thread-4 (]: 5 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.76s]
[0m22:52:35.255680 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:52:35.651667 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f378a508-6f49-43f7-8031-ba5176fe32d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002467C8ECB90>]}
[0m22:52:35.653669 [info ] [Thread-3 (]: 3 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[32mSUCCESS 1[0m in 6.60s]
[0m22:52:35.654677 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:52:36.312668 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:52:36.316666 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 22:52:33.832679 => 22:52:36.315666
[0m22:52:36.317675 [debug] [Thread-1 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m22:52:36.804671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f378a508-6f49-43f7-8031-ba5176fe32d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002467BFB8E10>]}
[0m22:52:36.805674 [info ] [Thread-1 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 2.98s]
[0m22:52:36.807680 [debug] [Thread-1 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m22:52:36.809676 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m22:52:36.810679 [info ] [Thread-2 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m22:52:36.811678 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_second_dbt_model)
[0m22:52:36.812680 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m22:52:36.834674 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m22:52:36.836684 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 22:52:36.813674 => 22:52:36.836684
[0m22:52:36.841674 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m22:52:36.859675 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m22:52:36.862670 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m22:52:36.863671 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m22:52:36.863671 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:52:38.893673 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:52:38.897676 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 22:52:36.846675 => 22:52:38.896671
[0m22:52:38.898676 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m22:52:39.387679 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f378a508-6f49-43f7-8031-ba5176fe32d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002467C76D610>]}
[0m22:52:39.389680 [info ] [Thread-2 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.58s]
[0m22:52:39.390680 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m22:52:39.400678 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:52:39.412682 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m22:52:39.416677 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m22:52:39.416677 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m22:52:39.421687 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m22:52:39.422689 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN' was properly closed.
[0m22:52:39.422689 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m22:52:39.423686 [info ] [MainThread]: 
[0m22:52:39.424680 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 15.74 seconds (15.74s).
[0m22:52:39.428684 [debug] [MainThread]: Command end result
[0m22:52:39.462679 [info ] [MainThread]: 
[0m22:52:39.470687 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:52:39.493689 [info ] [MainThread]: 
[0m22:52:39.522685 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m22:52:39.531688 [debug] [MainThread]: Command `dbt run` succeeded at 22:52:39.531688 after 17.73 seconds
[0m22:52:39.613687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024672C54150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024672CDA890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024673175050>]}
[0m22:52:39.649251 [debug] [MainThread]: Flushing usage events
[0m22:52:40.519256 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m22:59:26.743236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D0D76590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7CC3D1F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D1261950>]}


============================== 22:59:26.760228 | 821279bc-9e2f-47cc-8c7d-fee15f80a82f ==============================
[0m22:59:26.760228 [info ] [MainThread]: Running with dbt=1.5.2
[0m22:59:26.761241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\SNando01\\DBT_POC\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SNando01\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:59:33.137252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '821279bc-9e2f-47cc-8c7d-fee15f80a82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D18ABD90>]}
[0m22:59:33.153252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '821279bc-9e2f-47cc-8c7d-fee15f80a82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7DA045BD0>]}
[0m22:59:33.160257 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m22:59:33.211256 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m22:59:33.970246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m22:59:33.971245 [debug] [MainThread]: Partial parsing: added file: dbt_poc://macros\test.sql
[0m22:59:33.972249 [debug] [MainThread]: Partial parsing: added file: dbt_poc://macros\execute_test.sql
[0m22:59:33.989247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '821279bc-9e2f-47cc-8c7d-fee15f80a82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7DA0460D0>]}
[0m22:59:34.000251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '821279bc-9e2f-47cc-8c7d-fee15f80a82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7DA0D80D0>]}
[0m22:59:34.001250 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 326 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m22:59:34.003264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '821279bc-9e2f-47cc-8c7d-fee15f80a82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7CCF22850>]}
[0m22:59:34.005253 [info ] [MainThread]: 
[0m22:59:34.007251 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:59:34.053259 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB'
[0m22:59:34.099260 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB"
[0m22:59:34.100259 [debug] [ThreadPool]: On list_COMMEX_DB: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB"} */
show terse schemas in database COMMEX_DB
    limit 10000
[0m22:59:34.100259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:37.104255 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m22:59:37.105253 [debug] [ThreadPool]: On list_COMMEX_DB: Close
[0m22:59:37.599258 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT'
[0m22:59:37.610257 [debug] [ThreadPool]: Using snowflake connection "list_COMMEX_DB_DIGITAL_SHELF_DBT"
[0m22:59:37.611251 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_COMMEX_DB_DIGITAL_SHELF_DBT"} */
show terse objects in COMMEX_DB.DIGITAL_SHELF_DBT
[0m22:59:37.612265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:39.448272 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m22:59:39.451272 [debug] [ThreadPool]: On list_COMMEX_DB_DIGITAL_SHELF_DBT: Close
[0m22:59:39.961261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '821279bc-9e2f-47cc-8c7d-fee15f80a82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D0430E50>]}
[0m22:59:39.962259 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:59:39.965266 [info ] [MainThread]: 
[0m22:59:40.015273 [debug] [Thread-1 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:59:40.016268 [debug] [Thread-2 (]: Began running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:59:40.017272 [debug] [Thread-3 (]: Began running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:59:40.017272 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m22:59:40.018268 [info ] [Thread-1 (]: 1 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [RUN]
[0m22:59:40.019264 [info ] [Thread-2 (]: 2 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [RUN]
[0m22:59:40.029264 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM'
[0m22:59:40.030262 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT'
[0m22:59:40.031261 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:59:40.032260 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:59:40.038266 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m22:59:40.043271 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:59:40.026278 [info ] [Thread-3 (]: 3 of 7 START sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [RUN]
[0m22:59:40.027261 [info ] [Thread-4 (]: 4 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [RUN]
[0m22:59:40.046268 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN'
[0m22:59:40.047266 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (compile): 22:59:40.032260 => 22:59:40.046268
[0m22:59:40.048259 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM'
[0m22:59:40.049267 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (compile): 22:59:40.039267 => 22:59:40.048259
[0m22:59:40.049267 [debug] [Thread-3 (]: Began compiling node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:59:40.050262 [debug] [Thread-1 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:59:40.051263 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m22:59:40.052263 [debug] [Thread-2 (]: Began executing node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:59:40.059272 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m22:59:40.111273 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m22:59:40.118269 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m22:59:40.122270 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:59:40.123265 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:59:40.125265 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (compile): 22:59:40.053265 => 22:59:40.124265
[0m22:59:40.126260 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
TRUNCATE TABLE  TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:59:40.126260 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:59:40.127262 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (compile): 22:59:40.111273 => 22:59:40.127262
[0m22:59:40.128261 [debug] [Thread-3 (]: Began executing node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:59:40.129258 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:59:40.132266 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m22:59:40.137263 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m22:59:40.226269 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
TRUNCATE TABLE  TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:59:40.228264 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:59:40.260272 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m22:59:40.264269 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"
[0m22:59:40.264269 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
  
   as (
    

with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join   COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m22:59:40.265266 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:59:42.925272 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:59:42.942264 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:59:42.944268 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:59:42.945266 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:59:42.972264 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM (execute): 22:59:40.138263 => 22:59:42.972264
[0m22:59:42.974273 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:59:42.975279 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:59:42.977276 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m22:59:42.978270 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM: Close
[0m22:59:42.979292 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
         as
        (

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)



select *
from final
        );
[0m22:59:42.981265 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m22:59:42.984272 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"
[0m22:59:42.989271 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
         as
        (
 
with final as (

select a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date
, max(date) as End_date
from  PACVUE_KENVUE.KENVUE.KENVUE_CRITEO_AD__DAYREPORT_LINE_ITEM  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
        );
[0m22:59:42.994267 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"
[0m22:59:42.997274 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
         as
        (

 
-- CAMPAIGN fact columns
--
select
camp.DATE,
'US' as COUNTRY,
dim.BRAND,
dim.SUB_BRAND,
camp.CAMPAIGN_ID,
camp.AD_SPEND,
camp.SPEND,
camp.IMPRESSIONS,
camp.CLICKS,
camp.UNIT_SALES,
camp.SALES,
dim.GBU,
dim.SQUAD,
'TARGET'  as PLATFORM,
camp.CLIENT_ID,
camp.ID,
camp.CATALOG_ID,
camp.TEAM_ID,
camp.YEAR,
camp.QUARTER_OF_YEAR,
camp.MONTH_OF_YEAR,
camp.WEEK_OF_YEAR,
camp.UPDATE_TIME,
camp.HASH_ID,
camp.CAMPAIGN_NAME,
dim.PROFILE_ID,
dim.YR,
dim.KEYWORD_CATEGORY,
--CAMPAIGN derived columns
COALESCE(sales / NULLIF(spend,0), 0) as ROAS,
COALESCE(spend / NULLIF(clicks,0), 0) as CPC,
COALESCE(clicks / NULLIF(impressions,0), 0) as CTR,
COALESCE(unit_sales  / NULLIF(clicks,0), 0) as CVR,
COALESCE(sales / NULLIF(unit_sales ,0), 0) as AOV,
COALESCE(spend / NULLIF(unit_sales,0), 0) as CPA,
COALESCE(spend / NULLIF(sales,0), 0) as ACOS

from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  camp
left join
(
select  CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID,
MAX(case when FIELD_NAME='Sub-Brand' then FIELD_VALUE else NULL end) as Sub_Brand,
MAX(case when FIELD_NAME='Year' then FIELD_VALUE  else NULL end) as Yr,
MAX(case when FIELD_NAME='Keyword Category' then FIELD_VALUE  else NULL end) as Keyword_Category,
MAX(case when FIELD_NAME='Squad' then FIELD_VALUE  else NULL end) as Squad,
MAX(case when FIELD_NAME='Brand' then FIELD_VALUE  else NULL end) as Brand,
MAX(case when FIELD_NAME='GBU' then FIELD_VALUE  else NULL end) as GBU
from (

select a.*,c.tag_name field_name , b.tag_name field_value
from  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_CAMPAIGN  a
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  b
on a.tag_id = b.id
left join  DEV_COMX_GLOBAL.RETMEDIA_INTEGRATION.KENVUE_CITRUS_AD_TAG  c
on b.parent_id = c.id
where --a.campaign_id = 'bbe8d20c-adbb-4a84-9600-d4646291dcdd'and 
b.is_deleted = 'FALSE' and c.is_deleted = 'FALSE') A

group by   
CLIENT_ID,
--ID,
--TAG_ID,
PROFILE_ID,
CAMPAIGN_ID
) as dim
on camp.CLIENT_ID = dim.CLIENT_ID
AND camp.CAMPAIGN_ID= dim.CAMPAIGN_ID
        );
[0m22:59:43.524272 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '821279bc-9e2f-47cc-8c7d-fee15f80a82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7DAA6FA90>]}
[0m22:59:43.526280 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_LINE_ITEM  [[32mSUCCESS 1[0m in 3.48s]
[0m22:59:43.528277 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM
[0m22:59:43.529274 [debug] [Thread-4 (]: Began running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:59:43.530276 [info ] [Thread-4 (]: 5 of 7 START sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT .. [RUN]
[0m22:59:43.533271 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_poc.VW_CRITEO_AD__DAYREPORT_LINE_ITEM, now model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT)
[0m22:59:43.534276 [debug] [Thread-4 (]: Began compiling node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:59:43.539273 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:59:43.541269 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (compile): 22:59:43.534276 => 22:59:43.541269
[0m22:59:43.542272 [debug] [Thread-4 (]: Began executing node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:59:43.547280 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:59:43.549281 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"
[0m22:59:43.550277 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT
  
   as (
    

with final as (

select distinct a.retailer_id, b.retailer_name, count(a.retailer_id) as total_retailer_id, min(date) as Start_date, max(date) as End_date
from  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  a
left join  COMMEX_DB.DIGITAL_SHELF.KENVUE_CRITEO_RETAILERS  b
on  a.retailer_id = b.retailer_id
group by 1,2

)

select *
from final
  );
[0m22:59:43.551277 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:59:44.017273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:59:44.021269 [debug] [Thread-1 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM (execute): 22:59:40.060268 => 22:59:44.021269
[0m22:59:44.022268 [debug] [Thread-1 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM: Close
[0m22:59:44.389281 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:59:44.393275 [debug] [Thread-2 (]: Timing info for model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT (execute): 22:59:40.119270 => 22:59:44.393275
[0m22:59:44.394281 [debug] [Thread-2 (]: On model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m22:59:44.535274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '821279bc-9e2f-47cc-8c7d-fee15f80a82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7DA0B9210>]}
[0m22:59:44.537283 [info ] [Thread-1 (]: 1 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM  [[32mSUCCESS 1[0m in 4.51s]
[0m22:59:44.539281 [debug] [Thread-1 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM
[0m22:59:44.540274 [debug] [Thread-1 (]: Began running node model.dbt_poc.my_first_dbt_model
[0m22:59:44.541279 [info ] [Thread-1 (]: 6 of 7 START sql table model DIGITAL_SHELF_DBT.my_first_dbt_model .............. [RUN]
[0m22:59:44.544278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_ITEM, now model.dbt_poc.my_first_dbt_model)
[0m22:59:44.544278 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.my_first_dbt_model
[0m22:59:44.549273 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.my_first_dbt_model"
[0m22:59:44.551275 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_first_dbt_model (compile): 22:59:44.545277 => 22:59:44.550276
[0m22:59:44.552277 [debug] [Thread-1 (]: Began executing node model.dbt_poc.my_first_dbt_model
[0m22:59:44.556275 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.my_first_dbt_model"
[0m22:59:44.559276 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_poc.my_first_dbt_model"
[0m22:59:44.560283 [debug] [Thread-1 (]: On model.dbt_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_first_dbt_model"} */
create or replace transient table COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m22:59:44.560283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:44.946272 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '821279bc-9e2f-47cc-8c7d-fee15f80a82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D8E1FA90>]}
[0m22:59:44.947268 [info ] [Thread-2 (]: 2 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 4.92s]
[0m22:59:44.949280 [debug] [Thread-2 (]: Finished running node model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:59:45.558284 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:59:45.562282 [debug] [Thread-4 (]: Timing info for model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT (execute): 22:59:43.543276 => 22:59:45.562282
[0m22:59:45.563277 [debug] [Thread-4 (]: On model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT: Close
[0m22:59:45.797274 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:59:45.802272 [debug] [Thread-3 (]: Timing info for model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN (execute): 22:59:40.133271 => 22:59:45.802272
[0m22:59:45.803272 [debug] [Thread-3 (]: On model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN: Close
[0m22:59:46.056273 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '821279bc-9e2f-47cc-8c7d-fee15f80a82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7DA9FA750>]}
[0m22:59:46.058287 [info ] [Thread-4 (]: 5 of 7 OK created sql view model DIGITAL_SHELF_DBT.VW_CRITEO_AD__DAYREPORT_PRODUCT  [[32mSUCCESS 1[0m in 2.52s]
[0m22:59:46.059284 [debug] [Thread-4 (]: Finished running node model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT
[0m22:59:46.302273 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '821279bc-9e2f-47cc-8c7d-fee15f80a82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7DA8C4D90>]}
[0m22:59:46.303273 [info ] [Thread-3 (]: 3 of 7 OK created sql table model DIGITAL_SHELF_DBT.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN  [[32mSUCCESS 1[0m in 6.26s]
[0m22:59:46.305287 [debug] [Thread-3 (]: Finished running node model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN
[0m22:59:46.840279 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:59:46.844273 [debug] [Thread-1 (]: Timing info for model.dbt_poc.my_first_dbt_model (execute): 22:59:44.552277 => 22:59:46.844273
[0m22:59:46.845273 [debug] [Thread-1 (]: On model.dbt_poc.my_first_dbt_model: Close
[0m22:59:47.358279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '821279bc-9e2f-47cc-8c7d-fee15f80a82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D0D76350>]}
[0m22:59:47.359281 [info ] [Thread-1 (]: 6 of 7 OK created sql table model DIGITAL_SHELF_DBT.my_first_dbt_model ......... [[32mSUCCESS 1[0m in 2.81s]
[0m22:59:47.361288 [debug] [Thread-1 (]: Finished running node model.dbt_poc.my_first_dbt_model
[0m22:59:47.362279 [debug] [Thread-2 (]: Began running node model.dbt_poc.my_second_dbt_model
[0m22:59:47.363282 [info ] [Thread-2 (]: 7 of 7 START sql view model DIGITAL_SHELF_DBT.my_second_dbt_model .............. [RUN]
[0m22:59:47.365287 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_poc.TBL_KENVUE_CRITEO_AD__DAYREPORT_PRODUCT, now model.dbt_poc.my_second_dbt_model)
[0m22:59:47.365287 [debug] [Thread-2 (]: Began compiling node model.dbt_poc.my_second_dbt_model
[0m22:59:47.386279 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_poc.my_second_dbt_model"
[0m22:59:47.388287 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (compile): 22:59:47.366288 => 22:59:47.387285
[0m22:59:47.388287 [debug] [Thread-2 (]: Began executing node model.dbt_poc.my_second_dbt_model
[0m22:59:47.411281 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_poc.my_second_dbt_model"
[0m22:59:47.423277 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_poc.my_second_dbt_model"
[0m22:59:47.434281 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.my_second_dbt_model"} */
create or replace   view COMMEX_DB.DIGITAL_SHELF_DBT.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from COMMEX_DB.DIGITAL_SHELF_DBT.my_first_dbt_model
where id = 1
  );
[0m22:59:47.435287 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:59:49.668290 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:59:49.672287 [debug] [Thread-2 (]: Timing info for model.dbt_poc.my_second_dbt_model (execute): 22:59:47.389289 => 22:59:49.672287
[0m22:59:49.673291 [debug] [Thread-2 (]: On model.dbt_poc.my_second_dbt_model: Close
[0m22:59:50.156279 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '821279bc-9e2f-47cc-8c7d-fee15f80a82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7DA07E210>]}
[0m22:59:50.156279 [info ] [Thread-2 (]: 7 of 7 OK created sql view model DIGITAL_SHELF_DBT.my_second_dbt_model ......... [[32mSUCCESS 1[0m in 2.79s]
[0m22:59:50.158284 [debug] [Thread-2 (]: Finished running node model.dbt_poc.my_second_dbt_model
[0m22:59:50.161291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:59:50.172286 [debug] [MainThread]: Connection 'list_COMMEX_DB' was properly closed.
[0m22:59:50.176284 [debug] [MainThread]: Connection 'list_COMMEX_DB_DIGITAL_SHELF_DBT' was properly closed.
[0m22:59:50.182285 [debug] [MainThread]: Connection 'model.dbt_poc.my_first_dbt_model' was properly closed.
[0m22:59:50.183286 [debug] [MainThread]: Connection 'model.dbt_poc.my_second_dbt_model' was properly closed.
[0m22:59:50.184293 [debug] [MainThread]: Connection 'model.dbt_poc.TBL_WH_KENVUE_CITRUS_AD_DAYREPORT_CAMPAIGN' was properly closed.
[0m22:59:50.184293 [debug] [MainThread]: Connection 'model.dbt_poc.VW_CRITEO_AD__DAYREPORT_PRODUCT' was properly closed.
[0m22:59:50.185292 [info ] [MainThread]: 
[0m22:59:50.187285 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 16.18 seconds (16.18s).
[0m22:59:50.190281 [debug] [MainThread]: Command end result
[0m22:59:50.202289 [info ] [MainThread]: 
[0m22:59:50.203300 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:59:50.204291 [info ] [MainThread]: 
[0m22:59:50.206290 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m22:59:50.208290 [debug] [MainThread]: Command `dbt run` succeeded at 22:59:50.208290 after 23.93 seconds
[0m22:59:50.209293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7CBE3F390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7CBE3F310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7CBE3FED0>]}
[0m22:59:50.210287 [debug] [MainThread]: Flushing usage events
[0m22:59:51.153293 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
